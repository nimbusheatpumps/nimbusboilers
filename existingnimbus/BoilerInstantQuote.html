
<div class="site-chrome"><style>
:root {
    --primary-green: #00a676;
    --dark-green: #007a57;
    --light-green: #e8f5f0;
    --accent-green: #00c896;
    --text-dark: var(--dark-green);
    --text-medium: var(--dark-green);
    --text-light: var(--dark-green);
    --white: #ffffff;
    --off-white: #fafafa;
    --glass-white: rgba(255, 255, 255, 0.85);
    --glass-dark: rgba(255, 255, 255, 0.1);
    --shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.04);
    --shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.06);
    --shadow-large: 0 8px 32px rgba(0, 0, 0, 0.08);
    --shadow-glow: 0 0 40px rgba(0, 166, 118, 0.15);
    --radius-sm: 10px;
    --radius-md: 14px;
    --radius-lg: 18px;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}
.section-heading {
    font-size: 28px;
    font-weight: 600;
    margin-bottom: 25px;
    color: var(--dark-green);
    text-align: center;
}
.section-heading--spaced {
    margin-bottom: 40px;
}
.section-heading--hero {
    font-size: 32px;
}
.section-subheading {
    font-size: 22px;
    font-weight: 400;
    margin-bottom: 15px;
    color: var(--dark-green);
    text-align: center;
}
.section-text {
    font-size: 17px;
    line-height: 1.7;
    color: var(--dark-green);
    margin-bottom: 30px;
    text-align: center;
}
.section-text--compact {
    margin-bottom: 25px;
}
.section-text--intro {
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
}
.section-text--small {
    font-size: 14px;
    color: var(--dark-green);
    margin-bottom: 0;
}
.section-list {
    font-size: 17px;
    line-height: 1.7;
    color: var(--dark-green);
    list-style-type: none;
    padding-left: 0;
    margin: 0 auto 30px auto;
    max-width: 800px;
    text-align: center;
}
.section-list--flush {
    margin-bottom: 0;
}
.section-list li {
    margin-bottom: 15px;
}
.section-cta-group {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
}
.section-cta-group--spaced {
    margin-bottom: 30px;
}
.card-heading {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--dark-green);
}
.card-text {
    font-size: 16px;
    line-height: 1.6;
    color: var(--dark-green);
}
.cta-button {
    padding: 14px 28px;
    border: 2px solid #00a676;
    border-radius: 14px;
    font-weight: 600;
    font-size: 14px;
    letter-spacing: -0.01em;
    cursor: pointer;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    min-height: 46px;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    white-space: normal;
    position: relative;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.9);
    color: #007a57;
    box-shadow: 0 2px 8px rgba(0, 166, 118, 0.1), inset 0 0 0 0 #00a676;
}
.cta-button--nowrap {
    white-space: nowrap;
}
.cta-button:hover {
    background: #ffffff;
    border-color: #007a57;
    color: #007a57;
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2), inset 0 0 0 2px #ffffff;
}
.footer-heading {
    font-size: 18px;
    font-weight: 600;
    color: #007a57;
    margin-bottom: 30px;
    text-align: center;
}
.nimbus-nav * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}
.nimbus-nav-container {
    background: transparent;
    position: relative;
    z-index: 9999;
    width: 100%;
    margin: 0;
    padding: 0;
    border: none;
    box-shadow: none;
}
.nimbus-nav-inner {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 140px;
    padding: 0 32px;
    position: relative;
}
@media (min-width: 1025px) {
    .nimbus-nav-inner {
        justify-content: center;
    }
    .nimbus-logo-link {
        position: static;
    }
}
.nimbus-logo-link {
    display: flex;
    align-items: center;
    margin-right: 60px;
    text-decoration: none;
    padding: 10px 0;
    height: auto !important;
    width: auto !important;
}
.nimbus-logo {
    height: 120px !important;
    min-height: 120px !important;
    width: auto !important;
    max-width: 350px !important;
    object-fit: contain !important;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
    display: block !important;
}
.nimbus-logo-link:hover .nimbus-logo {
    transform: scale(1.08) translateY(-2px);
    filter: drop-shadow(0 4px 8px rgba(0, 166, 118, 0.2));
}
.nimbus-menu {
    display: flex;
    list-style: none;
    align-items: center;
    gap: 12px;
    margin: 0;
    padding: 0;
}
.nimbus-menu-item {
    position: relative;
}
.nimbus-link {
    display: inline-flex;
    align-items: center;
    min-height: 44px;
    padding: 14px 24px;
    color: var(--text-dark);
    text-decoration: none;
    font-weight: 500;
    font-size: 15px;
    letter-spacing: -0.01em;
    border-radius: var(--radius-md);
    position: relative;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    white-space: nowrap;
    overflow: hidden;
}
.nimbus-link::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, transparent 0%, rgba(0, 166, 118, 0.05) 50%, rgba(0, 200, 150, 0.08) 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
    border-radius: var(--radius-md);
}
.nimbus-link:hover::before {
    opacity: 1;
}
.nimbus-link:hover {
    color: var(--primary-green);
    transform: translateY(-1px);
}
.nimbus-link::after {
    content: '';
    position: absolute;
    bottom: 12px;
    left: 50%;
    width: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--primary-green), var(--accent-green));
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateX(-50%);
}
.nimbus-link:hover::after {
    width: calc(100% - 48px);
}
.nimbus-has-dropdown .nimbus-link::after {
    display: none;
}
.nimbus-has-dropdown .nimbus-link span {
    margin-left: 8px;
    display: inline-block;
    transition: transform 0.3s ease;
    font-size: 11px;
    opacity: 0.7;
}
.nimbus-has-dropdown:hover .nimbus-link span {
    transform: rotate(180deg);
}
.nimbus-dropdown {
    position: absolute;
    top: calc(100% - 5px);
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    background: var(--glass-white);
    -webkit-backdrop-filter: blur(20px);
    backdrop-filter: blur(20px);
    box-shadow: var(--shadow-large), var(--shadow-glow);
    border-radius: var(--radius-lg);
    border: 1px solid rgba(255, 255, 255, 0.6);
    list-style: none;
    padding: 12px;
    margin: 0;
    min-width: 260px;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1100;
}
.nimbus-dropdown::before {
    content: '';
    position: absolute;
    top: -10px;
    left: 0;
    right: 0;
    height: 15px;
    background: transparent;
    display: block;
}
.nimbus-menu-item:hover .nimbus-dropdown {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
    transform: translateX(-50%) translateY(0);
}
.nimbus-dropdown-item {
    margin: 3px 0;
    opacity: 0;
    animation: fadeInUp 0.4s forwards;
}
.nimbus-dropdown-item:nth-child(1) {
    animation-delay: 0.05s;
}
.nimbus-dropdown-item:nth-child(2) {
    animation-delay: 0.1s;
}
.nimbus-dropdown-item:nth-child(3) {
    animation-delay: 0.15s;
}
.nimbus-dropdown-item:nth-child(4) {
    animation-delay: 0.2s;
}
.nimbus-dropdown-item:nth-child(5) {
    animation-delay: 0.25s;
}
.nimbus-dropdown-item:nth-child(6) {
    animation-delay: 0.3s;
}
.nimbus-dropdown-item:nth-child(7) {
    animation-delay: 0.35s;
}
.nimbus-dropdown-item:nth-child(8) {
    animation-delay: 0.4s;
}
.nimbus-dropdown-item:nth-child(9) {
    animation-delay: 0.45s;
}
.nimbus-dropdown-item:nth-child(10) {
    animation-delay: 0.5s;
}
.nimbus-dropdown-item:nth-child(11) {
    animation-delay: 0.55s;
}
.nimbus-dropdown-item:nth-child(12) {
    animation-delay: 0.6s;
}
.nimbus-dropdown-item:nth-child(13) {
    animation-delay: 0.65s;
}
.nimbus-dropdown-item:nth-child(14) {
    animation-delay: 0.7s;
}
.nimbus-dropdown-item:nth-child(15) {
    animation-delay: 0.75s;
}
@keyframes fadeInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
    from {
        opacity: 0;
        transform: translateY(10px);
    }
}
.nimbus-dropdown-link {
    color: var(--text-dark);
    text-decoration: none;
    display: flex;
    align-items: center;
    padding: 12px 18px;
    border-radius: var(--radius-sm);
    transition: all 0.2s ease;
    font-size: 14px;
    font-weight: 450;
    position: relative;
    overflow: hidden;
}
.nimbus-dropdown-link::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
    background: linear-gradient(180deg, var(--primary-green), var(--accent-green));
    transform: translateX(-3px);
    transition: transform 0.3s ease;
}
.nimbus-dropdown-link:hover::before {
    transform: translateX(0);
}
.nimbus-dropdown-link:hover {
    background: linear-gradient(90deg, rgba(0, 166, 118, 0.08) 0%, rgba(0, 166, 118, 0.03) 100%);
    color: var(--primary-green);
    padding-left: 26px;
}
.nimbus-dropdown-link[target="_blank"]::after {
    content: '\2197';
    margin-left: auto;
    font-size: 12px;
    opacity: 0;
    transition: opacity 0.3s ease;
}
.nimbus-dropdown-link:hover[target="_blank"]::after {
    opacity: 0.5;
}
.nimbus-cta {
    margin-left: 10px;
    padding: 14px 28px;
    border: 2px solid transparent;
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 14px;
    letter-spacing: -0.01em;
    cursor: pointer;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    min-height: 46px;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.nimbus-cta-primary {
    background: rgba(255, 255, 255, 0.9);
    color: var(--dark-green);
    border: 2px solid var(--primary-green);
    box-shadow: 0 2px 8px rgba(0, 166, 118, 0.1), inset 0 0 0 0 var(--primary-green);
    margin-left: auto;
}
.nimbus-cta-primary:hover {
    background: var(--white);
    border-color: var(--dark-green);
    color: var(--dark-green);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2), inset 0 0 0 2px var(--white);
}
.nimbus-cta-secondary {
    background: rgba(255, 255, 255, 0.9);
    color: var(--dark-green);
    border: 2px solid var(--primary-green);
    box-shadow: 0 2px 8px rgba(0, 166, 118, 0.1), inset 0 0 0 0 var(--primary-green);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.nimbus-cta-secondary:hover {
    background: var(--white);
    border-color: var(--dark-green);
    color: var(--dark-green);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2), inset 0 0 0 2px var(--white);
}
.nimbus-link:focus-visible,
.nimbus-cta:focus-visible,
.nimbus-dropdown-link:focus-visible {
    outline: 2px solid var(--primary-green);
    outline-offset: 3px;
}
.nimbus-mobile-toggle {
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 48px;
    height: 48px;
    background: var(--glass-white);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 166, 118, 0.2);
    border-radius: var(--radius-sm);
    cursor: pointer;
    padding: 0;
    margin-left: auto;
    position: relative;
    transition: all 0.3s ease;
}
.nimbus-mobile-toggle:hover {
    background: var(--white);
    box-shadow: var(--shadow-medium);
}
.nimbus-mobile-toggle span {
    width: 22px;
    height: 2px;
    background: var(--text-dark);
    border-radius: 2px;
    transition: all 0.3s ease;
    position: absolute;
}
.nimbus-mobile-toggle span:nth-child(1) {
    transform: translateY(-7px);
}
.nimbus-mobile-toggle span:nth-child(3) {
    transform: translateY(7px);
}
.nimbus-mobile-toggle.active span:nth-child(1) {
    transform: rotate(-45deg);
}
.nimbus-mobile-toggle.active span:nth-child(2) {
    opacity: 0;
}
.nimbus-mobile-toggle.active span:nth-child(3) {
    transform: rotate(45deg);
}
@media (max-width: 1024px) and (min-width: 769px) {
    .nimbus-nav-inner {
        padding: 0 24px;
        min-height: 120px;
        justify-content: center;
    }
    .nimbus-logo {
        height: 100px !important;
        min-height: 100px !important;
        max-width: 300px !important;
    }
    .nimbus-logo-link {
        margin-right: 40px;
    }
    .nimbus-menu {
        gap: 8px;
        flex: 1;
        justify-content: center;
    }
    .nimbus-link {
        padding: 12px 20px;
        font-size: 14px;
    }
    .nimbus-cta {
        padding: 12px 24px;
        font-size: 13px;
        min-height: 42px;
    }
    .nimbus-dropdown {
        min-width: 280px;
    }
    .nimbus-dropdown-link {
        padding: 10px 16px;
        font-size: 13px;
    }
    .nimbus-cta-container {
        padding: 0 24px;
    }
    .nimbus-cta-row {
        gap: 16px;
        margin-top: 8px;
    }
}
@media (max-width: 768px) {
    .nimbus-nav-inner {
        padding: 0 20px;
        min-height: 100px;
    }
    .nimbus-logo {
        height: 80px !important;
        min-height: 80px !important;
        max-width: 250px !important;
    }
    .nimbus-logo-link {
        margin-right: auto;
    }
    .nimbus-mobile-toggle {
        display: flex;
    }
    .nimbus-menu {
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 0;
        flex-direction: column;
        background: rgba(255, 255, 255, 0.98);
        -webkit-backdrop-filter: blur(20px);
        backdrop-filter: blur(20px);
        overflow: hidden;
        transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow-large);
        gap: 0;
        padding: 0;
        z-index: 999;
    }
    .nimbus-menu.active {
        overflow-y: auto;
        overflow-x: hidden;
        padding: 20px 0;
        -webkit-overflow-scrolling: touch;
    }
    .nimbus-menu-item {
        width: 100%;
        opacity: 0;
        transform: translateY(-10px);
        animation: none;
    }
    .nimbus-menu.active .nimbus-menu-item {
        opacity: 1;
        transform: translateY(0);
        transition: all 0.3s ease;
    }
    .nimbus-menu.active .nimbus-menu-item:nth-child(1) {
        transition-delay: 0.05s;
    }
    .nimbus-menu.active .nimbus-menu-item:nth-child(2) {
        transition-delay: 0.1s;
    }
    .nimbus-menu.active .nimbus-menu-item:nth-child(3) {
        transition-delay: 0.15s;
    }
    .nimbus-menu.active .nimbus-menu-item:nth-child(4) {
        transition-delay: 0.2s;
    }
    .nimbus-menu.active .nimbus-menu-item:nth-child(5) {
        transition-delay: 0.25s;
    }
    .nimbus-menu.active .nimbus-menu-item:nth-child(6) {
        transition-delay: 0.3s;
    }
    .nimbus-link {
        padding: 18px 24px;
        width: 100%;
        justify-content: space-between;
        border-radius: 0;
        font-size: 16px;
    }
    .nimbus-link::before, .nimbus-link::after {
        display: none;
    }
    .nimbus-dropdown {
        position: static;
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
        transform: none;
        box-shadow: none;
        border: none;
        background: var(--light-green);
        -webkit-backdrop-filter: none;
        backdrop-filter: none;
        border-radius: 0;
        width: 100%;
        max-height: 0;
        overflow: hidden;
        padding: 0;
        transition: max-height 0.4s ease;
        text-align: center;
    }
    .nimbus-menu-item.dropdown-active .nimbus-dropdown {
        max-height: 60vh;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 10px 0;
        -webkit-overflow-scrolling: touch;
    }
    .nimbus-menu-item.dropdown-active .nimbus-dropdown::-webkit-scrollbar {
        width: 4px;
    }
    .nimbus-menu-item.dropdown-active .nimbus-dropdown::-webkit-scrollbar-track {
        background: rgba(0, 166, 118, 0.1);
    }
    .nimbus-menu-item.dropdown-active .nimbus-dropdown::-webkit-scrollbar-thumb {
        background: var(--primary-green);
        border-radius: 2px;
    }
    .nimbus-dropdown-item {
        animation: none;
        opacity: 1;
    }
    .nimbus-dropdown-link {
        justify-content: center;
        padding: 14px 20px;
        border-radius: 0;
        font-size: 13px;
        white-space: normal;
        text-align: center;
    }
    .nimbus-dropdown-link:hover {
        padding-left: 20px;
    }
    .nimbus-cta-container {
        padding: 0 20px;
    }
    .nimbus-cta-row {
        flex-direction: column;
        gap: 8px;
        margin-top: 5px;
    }
    .nimbus-cta {
        margin-left: 0;
        width: 100%;
        justify-content: center;
        font-size: 13px;
        padding: 10px 20px;
        min-height: 38px;
        border-width: 1.5px;
    }
    .nimbus-cta-primary {
        margin-left: 0;
    }
    .nimbus-cta:hover {
        transform: translateY(-2px) scale(1.01);
    }
}
@media (max-width: 768px) and (orientation: portrait) {
    .nimbus-menu-item.dropdown-active .nimbus-dropdown {
        max-height: 50vh;
    }
    .nimbus-dropdown-link {
        font-size: 12px;
        padding: 12px 16px;
    }
    .nimbus-cta {
        font-size: 12px;
        padding: 9px 18px;
        min-height: 36px;
    }
}
@media (max-width: 375px) {
    .nimbus-cta {
        font-size: 12px;
        padding: 8px 16px;
        min-height: 34px;
    }
    .nimbus-cta-row {
        gap: 6px;
    }
}
@media (max-width: 768px) {
    .nimbus-has-dropdown .nimbus-dropdown {
        left: 0 !important;
        transform: none !important;
        margin-left: 0 !important;
        margin-right: 0 !important;
    }
    .nimbus-has-dropdown .nimbus-link span {
        transform: none;
    }
    .nimbus-has-dropdown.dropdown-active .nimbus-link span {
        transform: rotate(180deg);
    }
}
@media (prefers-reduced-motion: reduce) {
    .nimbus-nav *,
    .nimbus-nav *::before,
    .nimbus-nav *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}
.nimbus-cta-row {
    background: transparent;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-top: 10px;
    flex-wrap: wrap;
}
.nimbus-cta-row .nimbus-cta {
    margin-left: 0;
}
.nimbus-cta-row .nimbus-cta-primary {
    margin-left: 0;
}
.nimbus-cta-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 32px;
}
.nimbus-social {
    display: flex;
    align-items: center;
    gap: 15px;
}
.nimbus-social a {
    color: var(--text-dark);
    transition: color 0.3s ease, transform 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-sm);
    position: relative;
    overflow: hidden;
}
.nimbus-social a::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, transparent 0%, rgba(0, 166, 118, 0.05) 50%, rgba(0, 200, 150, 0.08) 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
}
.nimbus-social a:hover::before {
    opacity: 1;
}
.nimbus-social a:hover {
    color: var(--primary-green);
    transform: translateY(-2px);
}
.nimbus-social svg {
    width: 24px;
    height: 24px;
}
.nimbus-social-item .nimbus-link {
    display: none;
}
@media (max-width: 1024px) and (min-width: 769px) {
    .nimbus-social {
        gap: 10px;
    }
    .nimbus-social a {
        width: 36px;
        height: 36px;
    }
    .nimbus-social svg {
        width: 20px;
        height: 20px;
    }
}
@media (max-width: 768px) {
    .nimbus-social-item {
        justify-content: center;
        padding: 18px 0;
    }
    .nimbus-social {
        gap: 20px;
        justify-content: center;
    }
    .nimbus-social a {
        width: 44px;
        height: 44px;
    }
    .nimbus-social svg {
        width: 26px;
        height: 26px;
    }
}
</style><style>
:root {
    --primary-green: #00a676;
    --text-dark: var(--dark-green);
    --text-medium: var(--dark-green);
    --text-light: var(--dark-green);
    --white: #ffffff;
    --off-white: #fafafa;
    --border-color: #A8D5BA;
}
body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    margin: 0;
    padding: 0;
    line-height: 1.6;
    color: var(--dark-green);
    background-color: var(--off-white);
}
.site-chrome * {
    color: var(--dark-green) !important;
    font-family: inherit !important;
}
.site-chrome ::placeholder {
    color: var(--dark-green) !important;
    font-family: inherit !important;
}
h1, h2, h3, h4, h5, h6 {
    font-weight: 700 !important;
}
.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 32px;
}
@media (max-width: 768px) {
    .container {
        padding: 0 20px;
    }
}
.nimbus-section-base {
    padding: 100px 32px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    border-radius: 8px;
    margin: 40px 0;
    font-family: 'Inter', sans-serif;
    border: 2px solid #A8D5BA;
    /* Removed opacity and transform for immediate visibility */
}
.services-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
    justify-content: center;
}
.service-card {
    padding: 30px;
    background-color: transparent;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 166, 118, 0.1);
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.service-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 16px rgba(0, 166, 118, 0.15);
}
.testimonials-carousel-wrapper {
    overflow: hidden;
    position: relative;
}
.testimonials-carousel {
    display: flex;
    gap: 20px;
    animation: carousel 20s linear infinite;
}
.testimonial-card {
    flex: 0 0 300px;
    padding: 20px;
    background: var(--light-green);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-soft);
    white-space: normal;
    word-break: break-word;
    position: relative;
    transition: transform 0.3s ease;
}
.testimonial-card:hover {
    transform: scale(1.05);
}
.testimonial-card::before {
    content: '\201C';
    font-size: 40px;
    color: var(--primary-green);
    position: absolute;
    top: 10px;
    left: 15px;
    transition: color 0.3s ease;
}
.testimonial-card:hover::before {
    color: var(--dark-green);
}
.testimonial-card p {
    margin-top: 20px;
    font-style: italic;
}
.testimonial-stars {
    color: #ffd700;
    margin-bottom: 10px;
}
@keyframes carousel {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}
.faq-accordion {
    max-width: 800px;
    margin: 0 auto;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    overflow: hidden;
    box-shadow: var(--shadow-soft);
}
.faq-item {
    margin-bottom: 0;
    border-bottom: 1px solid var(--border-color);
}
.faq-item:last-child {
    border-bottom: none;
}
.faq-question {
    background: var(--light-green);
    padding: 15px 20px;
    cursor: pointer;
    position: relative;
    font-weight: 600;
    color: var(--text-dark);
    transition: background 0.3s ease, color 0.3s ease;
    text-align: left;
    margin: 0;
}
.faq-question::after {
    content: '+';
    position: absolute;
    right: 20px;
    font-size: 20px;
    transition: transform 0.3s ease;
}
.faq-item.active .faq-question::after {
    transform: rotate(45deg);
}
.faq-question:hover {
    background: var(--accent-green);
    color: var(--white);
}
.faq-question:focus-visible {
    outline: 2px solid var(--primary-green);
    outline-offset: 2px;
}
.faq-answer {
    display: none;
    padding: 15px 20px;
    background: var(--white);
    text-align: left;
    color: var(--text-medium);
}
.faq-item.active .faq-answer {
    display: block;
}
.trust-badges {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
}
.badge {
    width: 100px;
    height: 100px;
    object-fit: contain;
}
.gas-safe-section img {
    max-width: 200px;
    margin-bottom: 20px;
}
</style><!-- Navigation Section --><nav aria-label="Main navigation" class="nimbus-nav">
<div class="nimbus-nav-container">
<div class="nimbus-nav-inner">
<!-- Logo -->
<a aria-label="Nimbus Boilers &amp; Heat Pumps - Home" class="nimbus-logo-link" href="/">
<img alt="Nimbus Boilers &amp; Heat Pumps - Gas Boiler and Air Source Heat Pump Installation in Scunthorpe and North Lincolnshire" class="nimbus-logo" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/06/Nimbus-Heat-Pumps-Logo.png"/>
</a>
<!-- Mobile Toggle -->
<button aria-controls="nimbusMenu" aria-expanded="false" aria-label="Toggle navigation menu" class="nimbus-mobile-toggle" onclick="toggleNimbusMenu()">
<span></span>
<span></span>
<span></span>
</button>
<!-- Premium Menu -->
<ul class="nimbus-menu" id="nimbusMenu">
<li class="nimbus-menu-item">
<a class="nimbus-link" href="https://nimbusheatpumps.co.uk/faq/">Air Source Heat Pumps FAQ</a>
</li>
<li class="nimbus-menu-item">
<a class="nimbus-link" href="https://nimbusheatpumps.co.uk/areas-we-cover/">Areas We Cover</a>
</li>
<li class="nimbus-menu-item">
<a class="nimbus-link" href="https://nimbusheatpumps.co.uk/boiler-upgrade-scheme-eligibility-7500-heat-pump-grants-scunthorpe/">£7,500 Boiler Upgrade Scheme Grants in Scunthorpe</a>
</li>
<li class="nimbus-menu-item nimbus-has-dropdown">
<a class="nimbus-link" href="#nimbusMenu" onclick="toggleDropdown(event)">
            Heat Pump &amp; Boiler Manufacturers <span>▾</span>
</a>
<ul class="nimbus-dropdown">
<!-- Heat Pump Brands -->
<li class="nimbus-dropdown-item">
<!-- Alpha Heat Pumps link removed -->
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.baxi.co.uk/products/air-source-heat-pumps" rel="noopener noreferrer" target="_blank">
                Baxi Heat Pumps
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.idealheating.com/products/heat-pumps" rel="noopener noreferrer" target="_blank">
                Ideal Heat Pumps
              </a>
</li>
<li class="nimbus-dropdown-item">
<!-- Intergas Heat Pumps link removed -->
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://les.mitsubishielectric.co.uk/homeowners/our-heat-pumps" rel="noopener noreferrer" target="_blank">
                Mitsubishi Electric Heat Pumps
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://samsung-climatesolutions.com/gb/b2c/our-solutions/home/heat-pump-solutions/heating.html" rel="noopener noreferrer" target="_blank">
                Samsung Heat Pumps
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.vaillant.co.uk/homeowners/products/heat-pumps/view-all-heat-pumps/" rel="noopener noreferrer" target="_blank">
                Vaillant Heat Pumps
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.viessmann.co.uk/en/products/heat-pump/heat-pumps.html" rel="noopener noreferrer" target="_blank">
                Viessmann Heat Pumps
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.worcester-bosch.co.uk/products/heat-pumps" rel="noopener noreferrer" target="_blank">
                Worcester Bosch Heat Pumps
              </a>
</li>
<!-- Boiler Brands -->
<li class="nimbus-dropdown-item">
<!-- Alpha Boilers link removed -->
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.baxi.co.uk/products/boilers" rel="noopener noreferrer" target="_blank">
                Baxi Boilers
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.idealheating.com/products/boilers" rel="noopener noreferrer" target="_blank">
                Ideal Boilers
              </a>
</li>
<li class="nimbus-dropdown-item">
<!-- Intergas Boilers link removed -->
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.vaillant.com/home/products/energy-type/gas/" rel="noopener noreferrer" target="_blank">
                Vaillant Boilers
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.viessmann.co.uk/en/products/gas-boilers.html" rel="noopener noreferrer" target="_blank">
                Viessmann Boilers
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://www.worcester-bosch.co.uk/products/boilers" rel="noopener noreferrer" target="_blank">
                Worcester Bosch Boilers
              </a>
</li>
</ul>
</li>
<li class="nimbus-menu-item">
<a class="nimbus-link" href="/">Home</a>
</li>
<li class="nimbus-menu-item nimbus-has-dropdown">
<a class="nimbus-link" href="#nimbusMenu" onclick="toggleDropdown(event)">
            Policies <span>▾</span>
</a>
<ul class="nimbus-dropdown">
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://nimbusheatpumps.co.uk/policies/cookies-policy/">
                Cookies Policy
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://nimbusheatpumps.co.uk/policies/privacy-policy/">
                Privacy Policy
              </a>
</li>
<li class="nimbus-dropdown-item">
<a class="nimbus-dropdown-link" href="https://nimbusheatpumps.co.uk/policies/terms-and-conditions/">
                Terms &amp; Conditions
              </a>
</li>
</ul>
</li>
<li class="nimbus-menu-item nimbus-social-item">
<div class="nimbus-social">
<a aria-label="Follow Nimbus Boilers &amp; Heat Pumps on X" href="https://x.com/NimbusHeatPumps" rel="noopener noreferrer" target="_blank" title="Follow Nimbus Boilers &amp; Heat Pumps on X for gas boiler and air source heat pump tips in Scunthorpe and North Lincolnshire">
<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" fill="#000" stroke="none"></path>
</svg>
</a>
<a aria-label="Follow Nimbus Boilers &amp; Heat Pumps on Facebook" href="https://www.facebook.com/profile.php?id=61579773217395" rel="noopener noreferrer" target="_blank" title="Follow Nimbus Boilers &amp; Heat Pumps on Facebook for updates on Boiler Upgrade Scheme grants and installations in DN and LN postcodes">
<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" fill="#1877F2"></path>
</svg>
</a>
<a aria-label="Read Nimbus Boilers &amp; Heat Pumps reviews on Google" href="https://share.google/yk7F28G9VpVstANKx" rel="noopener noreferrer" target="_blank" title="Read Nimbus Boilers &amp; Heat Pumps reviews on Google">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true">
<circle cx="12" cy="12" r="10" fill="#ffffff" stroke="#4285F4" stroke-width="2"/>
<text x="12" y="16" text-anchor="middle" font-size="12" font-family="Arial, Helvetica, sans-serif" fill="#4285F4">G</text>
</svg>
</a>
</div>
</li>
</ul>
</div>
<div class="nimbus-cta-container">
<div class="nimbus-cta-row">
<a class="nimbus-cta nimbus-cta-primary" href="#bqf-fullpaste">Gas Boiler Quote</a>
<a class="nimbus-cta nimbus-cta-secondary" href="#contact-form">Heat Pump Quote</a>
<a class="nimbus-cta nimbus-cta-primary" href="mailto:info@nimbusheatpumps.co.uk">Email Us</a>
<a class="nimbus-cta nimbus-cta-secondary" href="tel:01724622069">Call Now</a>
</div>
</div>
</div>
<style>.section a:hover{background:#ffffff;border-color:#007a57;color:#007a57;transform:translateY(-3px) scale(1.02);box-shadow:0 6px 20px rgba(0,166,118,0.2), inset 0 0 0 2px #ffffff}.section:hover{transform:translateY(-3px) scale(1.02);box-shadow:0 6px 20px rgba(0,166,118,0.2);border-color:#007a57}.section{transition:all 0.3s cubic-bezier(0.34,1.56,0.64,1)}</style>
</nav><!-- Install Banner — vertical on mobile, horizontal marquee on desktop --><div class="install-banner">
<div class="banner-wrapper">
<h2 class="banner-label">Every installation includes:</h2>
<div aria-live="polite" class="banner-scroller">
<div class="banner-track">
<!-- Group 1 -->
<div class="banner-items">
<span class="banner-item">MagnaCleanse chemical flush</span>
<span class="banner-item">Hive smart thermostat</span>
<span class="banner-item">Shock arrester</span>
<span class="banner-item">Cold water scale reducer</span>
<span class="banner-item">Central heating magnetic filter</span>
</div>
<!-- Group 2 (duplicate for seamless horizontal loop) -->
<div aria-hidden="true" class="banner-items">
<span class="banner-item">MagnaCleanse chemical flush</span>
<span class="banner-item">Hive smart thermostat</span>
<span class="banner-item">Shock arrester</span>
<span class="banner-item">Cold water scale reducer</span>
<span class="banner-item">Central heating magnetic filter</span>
</div>
</div>
</div>
</div>
<p class="banner-footnote">
    All work is completed to the relevant British Standards, Building Regulations and Gas Safe Regulations.
  </p>
 </div></div>
<!-- Hero Section (moved to be first) -->
<section class="hero-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 50px;">
<!-- Left column: Explanatory Text -->
<div style="flex: 1 1 400px; text-align: center;">
<h1 class="section-heading section-heading--hero">Gas Boiler Installation, Replacement &amp; Service in Scunthorpe, Grimsby, Doncaster, Lincoln &amp; Surrounding Towns</h1>
<h2 class="section-subheading">Instant Gas Boiler Quote | Gas Safe Registered Installers | Finance Available | Boiler Repairs &amp; Servicing in Scunthorpe, Grimsby, Doncaster, Lincoln &amp; North Lincolnshire</h2>
<p class="section-text section-text--intro section-text--compact">Specialising in gas boiler installations, repairs and services in Scunthorpe, Grimsby, Doncaster, Lincoln and every town and village in between, including Brigg, Gainsborough and Kirton in Lindsey. We offer combi boiler replacements, emergency repairs and eco-friendly heating solutions. Request your quote today.</p>
<div class="section-cta-group">
<a class="cta-button cta-button--nowrap" href="#bqf-fullpaste">Get an Instant Gas Boiler Quote in Scunthorpe, Grimsby, Doncaster, Lincoln</a>
<a class="cta-button cta-button--nowrap" href="#bqf-fullpaste">Start Your Instant Boiler Quote</a>
<a class="cta-button" href="tel:01724622069">Call 01724 622069</a>
</div>
</div>
<!-- Right column: Hero Image -->
<div style="flex: 1 1 300px; max-width: 400px;">
<link rel="preload" as="image" href="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/10/WorcesterGreenstar8000Life_white.png"/>
<img alt="Worcester Greenstar 8000 Life gas boiler - Nimbus Boilers, Scunthorpe" decoding="async" loading="eager" fetchpriority="high" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/10/WorcesterGreenstar8000Life_white.png" style="width: 100%; height: auto; display: block; margin: 0 auto; border-radius: 8px; background: var(--off-white);"/>
</div>
</div>
</section>
<style>@media(max-width:1024px){.hero-section{padding:80px 32px}} @media(max-width:768px){.hero-section{padding:40px 20px}.hero-section>div{flex-direction:column-reverse;gap:30px;align-items:stretch}.hero-section>div>div{width:100%;max-width:100%}.hero-section div[style*="justify-content: center"]{gap:15px;flex-direction:column}.hero-section a{width:100%;max-width:300px;margin:0 auto 10px;font-size:13px;padding:10px 20px;min-height:38px}}</style>
<!-- Quick Links (moved above quote form) -->
<section class="jump-links section nimbus-section-base" aria-label="Quick links to boiler services">
  <div style="max-width: 1400px; margin: 0 auto; text-align: center;">
    <h2 class="section-heading section-heading--spaced">Boiler Installation in Scunthorpe - Quick Links</h2>
    <ul class="section-list section-list--flush" style="display:flex; flex-wrap:wrap; gap:10px; justify-content:center; max-width:1000px;">
      <li><a class="cta-button" href="#bqf-fullpaste">Instant Boiler Quote</a></li>
      <li><a class="cta-button" href="#instant-quote-how">How the Quote Works</a></li>
      <li><a class="cta-button" href="#boiler-installation-scunthorpe">Install &amp; Replacement</a></li>
      <li><a class="cta-button" href="#boiler-cost">Boiler Installation Cost</a></li>
      <li><a class="cta-button" href="#combi-vs-system">Combi vs System vs Regular</a></li>
      <li><a class="cta-button" href="#boiler-swap">Boiler Swap vs Conversion</a></li>
      <li><a class="cta-button" href="#back-boiler">Back Boiler Replacement</a></li>
      <li><a class="cta-button" href="#boiler-finance">Boilers on Finance</a></li>
    </ul>
  </div>
  <style>@media(max-width:768px){.jump-links{padding:40px 20px}.jump-links h2{font-size:24px}.jump-links a{font-size:13px;padding:10px 16px;min-height:38px}}</style>
 </section>
<!-- How the Instant Quote Works -->
<section class="instant-quote-how section nimbus-section-base" id="instant-quote-how" aria-label="How the instant boiler quote works">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">How the Instant Boiler Quote Works</h2>
    <p class="section-text section-text--intro">Our online form takes just a few minutes. Answer straightforward questions so we can tailor options and guide prices to your home in Scunthorpe and North Lincolnshire.</p>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Postcode and service area check.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Property info and hot water demand (bed/bath, flow rate guidance).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Current boiler type (combi, system, regular, back boiler or none) and cylinder presence.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Flue route and length, gas meter location and gas pipe size guidance.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>See tailored boiler options with guide prices based on your answers.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Choose an option and submit - we confirm details, finalise price and schedule.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Optional: pay now at the end to secure your installation date.</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Start Your Instant Boiler Quote</a>
      <a class="cta-button" href="#contact-form">Ask a Question</a>
    </div>
  </div>
  <style>@media(max-width:768px){.instant-quote-how{padding:40px 20px}.instant-quote-how h2{font-size:24px}.instant-quote-how ul li{font-size:15px}}</style>
</section>
<!-- What You'll Need (2-3 mins) [moved above quote form] -->
<section class="quote-prereqs section nimbus-section-base" id="quote-prereqs" aria-label="What you'll need for the instant boiler quote">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">What You'll Need (2-3 mins)</h2>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Your postcode (we serve DN and LN areas)</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Property details (bedrooms/bathrooms)</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Current boiler type and whether you have a hot water cylinder</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Flue route (through wall or roof) and rough length</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Gas meter location and approximate pipe size (Unsure is fine)</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Contact details to receive your options and next steps</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Start Your Instant Boiler Quote</a>
    </div>
  </div>
  <style>@media(max-width:768px){.quote-prereqs{padding:40px 20px}.quote-prereqs h2{font-size:24px}.quote-prereqs ul li{font-size:15px}}</style>
</section>
<!-- Instant Quote Highlight (moved above quote form) -->
<!-- Instant Quote Highlight (moved above quote form) -->
<section class="instant-quote-highlight section nimbus-section-base" aria-label="Instant online boiler quote">
  <div style="max-width: 1400px; margin: 0 auto; text-align:center;">
    <h2 class="section-heading">Get an Instant Online Boiler Quote</h2>
    <p class="section-text section-text--intro">Answer a few quick questions to see options and a guide price for your <strong>boiler installation</strong> or <strong>boiler replacement</strong> in Scunthorpe. No obligation and no sales pressure.</p>
    <div class="section-cta-group">
      <a class="cta-button cta-button--nowrap" href="#bqf-fullpaste">Start Your Instant Boiler Quote</a>
    </div>
  </div>
  <style>@media(max-width:768px){.instant-quote-highlight{padding:40px 20px}.instant-quote-highlight h2{font-size:24px}.instant-quote-highlight p{font-size:15px}}</style>
</section>
<section id="bqf-fullpaste"><!-- START: BoilerQuoteForm FULL RAW PASTE --><!-- Preconnect for faster loading -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="https://cdn.jsdelivr.net" rel="preconnect"/>
<link href="//cdn.jsdelivr.net" rel="dns-prefetch"/>
<!-- Google Fonts with fallback -->
<!-- Swiper CSS (without integrity/onerror to avoid false fallback) -->
<!-- Fallback styles if CDNs fail -->
<div aria-label="Gas Boiler Installation Quote for Lincoln, Scunthorpe, Doncaster and Grimsby" id="quote-form-container" role="form">
<style>
  /* Inline, scoped tooltips for the quote form */
  #quote-form-container .qf-tip { display: inline-block; margin-left: 8px; position: relative; }
  #quote-form-container .qf-tip .tip-btn {
    display: inline-flex; align-items: center; justify-content: center;
    width: 18px; height: 18px; border-radius: 50%;
    background: var(--primary-color, #00a676); color: #fff; border: 0; cursor: pointer;
    font-size: 12px; line-height: 1; padding: 0; box-shadow: 0 0 0 0 transparent;
  }
  #quote-form-container .qf-tip .tip-btn:focus { outline: 3px solid rgba(0,166,118,0.35); outline-offset: 2px; }
  #quote-form-container .qf-tip .tip-content {
    position: absolute; top: 125%; left: 0; z-index: 1000; min-width: 240px; max-width: 320px;
    background: #fff; color: var(--dark-green); border: 1px solid rgba(0,0,0,0.1); border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.12); padding: 12px 14px; font-size: 14px; line-height: 1.45;
    display: none;
  }
  #quote-form-container .qf-tip .tip-content.show { display: block; }
  #quote-form-container .qf-tip .tip-content a { color: var(--secondary-color, #2563eb); text-decoration: underline; }
  @media (max-width: 768px) {
    #quote-form-container .qf-tip .tip-content { left: auto; right: 0; }
  }
</style>
<script>
  (function(){
    const addTipAfter = (el, html, id) => {
      if (!el || el.closest('.qf-tip-initialised')) return;
      const wrap = document.createElement('span');
      wrap.className = 'qf-tip qf-tip-initialised';
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'tip-btn';
      btn.setAttribute('aria-label', 'Help');
      btn.setAttribute('aria-expanded', 'false');
      const tipId = id || ('tip-' + Math.random().toString(36).slice(2));
      btn.setAttribute('aria-controls', tipId);
      btn.textContent = '?';
      const content = document.createElement('div');
      content.className = 'tip-content';
      content.id = tipId;
      content.setAttribute('role', 'tooltip');
      content.innerHTML = html;
      wrap.appendChild(btn); wrap.appendChild(content);
      el.insertAdjacentElement('afterend', wrap);
      const toggle = (show) => {
        const willShow = (typeof show === 'boolean') ? show : !content.classList.contains('show');
        content.classList.toggle('show', willShow);
        btn.setAttribute('aria-expanded', String(willShow));
      };
      btn.addEventListener('click', () => toggle());
      document.addEventListener('click', (e)=>{ if (!wrap.contains(e.target)) toggle(false); });
      btn.addEventListener('keydown',(e)=>{ if(e.key==='Escape') toggle(false); });
    };

    const findByText = (selector, text) => {
      text = (text||'').toLowerCase();
      return Array.from(document.querySelectorAll(selector)).find(el => el.textContent.trim().toLowerCase().includes(text));
    };

    const initTips = () => {
      // Water flow rate
      addTipAfter(
        findByText('#quote-form-container label, #quote-form-container h2', 'water flow'),
        'Quick test: fill a 1L jug from your kitchen cold tap on full and time it. Under ~10s ≈ &gt;6 l/min (low), ~6‑10s ≈ 6–10 l/min (medium), under ~6s ≈ &gt;10 l/min (high). Choose “Unsure” if you can’t measure.'
      );
      // Current boiler type
      addTipAfter(
        findByText('#quote-form-container label, #quote-form-container h2', 'current boiler'),
        '<strong>Combi</strong>: no hot water cylinder. <strong>System</strong>: with cylinder. <strong>Regular/Heat‑only</strong>: tank(s) in loft + cylinder. <strong>Back boiler</strong>: behind a fireplace.'
      );
      // Cylinder presence
      addTipAfter(
        findByText('#quote-form-container label', 'existing hot water cylinder'),
        'A cylinder is a hot water storage tank (often in an airing cupboard). System or regular boilers typically use a cylinder. Combi setups usually do not.'
      );
      // Flue
      addTipAfter(
        findByText('#quote-form-container label, #quote-form-container h2', 'flue system'),
        '<strong>Horizontal</strong>: through an external wall. <strong>Vertical</strong>: up through a roof. Final routing/position is confirmed on survey to meet current regulations.'
      );
      // Gas meter location
      addTipAfter(
        findByText('#quote-form-container label', 'gas meter'),
        'If the meter is on the same wall as the boiler, routes are often simpler. Different walls/floors are fine — we confirm the best safe route on survey.'
      );
      // Gas pipe size
      addTipAfter(
        findByText('#quote-form-container label', 'gas supply pipe'),
        'Many modern boilers need a 22mm supply from meter to boiler. If unsure, choose “Unsure” — we confirm pipe sizing and include any upgrades in your quote.'
      );
    };

    const tipDynamic = () => {
      // Add tip for any pay button that appears dynamically (e.g., at the end)
      document.querySelectorAll('#quote-form-container .pay-button:not([data-tip-added])').forEach(btn => {
        const wrap = document.createElement('span'); wrap.className='qf-tip';
        const info = document.createElement('div'); info.className='tip-content show';
        info.innerHTML = 'You can pay now to secure your installation date. Finance is available — please contact us for details.';
        btn.setAttribute('data-tip-added','true');
        btn.insertAdjacentElement('afterend', wrap); wrap.appendChild(info);
        setTimeout(()=>info.classList.remove('show'), 2500); // show briefly
      });
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initTips); else initTips();
    const mo = new MutationObserver(() => { tipDynamic(); });
    mo.observe(document.getElementById('quote-form-container'), { childList: true, subtree: true });
  })();
</script>
<div class="loading-overlay" id="loading-overlay">
<div style="text-align: center;">
<div class="loading-spinner"></div>
<div class="loading-text">Calculating your personalised quote...</div>
</div>
</div>
<div class="progress-container">
<div class="progress-indicator">
<div class="progress-fill" id="progress-fill" style="width: 5.56%"></div>
</div>
<div aria-label="Form Progress" class="progress-bar" role="navigation">
<span aria-label="Step 1: Home" class="progress-step active" data-step="1" tabindex="0">1. Home</span>
<span aria-label="Step 2: Property Type" class="progress-step" data-step="2" tabindex="0">2. Property</span>
<span aria-label="Step 3: Bedrooms" class="progress-step" data-step="3" tabindex="0">3. Bedrooms</span>
<span aria-label="Step 4: Bathrooms" class="progress-step" data-step="4" tabindex="0">4. Bathrooms</span>
<span aria-label="Step 5: Water Flow" class="progress-step" data-step="5" tabindex="0">5. Water Flow</span>
<span aria-label="Step 6: Fuel Type" class="progress-step" data-step="6" tabindex="0">6. Fuel</span>
<span aria-label="Step 7: Current Boiler" class="progress-step" data-step="7" tabindex="0">7. Boiler</span>
<span aria-label="Step 8: Hot Water" class="progress-step" data-step="8" tabindex="0">8. Hot Water</span>
<span aria-label="Step 9: Radiators" class="progress-step" data-step="9" tabindex="0">9. Radiators</span>
<span aria-label="Step 10: Flue System" class="progress-step" data-step="10" tabindex="0">10. Flue</span>
<span aria-label="Step 11: Gas Meter" class="progress-step" data-step="11" tabindex="0">11. Meter</span>
<span aria-label="Step 12: Gas Pipe" class="progress-step" data-step="12" tabindex="0">12. Gas Pipe</span>
<span aria-label="Step 13: Add-ons" class="progress-step" data-step="13" tabindex="0">13. Add-ons</span>
<span aria-label="Step 14: Contact Details" class="progress-step" data-step="14" tabindex="0">14. Contact</span>
<span aria-label="Step 15: Quote &amp; Payment" class="progress-step" data-step="15" tabindex="0">15. Quote</span>
</div>
</div>
<form id="boiler-form" novalidate="">
<div class="form-step active" id="step1">
<h2>🏠 Tell us about your home</h2>
<p style="color: var(--text-secondary); margin-bottom: 16px; text-align: center;">
                We need to understand your situation to provide the right advice and comply with Building Regulations.
            </p>
<label>Are you installing for your own home or a rental property?</label>
<div aria-labelledby="home-type-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step1" name="home_type" type="radio" value="own_home"/>
<span class="radio-icon">🏠</span>
<strong>Own Home</strong><br/>
<small>Personal residence installation</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step1" name="home_type" type="radio" value="rental_property"/>
<span class="radio-icon">🏢</span>
<strong>Rental Property</strong><br/>
<small>Investment property installation</small>
</label>
</div>
<div class="error" id="error-step1" role="alert">Please select whether this is for your own home or a rental property.</div>
<button onclick="nextStep(2)" type="button">Next: Property Type →</button>
</div>
<div class="form-step" id="step2">
<h2>🏠 Property Type</h2>
<label>What type of property is it?</label>
<div aria-labelledby="property-type-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step2" name="property_type" type="radio" value="flat"/>
<span class="radio-icon">🏢</span>
<strong>Flat/Apartment</strong><br/>
<small>Unit in a building</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step2" name="property_type" type="radio" value="terraced"/>
<span class="radio-icon">🏘️</span>
<strong>Terraced House</strong><br/>
<small>Connected on both sides</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step2" name="property_type" type="radio" value="semi"/>
<span class="radio-icon">🏠</span>
<strong>Semi-Detached</strong><br/>
<small>Connected on one side</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step2" name="property_type" type="radio" value="detached"/>
<span class="radio-icon">🏡</span>
<strong>Detached House</strong><br/>
<small>Standalone property</small>
</label>
</div>
<div class="error" id="error-step2" role="alert">Please select your property type.</div>
<button onclick="prevStep(1)" type="button">← Previous</button>
<button onclick="nextStep(3)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step3">
<h2>🛏️ Number of Bedrooms</h2>
<label>How many bedrooms does your property have?</label>
<div aria-labelledby="bedrooms-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step3" name="bedrooms" type="radio" value="1"/>
<span class="radio-icon">1️⃣</span>
<strong>1 Bedroom</strong><br/>
<small>Studio or 1-bed</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step3" name="bedrooms" type="radio" value="2"/>
<span class="radio-icon">2️⃣</span>
<strong>2 Bedrooms</strong><br/>
<small>Small family home</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step3" name="bedrooms" type="radio" value="3"/>
<span class="radio-icon">3️⃣</span>
<strong>3 Bedrooms</strong><br/>
<small>Medium family home</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step3" name="bedrooms" type="radio" value="4+"/>
<span class="radio-icon">4️⃣</span>
<strong>4 or More</strong><br/>
<small>Large family home</small>
</label>
</div>
<div class="error" id="error-step3" role="alert">Please select the number of bedrooms.</div>
<button onclick="prevStep(2)" type="button">← Previous</button>
<button onclick="nextStep(4)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step4">
<h2>🚿 Number of Bathrooms</h2>
<label>How many bathrooms and WCs do you have?</label>
<div aria-labelledby="bathrooms-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step4" name="bathrooms" type="radio" value="1"/>
<span class="radio-icon">1️⃣</span>
<strong>1 Bathroom/WC</strong><br/>
<small>Single bathroom only</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step4" name="bathrooms" type="radio" value="1main1wc"/>
<span class="radio-icon">1️⃣+</span>
<strong>1 Main + 1 WC</strong><br/>
<small>Bathroom plus downstairs WC</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step4" name="bathrooms" type="radio" value="2"/>
<span class="radio-icon">2️⃣</span>
<strong>2 Bathrooms</strong><br/>
<small>Two full bathrooms</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step4" name="bathrooms" type="radio" value="3+"/>
<span class="radio-icon">3️⃣+</span>
<strong>3 or More</strong><br/>
<small>Multiple bathrooms</small>
</label>
</div>
<div class="error" id="error-step4" role="alert">Please select the number of bathrooms.</div>
<label>How many people live in the house?</label>
<div aria-labelledby="occupants-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step4-occupants" name="occupants" type="radio" value="1-2"/>
<span class="radio-icon">1️⃣-2️⃣</span>
<strong>1-2 People</strong><br/>
<small>Small household</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step4-occupants" name="occupants" type="radio" value="3-4"/>
<span class="radio-icon">3️⃣-4️⃣</span>
<strong>3-4 People</strong><br/>
<small>Medium household</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step4-occupants" name="occupants" type="radio" value="5+"/>
<span class="radio-icon">5️⃣+</span>
<strong>5 or More</strong><br/>
<small>Large household</small>
</label>
</div>
<div class="error" id="error-step4-occupants" role="alert">Please select the number of occupants.</div>
<button onclick="prevStep(3)" type="button">← Previous</button>
<button onclick="nextStep(5)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step5">
<h2>💧 Mains Water Flow Rate</h2>
<p style="color: var(--text-secondary); margin-bottom: 16px; text-align: center;">
                This affects which boiler system is suitable and helps us size it correctly for your hot water demand.
            </p>
<label>How would you describe your cold water pressure and flow?</label>
<small style="color: var(--text-secondary); display: block; margin-bottom: 16px; text-align: center;">
                To test: Turn a kitchen cold tap on full and time how long it takes to fill a 1L jug. 10 seconds = about 6 l/min flow rate. Most UK homes have 10-15 l/min.
            </small>
<div aria-labelledby="water-flow-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step5" name="water_flow" type="radio" value="low"/>
<span class="radio-icon">💧</span>
<strong>Weak Pressure/Slow</strong><br/>
<small>&lt;10 l/min - System boiler may be more suitable</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step5" name="water_flow" type="radio" value="medium"/>
<span class="radio-icon">💦</span>
<strong>Standard Flow</strong><br/>
<small>10-15 l/min - Good for most combi boilers</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step5" name="water_flow" type="radio" value="high"/>
<span class="radio-icon">🌊</span>
<strong>Strong Pressure/Fast</strong><br/>
<small>&gt;15 l/min - Excellent for high-output combis</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step5" name="water_flow" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Not Sure/Test</strong><br/>
<small>Our engineer will measure during survey</small>
</label>
</div>
<div class="error" id="error-step5" role="alert">Please select your water flow rate or not sure.</div>
<button onclick="prevStep(4)" type="button">← Previous</button>
<button onclick="nextStep(6)" type="button">Next: Fuel Type →</button>
</div>
<div class="form-step" id="step6">
<h2>🔥 Current Fuel Type</h2>
<label>What is your current heating fuel?</label>
<div aria-labelledby="fuel-type-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step6" name="fuel_type" type="radio" value="gas"/>
<span class="radio-icon">🔥</span>
<strong>Gas</strong><br/>
<small>Mains gas supply</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step6" name="fuel_type" type="radio" value="lpg"/>
<span class="radio-icon">🛢️</span>
<strong>LPG</strong><br/>
<small>Liquefied Petroleum Gas</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step6" name="fuel_type" type="radio" value="oil"/>
<span class="radio-icon">🛢️</span>
<strong>Oil</strong><br/>
<small>Oil tank heating</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step6" name="fuel_type" type="radio" value="electric"/>
<span class="radio-icon">⚡</span>
<strong>Electric</strong><br/>
<small>Electric heating</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step6" name="fuel_type" type="radio" value="other"/>
<span class="radio-icon">❓</span>
<strong>Other</strong><br/>
<small>Solid fuel etc.</small>
</label>
</div>
<div class="error" id="error-step6" role="alert">Please select your current fuel type.</div>
<div class="non-gas-message hidden" id="non-gas-message" role="alert">
                We specialise in gas and LPG boilers. For oil, electric or other fuel types please email us at
                <a href="mailto:info@nimbusheatpumps.co.uk" style="color: #f59e0b; font-weight: 600;">info@nimbusheatpumps.co.uk</a>
                or call 07487 546550 for more details on ASHP options.
            </div>
<button onclick="prevStep(5)" type="button">← Previous</button>
<button onclick="nextStep(7)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step7">
<h2>🔧 Current Boiler Type</h2>
<label>What type is your current boiler?</label>
<div aria-labelledby="boiler-type-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step7" name="current_boiler_type" type="radio" value="combi"/>
<span class="radio-icon">🔥</span>
<strong>Combi</strong><br/>
<small>Combined heating and hot water</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step7" name="current_boiler_type" type="radio" value="system"/>
<span class="radio-icon">🛠️</span>
<strong>System</strong><br/>
<small>With hot water cylinder</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step7" name="current_boiler_type" type="radio" value="regular"/>
<span class="radio-icon">🏠</span>
<strong>Regular/Heat Only</strong><br/>
<small>With tanks and cylinder</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step7" name="current_boiler_type" type="radio" value="back"/>
<span class="radio-icon">📜</span>
<strong>Back Boiler</strong><br/>
<small>Behind fireplace</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step7" name="current_boiler_type" type="radio" value="none"/>
<span class="radio-icon">❌</span>
<strong>None</strong><br/>
<small>No existing boiler</small>
</label>
</div>
<div class="error" id="error-step7" role="alert">Please select your current boiler type.</div>

<hr style="margin:16px 0; border:none; border-top:1px solid var(--border-color, #e5e7eb);"/>

<h3 style="margin-top:0;">Boiler Location</h3>
<label>Will the new boiler be installed in the <strong>same position</strong> as the existing one, or moved?</label>
<div class="radio-group" role="radiogroup" aria-labelledby="boiler-location-label">
  <label class="radio-card">
    <input name="boiler_location" type="radio" value="same"/>
    <span class="radio-icon">📍</span>
    <strong>Same Position</strong><br/>
    <small>No change in location</small>
  </label>
  <label class="radio-card">
    <input name="boiler_location" type="radio" value="moved"/>
    <span class="radio-icon">↔️</span>
    <strong>Moved</strong><br/>
    <small>Relocated from current position</small>
  </label>
  <div class="error hidden" id="error-boiler_location" role="alert">Please confirm boiler location.</div>
  </div>

<div class="quick-swap" id="quick-swap-section" style="margin-top:16px; padding:12px; border:2px dashed var(--border-color,#e5e7eb); border-radius:12px;">
  <label style="display:flex; align-items:center; gap:10px;">
    <input id="quick-swap-checkbox" name="quick_swap" type="checkbox" value="yes"/>
    <span><strong>Quick straight swap quote</strong> (same type and kW)</span>
  </label>
  <div id="quick-swap-options" style="margin-top:10px; display:none;">
    <label>Select your current boiler kW:</label>
    <div class="radio-group" role="radiogroup" aria-labelledby="quick-kw-label">
      <label class="radio-card">
        <input name="quick_kw" type="radio" value="24" disabled/>
        <span class="radio-icon">24</span>
        <strong>~24–26 kW</strong><br/>
        <small>e.g., 24–26kW</small>
      </label>
      <label class="radio-card">
        <input name="quick_kw" type="radio" value="30" disabled/>
        <span class="radio-icon">30</span>
        <strong>~29–32 kW</strong><br/>
        <small>e.g., 29–32kW</small>
      </label>
      <label class="radio-card">
        <input name="quick_kw" type="radio" value="35" disabled/>
        <span class="radio-icon">35</span>
        <strong>~33–35 kW</strong><br/>
        <small>e.g., 33–35kW</small>
      </label>
      <label class="radio-card" id="quick-kw-40-wrap">
        <input id="quick-kw-40" name="quick_kw" type="radio" value="40" disabled/>
        <span class="radio-icon">40</span>
        <strong>~36–40 kW</strong><br/>
        <small>Combi only</small>
      </label>
    </div>
    <div class="error hidden" id="error-quick_kw" role="alert">Please select a kW size for quick swap.</div>
    <div style="margin-top:10px;">
      <button type="button" onclick="nextStep(15)">Get Quick Swap Price →</button>
    </div>
  </div>
</div>
<button onclick="prevStep(6)" type="button">← Previous</button>
<button onclick="nextStep(8)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step8">
<h2>🛁 Hot Water System</h2>
<label>Do you have an existing hot water cylinder? (Required for system or regular boilers per Building Regulations Part G)</label>
<div aria-labelledby="cylinder-existing-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step8" name="existing_cylinder" type="radio" value="yes"/>
<span class="radio-icon">✅</span>
<strong>Yes</strong><br/>
<small>Existing cylinder (vented or unvented)</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step8" name="existing_cylinder" type="radio" value="no"/>
<span class="radio-icon">❌</span>
<strong>No</strong><br/>
<small>No cylinder (e.g., combi setup)</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step8" name="existing_cylinder" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>We'll check during survey</small>
</label>
</div>
<div class="error" id="error-step8" role="alert">Please select if you have an existing cylinder or unsure.</div>
<div class="cylinder-options hidden" id="cylinder-options">
<label>Do you need a new or upgraded unvented cylinder? (G3 compliant, 60-65°C thermostat for Legionella safety)</label>
<div aria-labelledby="cylinder-need-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step8-need" name="need_new_cylinder" type="radio" value="yes"/>
<span class="radio-icon">➕</span>
<strong>Yes, New/Upgrade</strong><br/>
<small>Improve hot water performance (depending on size)</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step8-need" name="need_new_cylinder" type="radio" value="no"/>
<span class="radio-icon">❌</span>
<strong>No</strong><br/>
<small>Use existing if suitable</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step8-need" name="need_new_cylinder" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>We'll advise based on survey</small>
</label>
</div>
<div class="error" id="error-step8-need" role="alert">Please select if you need a new cylinder or unsure.</div>
<label for="cylinder_size">Select size (based on bathrooms and occupants; 35-45L per person per BS EN 12831-3):</label>
<select aria-label="Cylinder size" disabled="" id="cylinder_size" name="cylinder_size">
<option value="">Select after confirming need</option>
<option value="150L">150L (1-2 people, 1 bath)</option>
<option value="210L">210L (3-4 people, 2 baths)</option>
<option value="250L">250L (5+ people, 3+ baths)</option>
</select>
<div class="error" id="error-cylinder-size" role="alert">Please select a suitable cylinder size.</div>
<small style="color: var(--text-secondary); display: block; margin-top: 8px;">
                    Unvented cylinders include safety valves and expansion vessels (G3 compliant). Flow temp ≤55°C (Part L 2025). If unsure, survey will confirm space and suitability.
                </small>
<div id="cylinder-warning" role="alert">Warning: System or regular boilers typically require a hot water cylinder for compliance with Building Regulations Part G. Proceeding without one may not be suitable, but we'll confirm during the survey.</div>
</div>
<button onclick="prevStep(7)" type="button">← Previous</button>
<button onclick="nextStep(9)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step9">
<h2>🔥 Number of Radiators</h2>
<label>How many radiators do you currently have?</label>
<div aria-labelledby="radiators-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step9" name="radiators" type="radio" value="less10"/>
<span class="radio-icon">🔥</span>
<strong>Less than 10</strong><br/>
<small>Small property</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step9" name="radiators" type="radio" value="10-15"/>
<span class="radio-icon">🔥🔥</span>
<strong>10-15 Radiators</strong><br/>
<small>Medium property</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step9" name="radiators" type="radio" value="more15"/>
<span class="radio-icon">🔥🔥🔥</span>
<strong>More than 15</strong><br/>
<small>Large property</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step9" name="radiators" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>We'll count during survey</small>
</label>
</div>
<div class="error" id="error-step9" role="alert">Please select the number of radiators or unsure.</div>
<button onclick="prevStep(8)" type="button">← Previous</button>
<button onclick="nextStep(10)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step10">
<h2>🔥 Flue System Details</h2>
<label>What type of flue system is needed? (Exhaust pipe for safe gas venting)</label>
<small style="color: var(--text-secondary); display: block; margin-bottom: 16px; text-align: center;">
                Horizontal: Straight through wall behind boiler (most common, easier/cheaper). Vertical: Up through roof (for internal boilers or no wall access). If unsure, we'll assess on site - no extra cost for survey.
            </small>
<div aria-labelledby="flue-type-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step10" name="flue_type" type="radio" value="horizontal"/>
<span class="radio-icon">↔️</span>
<strong>Horizontal Flue</strong><br/>
<small>Through external wall</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step10" name="flue_type" type="radio" value="vertical"/>
<span class="radio-icon">↕️</span>
<strong>Vertical Flue</strong><br/>
<small>Through roof</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step10" name="flue_type" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>Engineer will determine during survey</small>
</label>
</div>
<div class="error" id="error-step10" role="alert">Please select a flue type or unsure.</div>
<label for="flue_distance">Additional flue length beyond standard 1m (if known):</label>
<small style="color: var(--text-secondary); display: block; margin-bottom: 16px; text-align: center;">
                Measure from boiler to external exit; max 20m. If unsure, enter 0 - we'll measure on site.
            </small>
<input aria-label="Additional flue length in meters" id="flue_distance" max="20" min="0" name="flue_distance" placeholder="Enter meters (0 for standard)" type="number" value="0"/>
<div class="error" id="error-flue-distance" role="alert">Please enter a valid flue length (0-20 meters).</div>
<button onclick="prevStep(9)" type="button">← Previous</button>
<button onclick="nextStep(11)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step11">
<h2>⛽ Gas Meter Location</h2>
<label>Where is the gas meter relative to the boiler location?</label>
<small style="color: var(--text-secondary); display: block; margin-bottom: 16px; text-align: center;">
                This helps estimate pipe run length. If unsure, select closest or we'll confirm on survey.
            </small>
<div aria-labelledby="gas-meter-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step11" name="gas_meter_distance" type="radio" value="same_wall"/>
<span class="radio-icon">🏠</span>
<strong>Same Wall</strong><br/>
<small>Meter on same wall as boiler</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step11" name="gas_meter_distance" type="radio" value="adjacent_wall"/>
<span class="radio-icon">🏠➡️</span>
<strong>Adjacent Wall</strong><br/>
<small>Meter on adjacent wall</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step11" name="gas_meter_distance" type="radio" value="opposite_wall"/>
<span class="radio-icon">🏠⬅️</span>
<strong>Opposite Wall</strong><br/>
<small>Meter on opposite side</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step11" name="gas_meter_distance" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>We'll measure during survey</small>
</label>
</div>
<div class="error" id="error-step11" role="alert">Please select the gas meter location or unsure.</div>
<button onclick="prevStep(10)" type="button">← Previous</button>
<button onclick="nextStep(12)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step12">
<h2>⛽ Gas Pipe Size</h2>
<label>What size is your current gas supply pipe from meter to boiler location? (Usually 15mm in older homes, 22mm+ for modern; check pipe diameter near meter or boiler)</label>
<small style="color: var(--text-secondary); display: block; margin-bottom: 16px; text-align: center;">
                Most boilers need at least 22mm for safe operation. If 15mm, an upgrade may be required. If unsure, we'll inspect on site - no obligation.
            </small>
<div aria-labelledby="gas-pipe-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input aria-describedby="error-step12" name="gas_pipe_size" type="radio" value="15mm"/>
<span class="radio-icon">📏</span>
<strong>15mm</strong><br/>
<small>Common in older properties; may need upgrade</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step12" name="gas_pipe_size" type="radio" value="22mm"/>
<span class="radio-icon">📏</span>
<strong>22mm</strong><br/>
<small>Standard for most modern boilers</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step12" name="gas_pipe_size" type="radio" value="28mm+"/>
<span class="radio-icon">📏</span>
<strong>28mm or Larger</strong><br/>
<small>For high-output systems</small>
</label>
<label class="radio-card">
<input aria-describedby="error-step12" name="gas_pipe_size" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>Engineer will check during survey</small>
</label>
</div>
<div class="error" id="error-step12" role="alert">Please select your gas pipe size or unsure.</div>
<button onclick="prevStep(11)" type="button">← Previous</button>
<button onclick="nextStep(13)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step13">
<h2>➕ Optional Add-ons</h2>
<label>Select any additional services you would like:</label>
<div class="checkbox-group">
<p style="color: var(--success-color); font-weight: 600; margin-bottom: 16px;">
                    Smart Thermostat Controls included FREE with every installation (£250 value)!
                </p>
<p style="color: var(--success-color); font-weight: 600; margin-bottom: 16px;">
                    We perform a full power flush on all system changes and a MagnaCleanse on sealed-to-sealed system changes - included in all quotes at no extra cost.
                </p>
<label class="checkbox-card">
<input id="radiators-checkbox" name="addons" type="checkbox" value="radiators"/>
<strong>New Radiators</strong> - Upgrade your existing radiators<br/>
<small>Select size and type below if chosen</small>
</label>
<div class="radiator-options hidden" id="radiator-options">
<label for="radiator-size-type">Choose Radiator Size &amp; Type:</label>
<select aria-label="Radiator size and type" id="radiator-size-type" name="radiator_size_type">
<option value="">Select Size &amp; Type</option>
<option value="600x1200_11">600x1200 Type 11</option>
<option value="600x1000_21">600x1000 Type 21</option>
<option value="600x1400_22">600x1400 Type 22</option>
<option value="500x700_11">500x700 Type 11</option>
<option value="500x1100_21">500x1100 Type 21</option>
<option value="300x1000_11">300x1000 Type 11</option>
<option value="600x600_11">600x600 Type 11</option>
<option value="600x800_22">600x800 Type 22</option>
<option value="500x1400_22">Flomasta 500x1400 Type 22 White</option>
<option value="500x1000_22">Flomasta 500x1000 Type 22 White</option>
<option value="500x1200_22">Flomasta 500x1200 Type 22 White</option>
<option value="500x1600_22">Flomasta 500x1600 Type 22 White</option>
<option value="500x1400_21">Flomasta 500x1400 Type 21 White</option>
<option value="500x1200_21">Flomasta 500x1200 Type 21 White</option>
<option value="500x1100_22">Flomasta 500x1100 Type 22 White</option>
<option value="500x1000_21">Flomasta 500x1000 Type 21 White</option>
<option value="500x1800_11">Flomasta 500x1800 Type 11 White</option>
<option value="600x1200_22">Flomasta 600x1200 Type 22 White</option>
<option value="600x1000_22">Flomasta 600x1000 Type 22 White</option>
<option value="600x800_22">Flomasta 600x800 Type 22 White</option>
<option value="600x1000_21">Flomasta 600x1000 Type 21 White</option>
<option value="600x1200_21">Flomasta 600x1200 Type 21 White</option>
<option value="600x1400_21">Flomasta 600x1400 Type 21 White</option>
<option value="600x1200_11">Flomasta 600x1200 Type 11 White</option>
<option value="600x600_22">Flomasta 600x600 Type 22 White</option>
<option value="800x400_towel_chrome_flat">Flomasta 800x400 Chrome Flat Towel</option>
<option value="1600x600_towel_chrome_flat">Flomasta 1600x600 Chrome Flat Towel</option>
<option value="1200x500_towel_chrome_flat">Flomasta 1200x500 Chrome Flat Towel</option>
<option value="1200x600_towel_chrome_flat">Flomasta 1200x600 Chrome Flat Towel</option>
<option value="1200x400_towel_chrome_flat">Flomasta 1200x400 Chrome Flat Towel</option>
<option value="1200x500_towel_black_flat">Flomasta 1200x500 Black Flat Towel</option>
<option value="1000x600_towel_chrome_flat">Flomasta 1000x600 Chrome Flat Towel</option>
<option value="800x500_towel_chrome_flat">Flomasta 800x500 Chrome Flat Towel</option>
<option value="1600x500_towel_chrome_flat">Flomasta 1600x500 Towel</option>
<option value="1800x600_towel_chrome_flat">Flomasta 1800x600 Towel</option>
<option value="800x300_towel_chrome_flat">Flomasta 800x300 Towel</option>
<option value="1000x400_towel_chrome_flat">Flomasta 1000x400 Towel</option>
<option value="1600x400_towel_chrome_flat">Flomasta 1600x400 Towel</option>
</select>
<div class="error" id="error-radiator-size" role="alert">Please select a radiator size and type.</div>
<label for="radiator-count">Number of Radiators:</label>
<input aria-label="Number of radiators" id="radiator-count" max="20" min="1" name="radiator_count" type="number" value="1"/>
<div class="error" id="error-radiator-count" role="alert">Please enter a valid number of radiators (1-20).</div>
<label>Pipework Adjustments Needed?</label>
<small style="color: var(--text-secondary); display: block; margin-bottom: 16px; text-align: center;">
                        If radiators are in new positions or sizes change, pipework may need adjustment. If unsure, select unsure.
                    </small>
<div aria-labelledby="pipework-label" class="radio-group" role="radiogroup">
<label class="radio-card">
<input name="pipework_adjust" type="radio" value="yes"/>
<span class="radio-icon">✅</span>
<strong>Yes</strong><br/>
<small>+£50 per radiator</small>
</label>
<label class="radio-card">
<input name="pipework_adjust" type="radio" value="no"/>
<span class="radio-icon">❌</span>
<strong>No</strong><br/>
<small>Use existing pipework</small>
</label>
<label class="radio-card">
<input name="pipework_adjust" type="radio" value="unsure"/>
<span class="radio-icon">❓</span>
<strong>Unsure</strong><br/>
<small>We'll check</small>
</label>
</div>
<div class="error" id="error-pipework" role="alert">Please select a pipework adjustment option or unsure.</div>
</div>
</div>
<button onclick="prevStep(12)" type="button">← Previous</button>
<button onclick="nextStep(14)" type="button">Next Step →</button>
</div>
<div class="form-step" id="step14">
<h2>👤 Contact Details</h2>
<label for="customer-name">Please enter your full name:</label>
<input aria-describedby="error-step14-name" aria-label="Full name" id="customer-name" name="name" placeholder="Enter your full name" required="" type="text"/>
<div class="error" id="error-step14-name" role="alert">Please enter your full name.</div>
<label for="customer-email">Your email address for quote delivery:</label>
<input aria-describedby="error-step14-email" aria-label="Email address" id="customer-email" name="email" pattern=".+\@.+\..+" placeholder="your.email@example.com" required="" type="email"/>
<small style="color: var(--text-secondary); display: block; margin-top: -12px; margin-bottom: 16px;">
                We'll send your quote and booking confirmation to this email
            </small>
<div class="error" id="error-step14-email" role="alert">Please enter a valid email address.</div>
<label for="customer-phone">Your phone number:</label>
<input aria-describedby="error-step14-phone" aria-label="Phone number" id="customer-phone" name="phone" pattern="^(0|\+44)[0-9]{10}$" placeholder="e.g., 07123456789 or +447123456789" required="" type="tel"/>
<small style="color: var(--text-secondary); display: block; margin-top: -12px; margin-bottom: 16px;">
                Enter a valid UK phone number e.g. 07123456789 or +447123456789
            </small>
<div class="error" id="error-step14-phone" role="alert">Please enter a valid UK phone number (e.g., 07123456789 or +447123456789).</div>
<label for="customer-postcode">Postcode (for service area eligibility):</label>
<input aria-describedby="error-step14-postcode" aria-label="Postcode" id="customer-postcode" name="postcode" pattern="[A-Za-z]{1,2}\d[A-Za-z\d]? ?\d[A-Za-z]{2}" placeholder="e.g., DN15 7PN" required="" type="text"/>
<small style="color: var(--text-secondary); display: block; margin-top: -12px; margin-bottom: 16px;">
                Enter a valid UK postcode to check if we service your area (covering Lincoln, Scunthorpe, Doncaster and Grimsby with priority in Scunthorpe and North Lincolnshire)
            </small>
<div class="error" id="error-step14-postcode" role="alert">Please enter a valid UK postcode (e.g., DN15 7PN).</div>
<button onclick="prevStep(13)" type="button">← Previous</button>
<button onclick="nextStep(15)" type="button">Get My Quote →</button>
</div>
<div class="form-step" id="step15">
<h2>💰 Your Instant Quote &amp; Payment</h2>
<div class="quote-summary" id="quote-summary">
<div style="text-align: center; padding: 40px;">
<div class="loading-spinner" style="margin: 0 auto 20px;"></div>
<p>Calculating your personalised quote...</p>
</div>
</div>
<label>Select Your Preferred Boiler Option:</label>
<div class="sort-controls" style="display:flex; align-items:center; gap:10px; margin: 12px 0 16px; justify-content:center;">
  <label for="boiler-sort" style="font-weight:600; color: var(--dark-green);">Sort by:</label>
  <select id="boiler-sort" aria-label="Sort boiler options" style="padding:8px 10px; border:1px solid var(--border-color); border-radius:10px; color: var(--dark-green); background:#fff;">
    <option value="match">Best match</option>
    <option value="warranty">Warranty (high to low)</option>
    <option value="price">Price (low to high)</option>
    <option value="brand">Brand (A-Z)</option>
  </select>
</div>
<div class="filter-controls" style="display:flex; flex-wrap:wrap; align-items:center; gap:10px; margin: 6px 0 16px; justify-content:center;">
  <label for="filter-brand" style="font-weight:600; color: var(--dark-green);">Brand:</label>
  <select id="filter-brand" aria-label="Filter by brand" style="padding:6px 10px; border:1px solid var(--border-color); border-radius:10px; background:#fff; color: var(--dark-green);">
    <option value="all">All</option>
    <option value="worcester">Worcester</option>
    <option value="vaillant">Vaillant</option>
    <option value="ideal">Ideal</option>
    <option value="baxi">Baxi</option>
    <option value="main">Main</option>
  </select>
  <label for="filter-type" style="font-weight:600; color: var(--dark-green);">Type:</label>
  <select id="filter-type" aria-label="Filter by type" style="padding:6px 10px; border:1px solid var(--border-color); border-radius:10px; background:#fff; color: var(--dark-green);">
    <option value="all">All</option>
    <option value="combi">Combi</option>
    <option value="system">System</option>
    <option value="regular">Regular</option>
  </select>
  <label for="filter-range" style="font-weight:600; color: var(--dark-green);">kW Range:</label>
  <select id="filter-range" aria-label="Filter by kW range" style="padding:6px 10px; border:1px solid var(--border-color); border-radius:10px; background:#fff; color: var(--dark-green);">
    <option value="all">All</option>
    <option value="combi-24">~22–27 kW (Combi)</option>
    <option value="combi-30">~28–33 kW (Combi)</option>
    <option value="combi-35">~33–38 kW (Combi)</option>
    <option value="combi-40">~38–43 kW (Combi)</option>
    <option value="heat-12">~10–14 kW (System/Regular)</option>
    <option value="heat-15">~14–17 kW (System/Regular)</option>
    <option value="heat-18">~17–21 kW (System/Regular)</option>
    <option value="heat-24">~22–27 kW (System/Regular)</option>
    <option value="heat-30">~28–33 kW (System/Regular)</option>
  </select>
  <label style="display:inline-flex; align-items:center; gap:6px; font-weight:600; color: var(--dark-green);">
    <input type="checkbox" id="filter-lpg" aria-label="Show LPG variants only"/>
    LPG only
  </label>
</div>
<div class="view-controls" style="display:flex; align-items:center; justify-content:center; gap:10px; margin: 6px 0 10px;">
  <button type="button" id="view-cards" aria-pressed="true" style="padding:8px 12px; border-radius:10px; border:2px solid var(--primary-color); background:#fff; color:var(--dark-green); font-weight:600;">Cards</button>
  <button type="button" id="view-compare" aria-pressed="false" style="padding:8px 12px; border-radius:10px; border:2px solid var(--primary-color); background:#fff; color:var(--dark-green); font-weight:600;">Compare</button>
  <button type="button" id="restart-quote-link" style="padding:8px 12px; border-radius:10px; border:2px solid var(--primary-color); background:#fff; color: var(--dark-green); font-weight:600;">Restart quote</button>
  <button type="button" id="share-progress" style="padding:8px 12px; border-radius:10px; border:2px solid var(--primary-color); background:#fff; color: var(--dark-green); font-weight:600;">Copy resume link</button>
  <button type="button" id="email-progress" style="padding:8px 12px; border-radius:10px; border:2px solid var(--primary-color); background:#fff; color: var(--dark-green); font-weight:600;">Email my link</button>
  <span id="share-status" aria-live="polite" style="margin-left:8px; font-size:12px; color: var(--text-secondary);"></span>
</div>
<p class="mobile-swipe-hint" aria-hidden="true" style="display:none; text-align:center; margin:6px 0 8px; color: var(--dark-green);">Tip: On mobile, swipe left/right to browse options one by one.</p>
<div class="swiper" id="boiler-options">
<div class="swiper-wrapper"></div>
<div class="swiper-button-prev"></div>
<div class="swiper-button-next"></div>
</div>
<div id="boiler-compare" class="boiler-compare" style="display:none; margin-top: 10px;">
  <div style="overflow:auto;">
    <table style="width:100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th style="text-align:left; padding:10px; border-bottom:2px solid var(--border-color); color: var(--dark-green);">Brand & Model</th>
          <th style="text-align:left; padding:10px; border-bottom:2px solid var(--border-color); color: var(--dark-green);">Type</th>
          <th style="text-align:left; padding:10px; border-bottom:2px solid var(--border-color); color: var(--dark-green);">Warranty</th>
          <th style="text-align:right; padding:10px; border-bottom:2px solid var(--border-color); color: var(--dark-green);">Installed Price</th>
          <th style="text-align:center; padding:10px; border-bottom:2px solid var(--border-color); color: var(--dark-green);">Link</th>
        </tr>
      </thead>
      <tbody id="boiler-compare-body"></tbody>
    </table>
  </div>
</div>
<div class="error" id="error-step15" role="alert">Please select a boiler option before proceeding.</div>
<button class="pay-button" disabled="" id="pay-button" onclick="processPayment()" type="button">
                Secure Payment - Pay Now
            </button>
<div style="text-align: center; margin: 20px 0;">
<small style="color: var(--text-secondary);">Or continue without payment:</small>
</div>
<button onclick="prevStep(14)" type="button">← Previous</button>
<button type="submit">Submit Quote Request</button>
</div>
</form>
</div>
<!-- Swiper JS with fallback -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
if (typeof Swiper === 'undefined') {
  const s = document.createElement('script');
  s.src = 'https://unpkg.com/swiper@11/swiper-bundle.min.js';
  document.head.appendChild(s);
}
</script>
<!-- EmailJS with fallback -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
if (typeof emailjs === 'undefined') {
  const s = document.createElement('script');
  s.src = 'https://cdn.emailjs.com/dist/email.min.js';
  document.head.appendChild(s);
}
</script>
<script>
    class ImprovedEmailJS {
        constructor() {
            this.emailjsReady = false;
            this.maxAttempts = 5;
            this.attempts = 0;
        }
        async init() {
            return new Promise((resolve, reject) => {
                const tryInit = () => {
                    this.attempts++;
                    if (typeof emailjs !== 'undefined') {
                        try {
                            // Obfuscated API key assembly
                            const keyParts = ['kWa-XBmm', 'X87DrluUU'];
                            const apiKey = keyParts.join("");
                            emailjs.init(apiKey);
                            this.emailjsReady = true;
                            resolve(true);
                        } catch (error) {
                            this.emailjsReady = false;
                            reject(error);
                        }
                    } else if (this.attempts < this.maxAttempts) {
                        setTimeout(tryInit, 1000);
                    } else {
                        this.emailjsReady = false;
                        this.showEmailJSError();
                        reject(new Error('EmailJS failed to load'));
                    }
                };
                tryInit();
            });
        }
        showEmailJSError() {
            const warning = document.createElement('div');
            warning.className = 'emailjs-warning';
            warning.style.cssText = `
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                color: #856404;
                padding: 12px;
                margin: 16px 0;
                border-radius: 6px;
                text-align: center;
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                max-width: 90%;
            `;
            warning.innerHTML = `
                <strong>⚠️ Email Service Issue:</strong>
                Quote delivery may be delayed. Please contact us at <a href="mailto:info@nimbusheatpumps.co.uk" style="color: #856404;">info@nimbusheatpumps.co.uk</a> or call 07487 546550.
                <button onclick="this.parentElement.remove()" style="margin-left: 10px; background: none; border: none; color: #856404; cursor: pointer;">×</button>
            `;
            document.body.appendChild(warning);
            setTimeout(() => warning.parentElement && warning.remove(), 10000);
        }
        async sendEmail(templateParams) {
            if (!this.emailjsReady) throw new Error('EmailJS not ready');
            return await emailjs.send("service_ngbua49", "template_s70xbuy", templateParams);
        }
    }
    class SwiperManager {
        constructor() {
            this.swiperInstance = null;
            this.isInitialized = false;
        }
        init(containerEl, options = {}) {
            if (this.swiperInstance) this.destroy();
            const container = typeof containerEl === 'string' ? document.querySelector(containerEl) : containerEl;
            if (!container) return;
            const nextEl = container.querySelector('.swiper-button-next');
            const prevEl = container.querySelector('.swiper-button-prev');
            const defaultOptions = {
                slidesPerView: 1,
                slidesPerGroup: 1,
                slidesPerGroupSkip: 0,
                spaceBetween: 16,
                centeredSlides: true,
                grabCursor: true,
                navigation: { nextEl, prevEl },
                breakpoints: {
                    0:    { slidesPerView: 1, slidesPerGroup: 1, spaceBetween: 16, centeredSlides: false },
                    768:  { slidesPerView: 2, slidesPerGroup: 1, spaceBetween: 24, centeredSlides: false },
                    1024: { slidesPerView: 3, slidesPerGroup: 1, spaceBetween: 24, centeredSlides: false }
                }
            };
            try {
                if (typeof Swiper !== 'undefined') {
                    this.swiperInstance = new Swiper(container, { ...defaultOptions, ...options });
                    this.isInitialized = true;
                    this.swiperInstance.update && this.swiperInstance.update();
                    setTimeout(() => { this.swiperInstance?.navigation?.update && this.swiperInstance.navigation.update(); }, 100);
                    // Explicit navigation handlers: move exactly one slide per click
                    if (nextEl) nextEl.addEventListener('click', (e) => {
                        try { e.preventDefault(); const s = this.swiperInstance; if (!s) return; s.slideTo((s.activeIndex || 0) + 1); } catch {}
                    }, { passive: true });
                    if (prevEl) prevEl.addEventListener('click', (e) => {
                        try { e.preventDefault(); const s = this.swiperInstance; if (!s) return; s.slideTo(Math.max(0, (s.activeIndex || 0) - 1)); } catch {}
                    }, { passive: true });
                } else {
                    this.fallbackToStaticDisplay(container);
                }
            } catch (error) {
                this.fallbackToStaticDisplay(container);
            }
        }
        destroy() {
            if (!this.swiperInstance) return;
            try { this.swiperInstance.destroy(true, true); } catch (e) {}
            this.swiperInstance = null;
            this.isInitialized = false;
        }
        fallbackToStaticDisplay(containerEl) {
            const container = typeof containerEl === 'string' ? document.querySelector(containerEl) : containerEl;
            if (!container) return;
            container.style.display = 'grid';
            container.style.gridTemplateColumns = 'repeat(auto-fit, minmax(300px, 1fr))';
            container.style.gap = '20px';
            container.querySelectorAll('.swiper-button-next, .swiper-button-prev').forEach(btn => btn.style.display = 'none');
        }
    }
    class PriceCalculator {
        constructor() {
            this.costs = { conversion: 0, relocation: 0, flue: 0, gasMeter: 0, gasPipeUpgrade: 0, addons: 0, radiator: 0, cylinder: 0, capAdjustment: 0 };
            this.cylinderPrices = { '150L': 2000, '210L': 2000, '250L': 2000 };
            // Supply-only radiator prices (labour added separately)
            this.radiatorPrices = {
                '600x1200_11': 60,
                '600x1000_21': 58, // prefer Flomasta value where duplicated
                '600x1400_22': 120,
                '500x700_11': 43,
                '500x1100_21': 87,
                '300x1000_11': 30,
                '600x600_11': 40,
                '600x800_22': 60, // prefer Flomasta value where duplicated
                '500x1400_22': 132,
                '500x1000_22': 92,
                '500x1200_22': 132,
                '500x1600_22': 164,
                '500x1400_21': 106,
                '500x1200_21': 88,
                '500x1100_22': 107,
                '500x1000_21': 89,
                '500x1800_11': 97,
                '600x1200_22': 74,
                '600x1000_22': 64,
                '600x600_22': 45,
                '800x400_towel_chrome_flat': 37,
                '1600x600_towel_chrome_flat': 73,
                '1200x500_towel_chrome_flat': 57,
                '1200x600_towel_chrome_flat': 63,
                '1200x400_towel_chrome_flat': 53,
                '1200x500_towel_black_flat': 49,
                '1000x600_towel_chrome_flat': 54,
                '800x500_towel_chrome_flat': 43,
                '1600x500_towel_chrome_flat': 71,
                '1800x600_towel_chrome_flat': 90,
                '800x300_towel_chrome_flat': 31,
                '1000x400_towel_chrome_flat': 48,
                '1600x400_towel_chrome_flat': 71
            };
        }
        safeNumber(value, def = 0) {
            const n = parseFloat(value);
            return isNaN(n) ? def : n;
        }
        calculateTotal(boilerPrice, additionalCosts = {}) {
            const basePrice = this.safeNumber(boilerPrice);
            const conversion = this.safeNumber(additionalCosts.conversion ?? this.costs.conversion);
            const relocation = this.safeNumber(additionalCosts.relocation ?? this.costs.relocation);
            const flue = this.safeNumber(additionalCosts.flue ?? this.costs.flue);
            const gasMeter = this.safeNumber(additionalCosts.gasMeter ?? this.costs.gasMeter);
            const gasPipeUpgrade = this.safeNumber(additionalCosts.gasPipeUpgrade ?? this.costs.gasPipeUpgrade);
            const addons = this.safeNumber(additionalCosts.addons ?? this.costs.addons);
            const radiator = this.safeNumber(additionalCosts.radiator ?? this.costs.radiator);
            const cylinder = this.safeNumber(additionalCosts.cylinder ?? this.costs.cylinder);
            const capAdjustment = this.safeNumber(additionalCosts.capAdjustment ?? this.costs.capAdjustment);
            const total = basePrice + conversion + relocation + flue + gasMeter + gasPipeUpgrade + addons + radiator + cylinder + capAdjustment;
            return (isNaN(total) || total < 0) ? 0 : Math.round(total);
        }
        updateCosts(newCosts) {
            Object.keys(newCosts).forEach(k => { this.costs[k] = this.safeNumber(newCosts[k]); });
        }
    }
    class SafeStorage {
        constructor() { this.isAvailable = this.checkAvailability(); }
        checkAvailability() {
            try { const t='__storage_test__'; localStorage.setItem(t,t); localStorage.removeItem(t); return true; }
            catch (e) { return false; }
        }
        setItem(key, value) {
            if (!this.isAvailable) return false;
            try { localStorage.setItem(key, JSON.stringify(value)); return true; } catch (e) { return false; }
        }
        getItem(key, def=null) {
            if (!this.isAvailable) return def;
            try { const item = localStorage.getItem(key); return item ? JSON.parse(item) : def; }
            catch (e) { try{localStorage.removeItem(key);}catch(_){} return def; }
        }
        removeItem(key) { if (!this.isAvailable) return false; try { localStorage.removeItem(key); return true; } catch (e) { return false; } }
    }
    class FormValidator {
        constructor() { this.errors = new Map(); }
        validateStep(step) {
            this.errors.clear();
            const stepElement = document.getElementById(`step${step}`);
            if (!stepElement) { this.errors.set('general','Step element not found'); return false; }
            let isValid = true;
            const radioGroups = this.getRadioGroups(stepElement);
            radioGroups.forEach(groupName => {
                if (groupName === 'pipework_adjust' && !document.getElementById('radiators-checkbox')?.checked) return;
                if (groupName === 'quick_kw') {
                    const quick = document.querySelector('input[name="quick_swap"]:checked');
                    if (!quick || quick.value !== 'yes') return;
                }
                if (!this.validateRadioGroup(stepElement, groupName)) isValid = false;
            });
            stepElement.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], input[type="number"]').forEach(input => {
                if (!this.validateTextInput(input)) isValid = false;
            });
            if (!this.validateStepSpecific(step, stepElement)) isValid = false;
            if (!isValid) this.showErrors();
            return isValid;
        }
        validateRadioGroup(stepElement, groupName) {
            const checked = stepElement.querySelector(`input[name="${groupName}"]:checked`);
            if (!checked) { this.errors.set(groupName, `Please select a ${groupName.replace('_',' ')} option`); return false; }
            return true;
        }
        validateTextInput(input) {
            if (input.required && !input.value.trim()) { this.errors.set(input.name, `${input.name.replace('_',' ')} is required`); return false; }
            if (input.value && !input.checkValidity()) { this.errors.set(input.name, `Invalid ${input.name.replace('_',' ')} format`); return false; }
            return true;
        }
        validateStepSpecific(step, stepElement) {
            switch(step) {
                case 5: return this.validateWaterFlow(stepElement);
                case 6: return this.validateFuelType(stepElement);
                case 8: return this.validateCylinderOptions(stepElement);
                case 10:return this.validateFlueDetails(stepElement);
                case 13:return this.validateAddons(stepElement);
                case 14:return this.validateContactDetails(stepElement);
                case 15:return this.validateBoilerSelection(stepElement);
                default:return true;
            }
        }
        validateContactDetails(stepElement) {
            const name = stepElement.querySelector('input[name="name"]');
            const email = stepElement.querySelector('input[name="email"]');
            const phone = stepElement.querySelector('input[name="phone"]');
            const postcode = stepElement.querySelector('input[name="postcode"]');
            if (!name || !name.value.trim()) { this.errors.set('name', 'Please enter your full name'); return false; }
            if (!email || !email.value.trim() || !email.checkValidity()) { this.errors.set('email', 'Please enter a valid email address'); return false; }
            if (!phone || !phone.value.trim() || !phone.checkValidity()) { this.errors.set('phone', 'Please enter a valid UK phone number'); return false; }
            if (!postcode || !postcode.value.trim() || !postcode.checkValidity()) { this.errors.set('postcode', 'Please enter a valid UK postcode'); return false; }
            return true;
        }
        validateWaterFlow(stepElement) {
            const waterFlow = stepElement.querySelector('input[name="water_flow"]:checked');
            if (!waterFlow) { this.errors.set('water_flow','Please select your water flow rate'); return false; }
            return true;
        }
        validateFuelType(stepElement) {
            const fuel = stepElement.querySelector('input[name="fuel_type"]:checked');
            if (!fuel) { this.errors.set('fuel_type','Please select your fuel type'); return false; }
            if (fuel.value !== 'gas' && fuel.value !== 'lpg') { this.errors.set('fuel_type','We only support gas and LPG installations'); return false; }
            return true;
        }
        validateCylinderOptions(stepElement) {
            const existing = stepElement.querySelector('input[name="existing_cylinder"]:checked');
            if (!existing) { this.errors.set('existing_cylinder','Please specify if you have an existing cylinder'); return false; }
            const needNew = stepElement.querySelector('input[name="need_new_cylinder"]:checked');
            const size = document.getElementById('cylinder_size');
            const warning = document.getElementById('cylinder-warning');
            if (warning) warning.classList.remove('show');
            if (this.cylinderRequired && existing.value === 'no' && (needNew && needNew.value === 'no')) {
                if (warning) warning.classList.add('show');
                return true;
            }
            if (needNew && needNew.value === 'yes' && (!size || !size.value)) { this.errors.set('cylinder_size','Please select a cylinder size'); return false; }
            return true;
        }
        validateFlueDetails(stepElement) {
            const flueType = stepElement.querySelector('input[name="flue_type"]:checked');
            if (!flueType) { this.errors.set('flue_type','Please select a flue type'); return false; }
            const flueDistance = stepElement.querySelector('input[name="flue_distance"]');
            if (flueDistance) {
                const distance = parseFloat(flueDistance.value);
                if (isNaN(distance) || distance < 0 || distance > 20) { this.errors.set('flue_distance','Please enter a valid flue distance (0-20 meters)'); return false; }
            }
            return true;
        }
        validateAddons(stepElement) {
            const radiatorsCheckbox = document.getElementById('radiators-checkbox');
            if (radiatorsCheckbox && radiatorsCheckbox.checked) {
                const sizeType = stepElement.querySelector('select[name="radiator_size_type"]');
                const count = stepElement.querySelector('input[name="radiator_count"]');
                const pipework = stepElement.querySelector('input[name="pipework_adjust"]:checked');
                if (!sizeType || !sizeType.value) { this.errors.set('radiator_size_type','Please select a radiator size and type'); return false; }
                if (!count || isNaN(parseInt(count.value)) || parseInt(count.value) < 1) { this.errors.set('radiator_count','Please enter a valid number of radiators'); return false; }
                if (!pipework) { this.errors.set('pipework_adjust','Please specify if pipework adjustments are needed'); return false; }
            }
            return true;
        }
        validateBoilerSelection(stepElement) {
            const selectedBoiler = stepElement.querySelector('input[name="selected_boiler"]:checked');
            if (!selectedBoiler) { this.errors.set('selected_boiler','Please select a boiler option'); return false; }
            return true;
        }
        getRadioGroups(stepElement) {
            const radios = stepElement.querySelectorAll('input[type="radio"]');
            return [...new Set(Array.from(radios).map(r => r.name))];
        }
        showErrors() {
            this.errors.forEach((message, field) => {
                const step = this.getStepFromField(field);
                const hyphenField = (field || '').replace(/_/g, '-');
                const candidates = [
                    `error-${field}`,
                    `error-${hyphenField}`,
                    `error-step${step}`,
                    `error-step${step}-${field}`,
                    `error-step${step}-${hyphenField}`
                ];
                const errorElement = candidates
                    .map(id => document.getElementById(id))
                    .find(el => !!el);
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.add('show');
                    errorElement.classList.remove('hidden');
                    setTimeout(() => {
                        errorElement.classList.remove('show');
                        setTimeout(() => errorElement.classList.add('hidden'), 300);
                    }, 5000);
                }
            });
        }
        getStepFromField(field) {
            const fieldToStep = {
                'home_type': 1, 'property_type': 2, 'bedrooms': 3, 'bathrooms': 4, 'occupants': 4, 'water_flow': 5, 'fuel_type': 6,
                'current_boiler_type': 7, 'boiler_location': 7, 'quick_swap': 7, 'quick_kw': 7, 'existing_cylinder': 8, 'need_new_cylinder': 8, 'cylinder_size': 8, 'radiators': 9,
                'flue_type': 10, 'flue_distance': 10, 'gas_meter_distance': 11, 'gas_pipe_size': 12, 'addons': 13, 'radiator_size_type': 13,
                'radiator_count': 13, 'pipework_adjust': 13, 'name': 14, 'email': 14, 'phone': 14, 'postcode': 14, 'selected_boiler': 15
            };
            return fieldToStep[field] || 1;
        }
    }
    class ProgressManager {
        constructor(totalSteps = 18) {
            this.currentStep = 1;
            this.totalSteps = Math.max(1, totalSteps);
        }
        updateProgress(step) {
            this.currentStep = Math.max(1, Math.min(step, this.totalSteps));
            this.updateProgressIndicator();
            this.updateProgressSteps();
        }
        updateProgressIndicator() {
            const progressFill = document.getElementById('progress-fill');
            if (progressFill) {
                const percentage = (this.currentStep / this.totalSteps) * 100;
                progressFill.style.width = `${Math.min(100, Math.max(0, percentage))}%`;
            }
        }
        updateProgressSteps() {
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                const stepNumber = index + 1;
                step.classList.toggle('active', stepNumber === this.currentStep);
                step.classList.toggle('completed', stepNumber < this.currentStep);
            });
        }
    }
    class BoilerDataManager {
        constructor() {
            const base = this.getBoilerDataFixed();
            const extra = this.getAdditionalBoilerData ? this.getAdditionalBoilerData() : {};
            this.boilerData = { ...base, ...extra };

            // Re-bucket any misfiled System/Regular entries based on kW so ranges align with filters
            try {
                const parseKw = (m) => { const x=(m||'').match(/(\d{2})\s*kW/i); return x?parseInt(x[1],10):null };
                const move = (fromKey, toKey, predicate) => {
                    const src = Array.isArray(this.boilerData[fromKey]) ? this.boilerData[fromKey] : [];
                    if (!src.length) return;
                    const keep = []; const moved = [];
                    src.forEach(b => { const kw=parseKw(b.model); if (predicate(b, kw)) moved.push(b); else keep.push(b); });
                    this.boilerData[fromKey] = keep;
                    if (!Array.isArray(this.boilerData[toKey])) this.boilerData[toKey] = [];
                    this.boilerData[toKey].push(...moved);
                };
                move('system24','system18', (b,kw)=> /vogue\s*max/i.test(b.model||'') && kw===18);
                move('system30','system24', (b,kw)=> /vogue\s*max/i.test(b.model||'') && kw===26);
                move('system35','system30', (b,kw)=> /vogue\s*max/i.test(b.model||'') && kw===32);
                move('regular35','regular30', (b,kw)=> /greenstar\s*ri/i.test(b.model||'') && kw===30);
            } catch {}

            // Normalise legacy 35kW buckets to canonical neighbours
            if (this.boilerData.system30) this.boilerData.system35 = this.boilerData.system30;
            if (this.boilerData.regular30) this.boilerData.regular35 = this.boilerData.regular30;

            // Derive LPG variants from gas lists (model titles updated, same URLs)
            const mapLpg = (arr) => (arr || []).map(b => {
                let m = b.model
                    .replace(/\bCombi\b/i, 'LPG Combi')
                    .replace(/\bSystem\b/i, 'LPG System')
                    .replace(/\bHeat Only\b/i, 'LPG Regular')
                    .replace(/\bRegular\b/i, 'LPG Regular');
                return { ...b, model: m };
            });
            // Combi
            this.boilerData.lpg_combi24 = this.boilerData.lpg_combi24 || mapLpg(this.boilerData.combi24);
            this.boilerData.lpg_combi30 = this.boilerData.lpg_combi30 || mapLpg(this.boilerData.combi30);
            this.boilerData.lpg_combi35 = this.boilerData.lpg_combi35 || mapLpg(this.boilerData.combi35);
            this.boilerData.lpg_combi40 = this.boilerData.lpg_combi40 || mapLpg(this.boilerData.combi40);
            // System
            this.boilerData.lpg_system12 = this.boilerData.lpg_system12 || mapLpg(this.boilerData.system12);
            this.boilerData.lpg_system15 = this.boilerData.lpg_system15 || mapLpg(this.boilerData.system15);
            this.boilerData.lpg_system18 = this.boilerData.lpg_system18 || mapLpg(this.boilerData.system18);
            this.boilerData.lpg_system24 = this.boilerData.lpg_system24 || mapLpg(this.boilerData.system24);
            this.boilerData.lpg_system30 = this.boilerData.lpg_system30 || mapLpg(this.boilerData.system30);
            this.boilerData.lpg_system35 = this.boilerData.lpg_system35 || mapLpg(this.boilerData.system35);
            // Regular
            this.boilerData.lpg_regular12 = this.boilerData.lpg_regular12 || mapLpg(this.boilerData.regular12);
            this.boilerData.lpg_regular15 = this.boilerData.lpg_regular15 || mapLpg(this.boilerData.regular15);
            this.boilerData.lpg_regular18 = this.boilerData.lpg_regular18 || mapLpg(this.boilerData.regular18);
            this.boilerData.lpg_regular24 = this.boilerData.lpg_regular24 || mapLpg(this.boilerData.regular24);
            this.boilerData.lpg_regular30 = this.boilerData.lpg_regular30 || mapLpg(this.boilerData.regular30);
            this.boilerData.lpg_regular35 = this.boilerData.lpg_regular35 || mapLpg(this.boilerData.regular35);
            // Enforce canonical catalogue (filter out non-canonical)
            try {
                const canon = {
                    worcester: {
                        combi: { 'greenstar 1000': [24,30], 'greenstar 2000': [25,30], 'greenstar 4000': [25,30], 'greenstar 8000': [30,35,40] },
                        system:{ 'greenstar 4000': [12,15,18,24,30] },
                        regular:{ 'greenstar ri': [12,15,18,24,30] }
                    },
                    vaillant: {
                        combi:{ 'ecotec pro': [24,28,30], 'ecotec plus': [25,32,35,38], 'ecofit pure':[25,30,35] },
                        system:{ 'ecotec plus':[12,18,30] },
                        regular:{ 'ecofit pure':[12,18,30] }
                    },
                    ideal: {
                        combi:{ 'logic max':[24,30,35], 'vogue max':[26,32,40] },
                        system:{ 'logic max':[15,18,24,30] },
                        regular:{ 'logic max':[12,15,18,24,30] }
                    },
                    baxi: {
                        combi:{ '200':[24,28], '400':[24,30,36], '600':[24,30,36], '800':[25,30,36] },
                        system:{ '400':[12,15,18,24,30], '600':[15,24], '800':[18,24,30] },
                        regular:{ '400 heat':[12,18,24] }
                    },
                    main: {
                        combi:{ 'eco compact':[25,30] },
                        system:{ 'eco compact':[18,24,30] },
                        regular:{ 'eco compact':[15,18,24] }
                    }
                };
                const parseKw = (m) => { const x=(m||'').match(/(\d{2})\s*kW/i); return x?parseInt(x[1],10):null };
                const brandKey = (m) => { m=m.toLowerCase(); if(m.includes('worcester')) return 'worcester'; if(m.includes('vaillant')) return 'vaillant'; if(m.includes('baxi')) return 'baxi'; if(m.includes('main')) return 'main'; if(m.includes('ideal')) return 'ideal'; return null };
                const okCanon = (model,type) => {
                    const bk=brandKey(model); if(!bk||!canon[bk]) return false; const typ=(type||'').toLowerCase(); if(!canon[bk][typ]) return false;
                    const kw = parseKw(model)||0; const ml=model.toLowerCase();
                    for(const fam of Object.keys(canon[bk][typ])){ if(ml.includes(fam)) return canon[bk][typ][fam].includes(kw); }
                    return false;
                };
                const keys = Object.keys(this.boilerData);
                keys.forEach(k => {
                    const arr = this.boilerData[k];
                    if(Array.isArray(arr)) this.boilerData[k] = arr.filter(b => okCanon(b.model,b.type));
                });
            } catch {}

            // Deduplicate catalogue entries by brand family + kW + type (+LPG)
            try {
                // Canonical map needed here as well (local to this block)
                const canon = {
                    worcester: {
                        combi: { 'greenstar 1000': [24,30], 'greenstar 2000': [25,30], 'greenstar 4000': [25,30], 'greenstar 8000': [30,35,40] },
                        system:{ 'greenstar 4000': [12,15,18,24,30] },
                        regular:{ 'greenstar ri': [12,15,18,24,30] }
                    },
                    vaillant: {
                        combi:{ 'ecotec pro': [24,28,30], 'ecotec plus': [25,32,35,38], 'ecofit pure':[25,30,35] },
                        system:{ 'ecotec plus':[12,18,30] },
                        regular:{ 'ecofit pure':[12,18,30] }
                    },
                    ideal: {
                        combi:{ 'logic max':[24,30,35], 'vogue max':[26,32,40] },
                        system:{ 'logic max':[15,18,24,30] },
                        regular:{ 'logic max':[12,15,18,24,30] }
                    },
                    baxi: {
                        combi:{ '200':[24,28], '400':[24,30,36], '600':[24,30,36], '800':[25,30,36] },
                        system:{ '400':[12,15,18,24,30], '600':[15,24], '800':[18,24,30] },
                        regular:{ '400 heat':[12,18,24] }
                    },
                    main: {
                        combi:{ 'eco compact':[25,30] },
                        system:{ 'eco compact':[18,24,30] },
                        regular:{ 'eco compact':[15,18,24] }
                    }
                };
                const parseKw = (m) => { const x=(m||'').match(/(\d{2})\s*kW/i); return x?parseInt(x[1],10):null };
                const brandOf = (ml) => ml.includes('worcester')?'worcester': ml.includes('vaillant')?'vaillant': ml.includes('baxi')?'baxi': ml.includes('main')?'main': ml.includes('ideal')?'ideal': null;
                const familyOf = (brand, type, ml) => {
                    if(!brand||!canon[brand]||!canon[brand][type]) return null;
                    const fams = Object.keys(canon[brand][type]);
                    for(const f of fams){ if(ml.includes(f)) return f; }
                    return null;
                };
                const isLpg = (m) => /\blpg\b/i.test(m||'');
                const keys = Object.keys(this.boilerData||{});
                for(const k of keys){
                    const arr = this.boilerData[k]; if(!Array.isArray(arr)) continue;
                    const seen = new Set();
                    const out = [];
                    for(const b of arr){
                        const ml = (b.model||'').toLowerCase();
                        const brand = brandOf(ml);
                        const type = (b.type||'').toLowerCase();
                        const fam = familyOf(brand, type, ml) || 'misc';
                        const kw = parseKw(b.model)||0;
                        const key = [brand||'unknown', fam, kw, type||'unknown', isLpg(b.model)?'lpg':'gas'].join('|');
                        if(seen.has(key)) continue;
                        seen.add(key); out.push(b);
                    }
                    this.boilerData[k] = out;
                }
            } catch {}

            // Ensure coverage: append any canonical models we want to offer that are missing
            try {
                const ensure = (key, entry) => {
                    if(!Array.isArray(this.boilerData[key])) this.boilerData[key]=[];
                    const exists = this.boilerData[key].some(b => (b.model||'').toLowerCase() === entry.model.toLowerCase());
                    if(!exists) this.boilerData[key].push(entry);
                };
                // Vaillant combi additions
                ensure('combi24', {model: 'Vaillant ecoTEC plus 25kW Combi', type: 'combi', price: 2199, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/'});
                ensure('combi24', {model: 'Baxi 800 Combi 25kW (825)', type: 'combi', price: 2249, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-800-combi-2'});
                ensure('combi30', {model: 'Vaillant ecoTEC pro 28kW Combi', type: 'combi', price: 2249, warranty: '7 Years', url: 'https://professional.vaillant.co.uk/for-installers/products/ecotec-pro-24-28-and-30kw-3776.html'});
                ensure('combi30', {model: 'Vaillant ecoTEC pro 30kW Combi', type: 'combi', price: 2199, warranty: '7 Years', url: 'https://professional.vaillant.co.uk/for-installers/products/ecotec-pro-24-28-and-30kw-3776.html'});
                ensure('combi30', {model: 'Vaillant ecoFIT pure 30kW Combi', type: 'combi', price: 2149, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecofit-pure/'});
                ensure('combi35', {model: 'Vaillant ecoFIT pure 35kW Combi', type: 'combi', price: 2349, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecofit-pure/'});
                // High-output combi (38–40kW) canonical options
                ensure('combi40', {model: 'Worcester Greenstar 8000 Life 40kW Combi', type: 'combi', price: 2799, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1'});
                ensure('combi40', {model: 'Worcester Greenstar 8000 Style 40kW Combi', type: 'combi', price: 2849, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1'});
                ensure('combi40', {model: 'Vaillant ecoTEC plus 38kW Combi', type: 'combi', price: 2499, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/'});
                ensure('combi40', {model: 'Ideal Vogue Max 40kW Combi', type: 'combi', price: 2699, warranty: '12 Years', url: 'https://idealheating.com/products/vogue-max-combi'});
                // System 24/30 broaden
                ensure('system24', { model: 'Ideal Logic Max 24kW System', type: 'system', price: 1999, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-system' });
                ensure('system24', { model: 'Baxi 800 System 24kW (824)', type: 'system', price: 1999, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-800-system-2' });
                ensure('system24', { model: 'Main Eco Compact 24kW System', type: 'system', price: 1799, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/system-boilers/main-eco-compact-system' });
                ensure('system30', { model: 'Baxi 800 System 30kW (830)', type: 'system', price: 2099, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-800-system-2' });
                ensure('system30', { model: 'Main Eco Compact 30kW System', type: 'system', price: 1899, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/system-boilers/main-eco-compact-system' });
                // System 18 broaden
                ensure('system18', { model: 'Ideal Logic Max 18kW System', type: 'system', price: 1949, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-system' });
                ensure('system18', { model: 'Baxi 800 System 18kW (818)', type: 'system', price: 1999, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-800-system-2' });
                ensure('system15', { model: 'Baxi 400 System 15kW (415)', type: 'system', price: 1749, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers' });
                ensure('system18', { model: 'Baxi 400 System 18kW (418)', type: 'system', price: 1799, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers' });
                // Regular additions
                ensure('regular12', { model: 'Ideal Logic Max Heat 12kW', type: 'regular', price: 1699, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-heat' });
                ensure('regular24', { model: 'Main Eco Compact 24kW Heat Only', type: 'regular', price: 1799, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/heat-only-boilers/main-eco-compact-heat' });

                // Price overrides: combi35 bucket (raise underpriced 35/36kW entries)
                try {
                    const o = {
                        'Worcester Greenstar 8000 Life 35kW Combi': 2599,
                        'Worcester Greenstar 8000 Style 35kW Combi': 2649,
                        'Baxi 400 Combi 36kW (436)': 2199,
                        'Baxi 600 Combi 36kW (636)': 2249,
                        'Baxi 800 Combi 36kW (836)': 2399,
                        'Vaillant ecoTEC plus 35kW Combi': 2399,
                        'Ideal Logic Max 35kW Combi': 2299,
                        // combi40 canonical prices
                        'Worcester Greenstar 8000 Life 40kW Combi': 2799,
                        'Worcester Greenstar 8000 Style 40kW Combi': 2849,
                        'Vaillant ecoTEC plus 38kW Combi': 2499,
                        'Ideal Vogue Max 40kW Combi': 2699,
                    };
                    if (Array.isArray(this.boilerData.combi35)) {
                        this.boilerData.combi35 = this.boilerData.combi35.map(b => (o[b.model] ? { ...b, price: o[b.model] } : b));
                    }
                    if (Array.isArray(this.boilerData.lpg_combi35)) {
                        this.boilerData.lpg_combi35 = this.boilerData.lpg_combi35.map(b => (o[b.model.replace(/\bLPG\s+/i,'')] ? { ...b, price: o[b.model.replace(/\bLPG\s+/i,'')] } : b));
                    }
                    if (Array.isArray(this.boilerData.combi40)) {
                        this.boilerData.combi40 = this.boilerData.combi40.map(b => (o[b.model] ? { ...b, price: o[b.model] } : b));
                    }
                    if (Array.isArray(this.boilerData.lpg_combi40)) {
                        this.boilerData.lpg_combi40 = this.boilerData.lpg_combi40.map(b => (o[b.model.replace(/\bLPG\s+/i,'')] ? { ...b, price: o[b.model.replace(/\bLPG\s+/i,'')] } : b));
                    }
                } catch {}
            } catch {}

            this.isLoaded = true;
        }
        getAdditionalBoilerData() {
            // Canonical System and Regular ranges we offer (gas lists). LPG derived in constructor.
            const system12 = [
                { model: 'Worcester Greenstar 4000 12kW System', type: 'system', price: 1799, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                { model: 'Vaillant ecoTEC plus 12kW System', type: 'system', price: 1899, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/' },
                { model: 'Baxi 400 System 12kW (412)', type: 'system', price: 1699, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers' }
            ];
            const system15 = [
                { model: 'Worcester Greenstar 4000 15kW System', type: 'system', price: 1849, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                { model: 'Ideal Logic Max 15kW System', type: 'system', price: 1899, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-system' },
                { model: 'Baxi 600 System 15kW (615)', type: 'system', price: 1799, warranty: '7 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-600-system-2' }
            ];
            const system18 = [
                { model: 'Worcester Greenstar 4000 18kW System', type: 'system', price: 1899, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                { model: 'Vaillant ecoTEC plus 18kW System', type: 'system', price: 1999, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/' },
                { model: 'Main Eco Compact 18kW System', type: 'system', price: 1699, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/system-boilers/main-eco-compact-system' }
            ];
            const regular12 = [
                { model: 'Worcester Greenstar Ri 12kW Heat Only', type: 'regular', price: 1699, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-ri' },
                { model: 'Vaillant ecoFIT pure 12kW Heat Only', type: 'regular', price: 1799, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecofit-pure/' },
                { model: 'Baxi 400 Heat 12kW (412)', type: 'regular', price: 1599, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/heat-only-boilers' }
            ];
            const regular15 = [
                { model: 'Worcester Greenstar Ri 15kW Heat Only', type: 'regular', price: 1749, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-ri' },
                { model: 'Ideal Logic Max Heat 15kW', type: 'regular', price: 1799, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-heat' },
                { model: 'Main Eco Compact 15kW Heat Only', type: 'regular', price: 1549, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/heat-only-boilers/main-eco-compact-heat' }
            ];
            const regular18 = [
                { model: 'Worcester Greenstar Ri 18kW Heat Only', type: 'regular', price: 1799, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-ri' },
                { model: 'Vaillant ecoFIT pure 18kW Heat Only', type: 'regular', price: 1899, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecofit-pure/' },
                { model: 'Ideal Logic Max Heat 18kW', type: 'regular', price: 1849, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-heat' },
                { model: 'Main Eco Compact 18kW Heat Only', type: 'regular', price: 1649, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/heat-only-boilers/main-eco-compact-heat' },
                { model: 'Baxi 400 Heat 18kW (418)', type: 'regular', price: 1649, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/heat-only-boilers' }
            ];
            return { system12, system15, system18, regular12, regular15, regular18 };
        }
        validateData() {
            const requiredTypes = ['combi24','combi30','combi35','combi40','system24','system30','system35','regular24','regular30','regular35','lpg_combi24','lpg_combi30','lpg_combi35','lpg_combi40','lpg_system24','lpg_system30','lpg_system35','lpg_regular24','lpg_regular30','lpg_regular35'];
            requiredTypes.forEach(type => {
                if (!this.boilerData[type] || !Array.isArray(this.boilerData[type])) {
                    this.boilerData[type] = this.getFallbackBoilerData(type);
                }
            });
        }
        getFallbackBoilerData(type) {
            return [{ model: 'Standard Boiler (Contact for Details)', price: 2000, warranty: '5 Years', url: 'mailto:info@nimbusheatpumps.co.uk' }];
        }
        
        // Canonical-only static catalogue replacing corrupted legacy inline data
        // LPG variants are derived later; 35kW buckets for system/regular mirror 30kW.
        getBoilerDataFixed() {
            return {
                // Combi 24–25kW
                combi24: [
                    { model: 'Worcester Greenstar 1000 24kW Combi', type: 'combi', price: 1999, warranty: '5 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-1000' },
                    { model: 'Worcester Greenstar 2000 25kW Combi', type: 'combi', price: 2099, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-2000' },
                    { model: 'Worcester Greenstar 4000 25kW Combi', type: 'combi', price: 2249, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                    { model: 'Baxi 200 Combi 24kW (224)', type: 'combi', price: 1949, warranty: '2 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-200-combi-2' },
                    { model: 'Baxi 400 Combi 24kW (424)', type: 'combi', price: 1999, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-400-combi-2-1' },
                    { model: 'Baxi 600 Combi 24kW (624)', type: 'combi', price: 2049, warranty: '7 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-600-combi-2' },
                    { model: 'Baxi 800 Combi 25kW (825)', type: 'combi', price: 2249, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-800-combi-2' },
                    { model: 'Vaillant ecoFIT pure 25kW Combi', type: 'combi', price: 2199, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecofit-pure/' },
                    { model: 'Vaillant ecoTEC pro 24kW Combi', type: 'combi', price: 2199, warranty: '7 Years', url: 'https://professional.vaillant.co.uk/for-installers/products/ecotec-pro-24-28-and-30kw-3776.html' },
                    { model: 'Ideal Logic Max 24kW Combi', type: 'combi', price: 2099, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-combi' },
                    { model: 'Ideal Vogue Max 26kW Combi', type: 'combi', price: 2199, warranty: '12 Years', url: 'https://idealheating.com/products/vogue-max-combi' },
                    { model: 'Main Eco Compact 25kW Combi', type: 'combi', price: 1899, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/combi-boilers/main-eco-compact-combi' }
                ],
                // Combi ~30–32kW
                combi30: [
                    { model: 'Worcester Greenstar 1000 30kW Combi', type: 'combi', price: 1999, warranty: '5 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-1000' },
                    { model: 'Worcester Greenstar 2000 30kW Combi', type: 'combi', price: 2099, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-2000' },
                    { model: 'Worcester Greenstar 4000 30kW Combi', type: 'combi', price: 2249, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                    { model: 'Worcester Greenstar 8000 Life 30kW Combi', type: 'combi', price: 2449, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1' },
                    { model: 'Worcester Greenstar 8000 Style 30kW Combi', type: 'combi', price: 2499, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1' },
                    { model: 'Baxi 200 Combi 28kW (228)', type: 'combi', price: 1999, warranty: '2 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-200-combi-2' },
                    { model: 'Baxi 400 Combi 30kW (430)', type: 'combi', price: 2049, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-400-combi-2-1' },
                    { model: 'Baxi 600 Combi 30kW (630)', type: 'combi', price: 2099, warranty: '7 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-600-combi-2' },
                    { model: 'Baxi 800 Combi 30kW (830)', type: 'combi', price: 2299, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-800-combi-2' },
                    { model: 'Vaillant ecoTEC plus 32kW Combi', type: 'combi', price: 2299, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/' },
                    { model: 'Ideal Logic Max 30kW Combi', type: 'combi', price: 2199, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-combi' },
                    { model: 'Ideal Vogue Max 32kW Combi', type: 'combi', price: 2399, warranty: '12 Years', url: 'https://idealheating.com/products/vogue-max-combi' },
                    { model: 'Main Eco Compact 30kW Combi', type: 'combi', price: 2049, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/combi-boilers/main-eco-compact-combi' }
                ],
                // Combi ~35–36kW
                combi35: [
                    { model: 'Worcester Greenstar 8000 Life 35kW Combi', type: 'combi', price: 2599, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1' },
                    { model: 'Worcester Greenstar 8000 Style 35kW Combi', type: 'combi', price: 2649, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1' },
                    { model: 'Baxi 400 Combi 36kW (436)', type: 'combi', price: 2199, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-400-combi-2-1' },
                    { model: 'Baxi 600 Combi 36kW (636)', type: 'combi', price: 2249, warranty: '7 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-600-combi-2' },
                    { model: 'Baxi 800 Combi 36kW (836)', type: 'combi', price: 2399, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/combi-boilers/baxi-800-combi-2' },
                    { model: 'Vaillant ecoTEC plus 35kW Combi', type: 'combi', price: 2399, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/' },
                    { model: 'Ideal Logic Max 35kW Combi', type: 'combi', price: 2299, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-combi' }
                ],
                // High-output combi 38–40kW
                combi40: [
                    { model: 'Worcester Greenstar 8000 Life 40kW Combi', type: 'combi', price: 2799, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1' },
                    { model: 'Worcester Greenstar 8000 Style 40kW Combi', type: 'combi', price: 2849, warranty: '12 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-8000-style-1' },
                    { model: 'Vaillant ecoTEC plus 38kW Combi', type: 'combi', price: 2499, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/' },
                    { model: 'Ideal Vogue Max 40kW Combi', type: 'combi', price: 2699, warranty: '12 Years', url: 'https://idealheating.com/products/vogue-max-combi' }
                ],
                // System canonical buckets we offer directly (others derived)
                system24: [
                    { model: 'Worcester Greenstar 4000 24kW System', type: 'system', price: 1899, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                    { model: 'Ideal Logic Max 24kW System', type: 'system', price: 1999, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-system' },
                    { model: 'Baxi 600 System 24kW (624)', type: 'system', price: 1999, warranty: '7 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-600-system-2' },
                    { model: 'Baxi 800 System 24kW (824)', type: 'system', price: 1999, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-800-system-2' },
                    { model: 'Baxi 400 System 24kW (424)', type: 'system', price: 1799, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers' },
                    { model: 'Main Eco Compact 24kW System', type: 'system', price: 1799, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/system-boilers/main-eco-compact-system' }
                ],
                system30: [
                    { model: 'Worcester Greenstar 4000 30kW System', type: 'system', price: 1999, warranty: '10 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-4000' },
                    { model: 'Vaillant ecoTEC plus 30kW System', type: 'system', price: 2049, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecotec-plus/' },
                    { model: 'Ideal Logic Max 30kW System', type: 'system', price: 2099, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-system' },
                    { model: 'Baxi 800 System 30kW (830)', type: 'system', price: 2099, warranty: '10 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers/baxi-800-system-2' },
                    { model: 'Baxi 400 System 30kW (430)', type: 'system', price: 1899, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/system-boilers' },
                    { model: 'Main Eco Compact 30kW System', type: 'system', price: 1899, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/system-boilers/main-eco-compact-system' }
                ],
                // Regular canonical buckets
                regular24: [
                    { model: 'Worcester Greenstar Ri 24kW Heat Only', type: 'regular', price: 1899, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-ri-12kw-to-24kw' },
                    { model: 'Ideal Logic Max Heat 24kW', type: 'regular', price: 1850, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-heat' },
                    { model: 'Baxi 400 Heat 24kW', type: 'regular', price: 1850, warranty: '5 Years', url: 'https://www.baxi.co.uk/products/boilers/heat-only-boilers/baxi-400-heat' },
                    { model: 'Main Eco Compact 24kW Heat Only', type: 'regular', price: 1799, warranty: '5 Years', url: 'https://www.mainheating.co.uk/main-products/gas-boilers/heat-only-boilers/main-eco-compact-heat' }
                ],
                regular30: [
                    { model: 'Worcester Greenstar Ri 30kW Heat Only', type: 'regular', price: 1999, warranty: '7 Years', url: 'https://www.worcester-bosch.co.uk/products/boilers/directory/greenstar-ri-27kw-and-30kw' },
                    { model: 'Vaillant ecoFIT pure 30kW Heat Only', type: 'regular', price: 2100, warranty: '10 Years', url: 'https://www.vaillant.co.uk/product-systems/gas-boilers/ecofit-pure/' },
                    { model: 'Ideal Logic Max Heat 30kW', type: 'regular', price: 1950, warranty: '10 Years', url: 'https://idealheating.com/products/logic-max-heat' }
                ]
            };
        }
        getBoilersForScenario(scenario) {
            const boilers = this.boilerData[scenario] || [];
            if (boilers.length === 0) {
                return this.getFallbackBoilerData(scenario);
            }
            return boilers;
        }
    }
    class DependencyManager {
        constructor() {
            this.dependencies = { swiper: false, emailjs: false, fonts: false };
            this.checkDependencies();
        }
        checkDependencies() {
            this.dependencies.swiper = typeof Swiper !== 'undefined';
            this.dependencies.emailjs = typeof emailjs !== 'undefined';
            this.checkGoogleFonts();
        }
        checkGoogleFonts() {
            const testElement = document.createElement('span');
            testElement.style.fontFamily = 'Inter, sans-serif';
            testElement.style.position = 'absolute';
            testElement.style.visibility = 'hidden';
            testElement.textContent = 'Test';
            document.body.appendChild(testElement);
            const computedStyle = window.getComputedStyle(testElement);
            this.dependencies.fonts = computedStyle.fontFamily.includes('Inter');
            document.body.removeChild(testElement);
            if (!this.dependencies.fonts) {
                this.loadFontFallback();
            }
        }
        loadFontFallback() {
            const style = document.createElement('style');
            style.textContent = `
                #quote-form-container {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif !important;
                }
                #quote-form-container h2 {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif !important;
                }
            `;
            document.head.appendChild(style);
        }
        getStatus() {
            return this.dependencies;
        }
    }
    class ImprovedBoilerQuoteForm {
        autosaveTimer = null;
        constructor() {
            this.currentStep = 1;
            this.totalSteps = 15;
            this.boilers = [];
            this.costs = { conversion: 0, relocation: 0, flue: 0, gasMeter: 0, gasPipeUpgrade: 0, addons: 0, radiator: 0, cylinder: 0, capAdjustment: 0 };
            this.formData = {};
            this.mixedMode = false;
            this.systemMode = false;
            this.cylinderRequired = false;
            this.skipUnload = false; // allow deliberate navigations (e.g., Pay Now) to bypass beforeunload
            this.beforeUnloadHandler = null; // will be set in attachEventListeners
            this.emailjs = new ImprovedEmailJS();
            this.swiperManager = new SwiperManager();
            this.priceCalculator = new PriceCalculator();
            this.storage = new SafeStorage();
            this.validator = new FormValidator();
            this.progressManager = new ProgressManager(this.totalSteps);
            this.boilerDataManager = new BoilerDataManager();
            this.dependencyManager = new DependencyManager();
            this.init();
        }
        async init() {
            try { await this.emailjs.init(); } catch {}
            this.attachEventListeners();
            this.loadFormData();
            this.progressManager.updateProgress(this.currentStep);
            try { this.computeFromBadges(); } catch {}
        }
        computeFromBadges() {
            const swapEl = document.getElementById('from-price-swap');
            const convEl = document.getElementById('from-price-conversion');
            if (!swapEl && !convEl) return;
            // Helper: get cheapest adjusted base in scenario
            const cheapestFor = (scenario) => {
                try {
                    const list = this.boilerDataManager.getBoilersForScenario(scenario) || [];
                    if (!list.length) return null;
                    const withAdj = list.map(b => ({ b, base: this.getAdjustedBasePrice({ ...b, type: scenario.replace(/[0-9]+$/, '').replace('lpg_','') }) }));
                    withAdj.sort((x,y) => x.base - y.base);
                    return withAdj[0];
                } catch { return null; }
            };
            // Swap (like-for-like combi) minimal route assumptions
            if (swapEl) {
                const ch = cheapestFor('combi24');
                if (ch) {
                    const total = this.priceCalculator.calculateTotal(ch.base, { conversion: 0, relocation: 0, flue: 100, gasMeter: 0, gasPipeUpgrade: 0, addons: 0, radiator: 0, cylinder: 0, capAdjustment: 0 });
                    const capped = this.applyCompetitorCeiling(total, { cylinder: 0 }, ch.b, true);
                    swapEl.textContent = this.formatPrice(capped);
                }
            }
            // Conversion (system/regular -> combi) minimal route assumptions
            if (convEl) {
                const ch = cheapestFor('combi30');
                if (ch) {
                    const total = this.priceCalculator.calculateTotal(ch.base, { conversion: 1500, relocation: 0, flue: 100, gasMeter: 0, gasPipeUpgrade: 0, addons: 0, radiator: 0, cylinder: 0, capAdjustment: 0 });
                    const capped = this.applyCompetitorCeiling(total, { cylinder: 0 }, ch.b, false);
                    convEl.textContent = this.formatPrice(capped);
                }
            }
        }
        formatPrice(amount) {
            try {
                const t = Math.max(0, Math.round(parseFloat(amount) || 0));
                const rounded = Math.max(0, Math.floor(t / 10) * 10 - 1);
                const shown = (rounded > 0 ? rounded : t).toLocaleString("en-GB");
                return `£${shown}`;
            } catch { return `£${amount}`; }
        }
        // Mirror the visual rounding used by formatPrice but return a number
        normalizeAmountForDisplay(amount) {
            try {
                const t = Math.max(0, Math.round(parseFloat(amount) || 0));
                const rounded = Math.max(0, Math.floor(t / 10) * 10 - 1);
                return (rounded > 0 ? rounded : t);
            } catch {
                const t = Math.round(parseFloat(amount) || 0);
                return t > 0 ? t : 0;
            }
        }
        attachEventListeners() {
            const container = document.getElementById('quote-form-container');
            if (!container) return;
            container.addEventListener('change', this.handleInputChange.bind(this));
            container.addEventListener('click', this.handleClicks.bind(this));
            document.addEventListener('keydown', this.handleKeyboard.bind(this));
            const form = document.getElementById('boiler-form');
            if (form) form.addEventListener('submit', this.handleSubmit.bind(this));
            this.beforeUnloadHandler = null;
            // Leaving-page warning disabled
        }
        resetToStart() {
            try {
                this.storage.removeItem('boilerFormData');
                this.storage.removeItem('currentStep');
                this.storage.removeItem('formCompleted');
            } catch {}
            const form = document.getElementById('boiler-form');
            if (form) form.reset();
            this.formData = {};
            this.navigateToStep(1);
        }
        showResumeBanner(savedStep) {
            try {
                const container = document.getElementById('quote-form-container');
                if (!container || container.querySelector('.resume-banner')) return;
                const banner = document.createElement('div');
                banner.className = 'resume-banner';
                banner.style.cssText = 'margin: 0 0 16px 0; padding: 12px 16px; border: 2px solid var(--primary-color, #00a676); border-radius: var(--radius-md, 12px); background: rgba(0,166,118,0.06); display:flex; flex-wrap:wrap; align-items:center; gap:10px; justify-content:space-between;';
                const text = document.createElement('div');
                text.textContent = 'Resume your quote where you left off, or start again?';
                text.style.cssText = 'font-weight:600; color: var(--dark-green, #007a57);';
                const actions = document.createElement('div');
                const btnResume = document.createElement('button');
                btnResume.type = 'button';
                btnResume.textContent = `Resume (step ${savedStep})`;
                btnResume.style.cssText = 'padding:8px 12px; border-radius:10px; border:2px solid var(--primary-color,#00a676); background:#fff; color:var(--dark-green,#007a57); font-weight:600; cursor:pointer;';
                const btnRestart = document.createElement('button');
                btnRestart.type = 'button';
                btnRestart.textContent = 'Start again';
                btnRestart.style.cssText = 'padding:8px 12px; border-radius:10px; border:2px solid #e11d48; background:#fff; color:#e11d48; font-weight:600; cursor:pointer; margin-left:8px;';
                actions.appendChild(btnResume);
                actions.appendChild(btnRestart);
                banner.appendChild(text);
                banner.appendChild(actions);
                container.prepend(banner);
                btnResume.addEventListener('click', () => {
                    banner.remove();
                    this.navigateToStep(savedStep);
                });
                btnRestart.addEventListener('click', () => {
                    banner.remove();
                    this.resetToStart();
                });
            } catch {}
        }
        scheduleAutosave() {
            if (this.autosaveTimer) clearTimeout(this.autosaveTimer);
            this.autosaveTimer = setTimeout(() => this.autoSave(), 1500);
        }
        handleInputChange(e) {
            if (e.target.type === 'radio') this.handleRadioChange(e.target);
            else if (e.target.type === 'checkbox') this.handleCheckboxChange(e.target);
            this.formData[e.target.name] = e.target.value;
            this.hideErrors();
            this.scheduleAutosave();
            if (e.target.name === 'existing_cylinder') {
                this.updateCylinderRequirement();
            }
            if (e.target.name === 'existing_cylinder' || e.target.name === 'need_new_cylinder') {
                this.toggleCylinderOptions(e.target.name === 'existing_cylinder' ? e.target.value === 'no' || e.target.value === 'unsure' || this.formData.current_boiler_type !== 'combi' : true);
                this.checkCylinderWarning();
            }
            if (e.target.name === 'need_new_cylinder' && e.target.value === 'yes') {
                document.getElementById('cylinder_size').disabled = false;
                this.recommendCylinderSize();
            }
            // Add handling for cylinder update inputs on final page
            if (e.target.name === 'existing_cylinder_update' || e.target.name === 'need_new_cylinder_update' || e.target.name === 'cylinder_size_update') {
                this.updateCylinderFromUpdate(e.target);
                this.recalculateQuote();
            }
        }

        updateCylinderFromUpdate(input) {
            const formData = new FormData(document.getElementById('boiler-form'));
            const data = Object.fromEntries(formData);

            // Use updated values if present, otherwise fall back to original
            const existingCylinder = data.existing_cylinder_update || data.existing_cylinder;
            const needNewCylinder = data.need_new_cylinder_update || data.need_new_cylinder;
            const cylinderSize = data.cylinder_size_update || data.cylinder_size;

            // Update the form data
            this.formData.existing_cylinder = existingCylinder;
            this.formData.need_new_cylinder = needNewCylinder;
            this.formData.cylinder_size = cylinderSize;
        }

        recalculateQuote() {
            const formDataObj = new FormData(document.getElementById('boiler-form'));
            let data = Object.fromEntries(formDataObj);

            // Normalize update keys to original keys for compatibility
            if ('existing_cylinder_update' in data) data.existing_cylinder = data.existing_cylinder_update;
            if ('need_new_cylinder_update' in data) data.need_new_cylinder = data.need_new_cylinder_update;
            if ('cylinder_size_update' in data) data.cylinder_size = data.cylinder_size_update;

            // Get recommended type from current summary
            const summaryText = document.querySelector('#quote-summary h3')?.textContent || '';
            const recommendedTypeMatch = summaryText.match(/Recommended System:\s*(.+)/);
            const recommendedType = recommendedTypeMatch ? recommendedTypeMatch[1].trim() : '';

            const { scenario } = this.determineBoilerScenario(data);
            this.calculateAdditionalCosts(data, scenario, data.current_boiler_type);
            this.boilers = this.getBoilerOptions(scenario);
            this.updateBoilerOptions();
        }
        updateCompareTable(displayOrder, currentData) {
            try {
                const tbody = document.getElementById('boiler-compare-body');
                if (!tbody) return;
                tbody.innerHTML = '';
                const readYears = (modelLower) => {
                    const brandKey =
                        modelLower.includes('worcester') ? 'worcester' :
                        modelLower.includes('vaillant')  ? 'vaillant'  :
                        modelLower.includes('baxi')      ? 'baxi'      :
                        modelLower.includes('main')      ? 'main'      :
                        modelLower.includes('ideal')     ? 'ideal'     : null;
                    const map = { worcester: { 'greenstar 1000':5,'greenstar 2000':7,'greenstar 4000':10,'greenstar 8000':12 }, vaillant:{ 'ecotec pro':7,'ecotec plus':10,'ecofit pure':10,'ecotec exclusive':10 }, baxi:{ '200':2,'400':5,'600':7,'800':10,'platinum':10,'duo-tec':7 }, main:{ 'eco compact':5 }, ideal:{ 'logic max':10,'vogue max':12 } };
                    if (!brandKey || !map[brandKey]) return null;
                    for (const [needle, yrs] of Object.entries(map[brandKey])) {
                        if (modelLower.includes(needle)) return yrs;
                    }
                    return null;
                };
                displayOrder.forEach((b) => {
                    const tr = document.createElement('tr');
                    const modelLower = (b.model||'').toLowerCase();
                    const tdModel = document.createElement('td'); tdModel.style.padding='10px'; tdModel.style.borderBottom='1px solid var(--border-color)'; tdModel.textContent = b.model.replace(/[<>"'&]/g, '');
                    const tdType = document.createElement('td'); tdType.style.padding='10px'; tdType.style.borderBottom='1px solid var(--border-color)'; tdType.textContent = (b.type||'').charAt(0).toUpperCase() + (b.type||'').slice(1);
                    const tdWarranty = document.createElement('td'); tdWarranty.style.padding='10px'; tdWarranty.style.borderBottom='1px solid var(--border-color)'; const yrs = readYears(modelLower) ?? (parseInt((b.warranty||'').match(/\d+/)?.[0]||'',10)||null); tdWarranty.textContent = yrs ? `${yrs} Years` : (b.warranty || 'Manufacturer warranty');
                    const tdPrice = document.createElement('td'); tdPrice.style.padding='10px'; tdPrice.style.borderBottom='1px solid var(--border-color)'; tdPrice.style.textAlign='right';
                    let conversionCost = this.costs.conversion; let gasPipeUpgradeCost = this.costs.gasPipeUpgrade; let cylinderCost = (b.type !== 'combi' && currentData.need_new_cylinder !== 'no') ? this.costs.cylinder : 0; if (b.type === currentData.current_boiler_type) { conversionCost = 0; }
                    const basePrice = this.getAdjustedBasePrice(b);
                    const total = this.priceCalculator.calculateTotal(basePrice, { conversion: conversionCost, relocation: this.costs.relocation, flue: this.costs.flue, gasMeter: this.costs.gasMeter, gasPipeUpgrade: gasPipeUpgradeCost, addons: this.costs.addons, radiator: this.costs.radiator, cylinder: cylinderCost, capAdjustment: this.costs.capAdjustment });
                    const isSwap = (b.type === currentData.current_boiler_type) && currentData.current_boiler_type !== 'none' && currentData.current_boiler_type !== 'back';
                    const capped = this.applyCompetitorCeiling(total, { cylinder: cylinderCost }, b, isSwap);
                    tdPrice.textContent = this.formatPrice(capped);
                    const tdLink = document.createElement('td'); tdLink.style.padding='10px'; tdLink.style.borderBottom='1px solid var(--border-color)'; tdLink.style.textAlign='center';
                    const a = document.createElement('a'); a.href = b.url; a.target = '_blank'; a.className='manufacturer-link'; a.textContent='View Details'; tdLink.appendChild(a);
                    tr.appendChild(tdModel); tr.appendChild(tdType); tr.appendChild(tdWarranty); tr.appendChild(tdPrice); tr.appendChild(tdLink);
                    tbody.appendChild(tr);
                });
            } catch {}
        }
        checkCylinderWarning() {
            const existing = this.formData.existing_cylinder;
            const needNew = this.formData.need_new_cylinder;
            const warning = document.getElementById('cylinder-warning');
            if (!warning) return;
            if (this.cylinderRequired && existing === 'no' && needNew === 'no') warning.classList.add('show');
            else warning.classList.remove('show');
        }
        handleRadioChange(radio) {
            const card = radio.closest('.radio-card');
            if (!card) return;
            const group = card.closest('.radio-group');
            group.querySelectorAll('.radio-card').forEach(c => c.classList.remove('selected'));
            if (radio.checked) card.classList.add('selected');
            if (radio.name === 'fuel_type') this.handleFuelTypeChange(radio.value);
            if (radio.name === 'current_boiler_type') { this.updateCylinderRequirement(); this.updateQuickKwAvailability(radio.value); }
            if (radio.name === 'selected_boiler') {
                const payBtn = document.getElementById('pay-button');
                if (payBtn) payBtn.disabled = false;
            }
        }
        handleCheckboxChange(checkbox) {
            const card = checkbox.closest('.checkbox-card');
            if (card) card.classList.toggle('selected', checkbox.checked);
            if (checkbox.id === 'radiators-checkbox') this.toggleRadiatorOptions(checkbox.checked);
            if (checkbox.name === 'quick_swap') {
                const opts = document.getElementById('quick-swap-options');
                const radios = document.querySelectorAll('input[name="quick_kw"]');
                if (opts) opts.style.display = checkbox.checked ? '' : 'none';
                radios.forEach(r => { r.disabled = !checkbox.checked; if (!checkbox.checked) r.checked = false; });
                // Ensure availability matches current type when enabling
                const ct = document.querySelector('input[name="current_boiler_type"]:checked')?.value;
                if (ct) this.updateQuickKwAvailability(ct);
            }
        }
        updateQuickKwAvailability(type) {
            try {
                const kw40Wrap = document.getElementById('quick-kw-40-wrap');
                const kw40 = document.getElementById('quick-kw-40');
                const isCombi = (type === 'combi');
                if (kw40Wrap) kw40Wrap.style.display = isCombi ? '' : 'none';
                if (kw40) { kw40.disabled = !isCombi; if (!isCombi && kw40.checked) kw40.checked = false; }
            } catch {}
        }
        handleClicks(e) {
            if (e.target.classList.contains('progress-step') && e.target.classList.contains('completed')) {
                const step = parseInt(e.target.dataset.step);
                this.navigateToStep(step);
            }
        }
        handleKeyboard(e) {
            if (e.key === 'ArrowLeft' && this.currentStep > 1) this.prevStep(this.currentStep - 1);
            else if (e.key === 'ArrowRight' && this.currentStep < this.totalSteps) this.nextStep(this.currentStep + 1);
        }
        handleFuelTypeChange(value) {
            const message = document.getElementById('non-gas-message');
            if (message) message.classList.toggle('hidden', value === 'gas' || value === 'lpg');
        }
        toggleRadiatorOptions(show) {
            const options = document.getElementById('radiator-options');
            if (!options) return;
            options.classList.toggle('hidden', !show);
            if (!show) {
                const sizeType = document.querySelector('select[name="radiator_size_type"]');
                const count = document.querySelector('input[name="radiator_count"]');
                if (sizeType) sizeType.value = '';
                if (count) count.value = 1;
                document.querySelectorAll('input[name="pipework_adjust"]').forEach(r => r.checked = false);
            }
        }
        toggleCylinderOptions(show) {
            const options = document.getElementById('cylinder-options');
            if (options) {
                options.classList.toggle('hidden', !show);
                if (show) this.recommendCylinderSize();
            }
        }
        recommendCylinderSize() {
            const baths = this.getBathCount(this.formData.bathrooms);
            const occupants = this.getOccupantFactor(this.formData.occupants);
            const maxFactor = Math.max(baths, occupants);
            let recommended = '150L';
            if (maxFactor <= 1.5) recommended = '150L';
            else if (maxFactor <= 2) recommended = '210L';
            else recommended = '250L';
            const select = document.getElementById('cylinder_size');
            if (select) select.value = recommended;
        }
        updateCylinderRequirement() {
            const currentType = this.formData.current_boiler_type;
            this.cylinderRequired = (currentType === 'system' || currentType === 'regular');
            const existing = this.formData.existing_cylinder;
            if (this.cylinderRequired && existing === 'no') {
                const yes = document.querySelector('input[name="need_new_cylinder"][value="yes"]');
                if (yes) yes.checked = true;
                const size = document.getElementById('cylinder_size');
                if (size) size.disabled = false;
                this.recommendCylinderSize();
            } else if (existing === 'yes') {
                const size = document.getElementById('cylinder_size');
                if (size) size.disabled = !document.querySelector('input[name="need_new_cylinder"][value="yes"]:checked');
            }
        }
        validateStep(step) { return this.validator.validateStep(step); }
        getRadioGroups(stepElement) { return this.validator.getRadioGroups(stepElement); }
        showError(errorId) {
            const error = document.getElementById(errorId);
            if (error) {
                error.classList.add('show');
                error.classList.remove('hidden');
                setTimeout(() => { error.classList.remove('show'); setTimeout(() => error.classList.add('hidden'), 300); }, 5000);
            }
        }
        hideErrors() {
            document.querySelectorAll('.error.show').forEach(error => {
                error.classList.remove('show');
                setTimeout(() => error.classList.add('hidden'), 300);
            });
        }
        nextStep(step) {
            if (!this.validateStep(this.currentStep)) return;
            if (step === 15) {
                this.showLoading();
                setTimeout(() => {
                    this.calculateQuote();
                    this.hideLoading();
                    this.navigateToStep(step);
                }, 1000);
            } else {
                this.navigateToStep(step);
            }
        }
        prevStep(step) { this.navigateToStep(step); }
        navigateToStep(step) {
            document.querySelectorAll('.form-step').forEach(s => {
                s.classList.remove('active');
                s.setAttribute('aria-hidden', 'true');
            });
            const targetStep = document.getElementById(`step${step}`);
            if (targetStep) {
                targetStep.classList.add('active');
                targetStep.setAttribute('aria-hidden', 'false');
                targetStep.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            this.currentStep = step;
            this.scheduleAutosave();
            this.progressManager.updateProgress(this.currentStep);
            this.hideErrors();
            if (step === 6) {
                const fuel = document.querySelector('input[name="fuel_type"]:checked');
                if (fuel && (fuel.value !== 'gas' && fuel.value !== 'lpg')) {
                    document.getElementById('non-gas-message')?.classList.remove('hidden');
                }
            }
            if (step === 8) {
                this.updateCylinderRequirement();
                this.toggleCylinderOptions(true);
                this.checkCylinderWarning();
            }
            if (step === 15) {
                if (this.storage.getItem('formCompleted')) {
                    this.showSuccessMessage();
                }
            }
        }
        showLoading() { const overlay = document.getElementById('loading-overlay'); if (overlay) overlay.style.display = 'flex'; }
        hideLoading() { const overlay = document.getElementById('loading-overlay'); if (overlay) overlay.style.display = 'none'; }
        calculateQuote() {
            try {
                console.log('Starting calculateQuote');
                const formData = new FormData(document.getElementById('boiler-form'));
                const data = Object.fromEntries(formData);
                console.log('Form data extracted:', Object.keys(data));

                const { recommendedType, scenario, mixedMode, systemMode } = this.determineBoilerScenario(data);
                console.log('Scenario determination result:', { recommendedType, scenario, mixedMode, systemMode });

                this.mixedMode = mixedMode;
                this.systemMode = systemMode;

                this.calculateAdditionalCosts(data, scenario, data.current_boiler_type);
                console.log('Additional costs calculated');

                this.boilers = this.getBoilerOptions(scenario);
                console.log('Boiler options retrieved:', this.boilers.length, 'boilers');

                this.boilers.sort((a, b) => {
                    const warrantyA = parseInt(a.warranty) || 0;
                    const warrantyB = parseInt(b.warranty) || 0;
                    if (warrantyB !== warrantyA) return warrantyB - warrantyA;
                    return a.price - b.price;
                });

                this.updateQuoteSummary(recommendedType, data);
                console.log('Quote summary updated');

                // Always show cylinder options when system/regular boiler is recommended for compliance
                if (scenario.includes('system') || scenario.includes('regular')) {
                    this.toggleCylinderOptions(true);
                    this.updateCylinderRequirement(); // Force recalculation
                    this.addCylinderComplianceWarning(recommendedType, data); // Add warning directly without try-catch now
                }

                this.updateBoilerOptions();
                console.log('Boiler options updated, calculateQuote completed');
            } catch (error) {
                console.error('Error in calculateQuote:', error);
                // Still try to show default options or error message
                try {
                    this.hideLoading();
                    this.updateQuoteSummary('Error calculating quote', {});
                    this.updateBoilerOptions();
                } catch (fallbackError) {
                    console.error('Error in fallback:', fallbackError);
                }
            }
        }
        addCylinderComplianceWarning(recommendedType, data) {
            console.log('addCylinderComplianceWarning called with:', recommendedType);
            if (!/(System|Heat Only)/i.test(recommendedType)) {
                console.log('Not a system/regular recommendation, returning');
                return;
            } // Only for system/regular recommendations
            const container = document.getElementById('boiler-options');
            const warningDiv = document.createElement('div');
            warningDiv.className = 'quote-summary';
            warningDiv.innerHTML = `
                <div style="background: rgba(245, 158, 11, 0.1); border-left: 4px solid var(--warning-color); padding: 24px; margin-bottom: 20px; border-radius: var(--radius-md);">
                    <h3 style="color: var(--warning-color); margin-bottom: 16px;">⚠️ Important: Building Regulations Compliance</h3>
                    <p style="margin-bottom: 16px; font-size: 16px;">
                        Your recommended system requires a hot water cylinder per Building Regulations Part G.
                    </p>
                    <p style="margin-bottom: 16px;">Please confirm and update your cylinder preferences below:</p>
                    <div class="cylinder-options-inline" style="text-align: center;">
                        <label style="margin-right: 32px;">
                            <strong>Existing Cylinder:</strong>
                            <div style="margin-top: 8px;">
                                <input type="radio" name="existing_cylinder_update" value="yes" style="margin-right: 4px;" ${data.existing_cylinder === 'yes' ? 'checked' : ''}> Yes
                                <input type="radio" name="existing_cylinder_update" value="no" style="margin: 0 4px 0 16px;" ${data.existing_cylinder === 'no' ? 'checked' : ''}> No
                                <input type="radio" name="existing_cylinder_update" value="unsure" style="margin: 0 4px 0 16px;" ${data.existing_cylinder === 'unsure' ? 'checked' : ''}> Unsure
                            </div>
                        </label>
                        <label>
                            <strong>Need New Cylinder:</strong>
                            <div style="margin-top: 8px;">
                                <input type="radio" name="need_new_cylinder_update" value="yes" style="margin-right: 4px;" ${data.need_new_cylinder === 'yes' ? 'checked' : ''}> Yes, New/Upgrade
                                <input type="radio" name="need_new_cylinder_update" value="no" style="margin: 0 4px 0 16px;" ${data.need_new_cylinder === 'no' ? 'checked' : ''}> No, Use Existing
                                <input type="radio" name="need_new_cylinder_update" value="unsure" style="margin: 0 4px 0 16px;" ${data.need_new_cylinder === 'unsure' ? 'checked' : ''}> Unsure
                            </div>
                        </label>
                        <div style="margin-top: 16px;">
                            <label for="cylinder_size_update" style="font-weight: 600;">Cylinder Size:</label>
                            <select id="cylinder_size_update" name="cylinder_size_update" style="margin-left: 8px; padding: 8px; border-radius: 4px;">
                                <option value="" ${!data.cylinder_size ? 'selected' : ''}>Select Size</option>
                                <option value="150L" ${data.cylinder_size === '150L' ? 'selected' : ''}>150L (1-2 people, 1 bath)</option>
                                <option value="210L" ${data.cylinder_size === '210L' ? 'selected' : ''}>210L (3-4 people, 2 baths)</option>
                                <option value="250L" ${data.cylinder_size === '250L' ? 'selected' : ''}>250L (5+ people, 3+ baths)</option>
                            </select>
                        </div>
                        <p style="margin-top: 16px; font-size: 14px; color: var(--warning-color);">
                            <strong>Note:</strong> Unvented cylinders are G3 compliant with safety valves, expansion vessels, and ≤55°C flow temperatures. Existing installations adapted to match. Survey confirms all compliance.
                        </p>
                    </div>
                </div>
            `;
            // Insert the warning before the boiler options
            container.parentElement.insertBefore(warningDiv, container);
        }
        // NEW: Standards-aligned scenario/type selection and kW sizing
        determineBoilerScenario(data) {
            // Quick straight swap path: use same type and selected kW
            const quickSwap = (data.quick_swap === 'yes' || data.quick_swap === 'on');
            const currentTypeQuick = data.current_boiler_type || 'none';
            if (quickSwap && (currentTypeQuick === 'combi' || currentTypeQuick === 'system' || currentTypeQuick === 'regular')) {
                let kw = (data.quick_kw || '30');
                if (currentTypeQuick !== 'combi' && kw === '40') kw = '35';
                const scenarioPrefixQS = data.fuel_type === 'lpg' ? 'lpg_' : '';
                const scenarioQS = scenarioPrefixQS + currentTypeQuick + kw;
                const kwDisplayQS = { '24': '24, 25 and 26kW', '30': '29, 30, 31 and 32kW', '35': '33, 34 and 35kW', '40': '36, 37, 38, 39 and 40kW' };
                let recommendedTypeQS;
                if (currentTypeQuick === 'combi') {
                    recommendedTypeQS = `${kwDisplayQS[kw]} Combi Boiler (like-for-like)`;
                } else if (currentTypeQuick === 'system') {
                    recommendedTypeQS = `${kwDisplayQS[kw]} System Boiler (like-for-like)`;
                } else {
                    recommendedTypeQS = `${kwDisplayQS[kw]} Heat Only Boiler (like-for-like)`;
                }
                return { recommendedType: recommendedTypeQS, scenario: scenarioQS, mixedMode: false, systemMode: false };
            }
            const bathCount = this.getBathCount(data.bathrooms);
            const radCount = data.radiators === 'unsure' ? 2 : this.getRadCount(data.radiators);
            const bedCount = this.getBedCount(data.bedrooms);
            const occupantFactor = this.getOccupantFactor(data.occupants);
            const flowRate = (data.water_flow || 'unsure');
            const flow = (flowRate === 'unsure') ? 'medium' : flowRate;
            const currentType = data.current_boiler_type || 'none';
            let suggestedType;
            if (flow === 'low' || bathCount >= 2 || occupantFactor >= 3) {
                suggestedType = (currentType === 'regular' && bathCount >= 3) ? 'regular' : 'system';
            } else {
                suggestedType = 'combi';
            }
            let kw;
            if (suggestedType === 'combi') {
                kw = this.chooseCombiKw(bathCount, occupantFactor, bedCount, flow);
            } else {
                kw = this.chooseSystemKw(radCount, bedCount, occupantFactor);
            }
            if ((suggestedType === 'system' || suggestedType === 'regular') && parseInt(kw, 10) > 35) kw = '35';
            const scenarioPrefix = data.fuel_type === 'lpg' ? 'lpg_' : '';
            const scenario = scenarioPrefix + suggestedType + kw;
            const kwDisplay = { '24': '24, 25 and 26kW', '30': '29, 30, 31 and 32kW', '35': '33, 34 and 35kW', '40': '36, 37, 38, 39 and 40kW' };
            const systemMode = (suggestedType === 'system' || suggestedType === 'regular');
            const mixedMode = (currentType === 'regular' && bathCount <= 1.5 && occupantFactor <= 1);
            const cylinderInfo = (data.need_new_cylinder === 'yes' || (data.need_new_cylinder === 'unsure' && systemMode))
                ? ` with ${data.cylinder_size || 'recommended size'} Unvented Cylinder` : '';
            let recommendedType;
            if (suggestedType === 'combi') {
                recommendedType = `${kwDisplay[kw]} Combi Boiler (no cylinder needed)`;
            } else if (suggestedType === 'system') {
                recommendedType = `${kwDisplay[kw]} System Boiler${cylinderInfo}`;
            } else {
                recommendedType = `${kwDisplay[kw]} Heat Only Boiler${cylinderInfo}`;
            }
            return { recommendedType, scenario, mixedMode, systemMode };
        }
        // NEW: Combi sizing logic (DHW-first, avoid oversizing)
        chooseCombiKw(bathCount, occupantFactor, bedCount, flow) {
            if (bathCount <= 1) {
                if (occupantFactor <= 1) return (flow === 'low') ? '24' : '24';
                if (occupantFactor === 2) return (flow === 'low') ? '24' : '30';
                return (flow === 'high') ? '35' : '30';
            }
            if (bathCount <= 1.5) {
                if (occupantFactor <= 2) return '30';
                return (flow === 'high') ? '35' : '30';
            }
            return (flow === 'high') ? '35' : '30';
        }
        // NEW: System/regular CH sizing proxy (cap at 35kW)
        chooseSystemKw(radCount, bedCount, occupantFactor) {
            if (radCount === 1 && bedCount <= 2 && occupantFactor <= 2) return '24';
            if (radCount === 2 || bedCount === 3 || occupantFactor >= 3) return '30';
            return '35';
        }
        getCylinderSize(bathrooms, occupants) {
            const bathFactor = this.getBathCount(bathrooms);
            const occupantFactor = this.getOccupantFactor(occupants);
            const maxFactor = Math.max(bathFactor, occupantFactor);
            if (maxFactor <= 1.5) return '150L';
            else if (maxFactor <= 2) return '210L';
            else return '250L';
        }
        getBathCount(bathrooms) {
            switch (bathrooms) {
                case '1': return 1;
                case '1main1wc': return 1.5;
                case '2': return 2;
                case '3+': return 3;
                default: return 1;
            }
        }
        getOccupantFactor(occupants) {
            switch (occupants) {
                case '1-2': return 1;
                case '3-4': return 2;
                case '5+': return 3;
                default: return 1;
            }
        }
        getRadCount(radiators) {
            switch (radiators) {
                case 'less10': return 1;
                case '10-15': return 2;
                case 'more15': return 3;
                case 'unsure': return 2;
                default: return 2;
            }
        }
        getBedCount(bedrooms) {
            switch (bedrooms) {
                case '1': return 1;
                case '2': return 2;
                case '3': return 3;
                case '4+': return 4;
                default: return 2;
            }
        }
        calculateAdditionalCosts(data, scenario, currentType) {
            this.costs.flue = 0;
            this.costs.gasMeter = 0;
            this.costs.addons = 0;
            this.costs.radiator = 0;
            this.costs.cylinder = 0;
            this.costs.conversion = 0;
            this.costs.relocation = 0;
            this.costs.gasPipeUpgrade = 0;
            this.costs.capAdjustment = 0;
            const suggestedType = scenario.replace(/[0-9]+$/, '').replace('lpg_', '');
            if (currentType !== suggestedType && currentType !== 'none' && currentType !== 'back') {
            // Default conversion cost reduced from 1500 -> 1200; gas pipe upgrades added conditionally below
            this.costs.conversion = 1200;
            }
            if (currentType === 'back') {
                this.costs.conversion += 500;
            }
            // Relocation uplift if the boiler is being moved
            if (data.boiler_location === 'moved') {
                // Sharper for like-for-like swaps, higher for conversions
                const isSwap = (currentType === suggestedType) && currentType !== 'none' && currentType !== 'back';
                this.costs.relocation = isSwap ? 200 : 300;
            }
            const flueType = data.flue_type === 'unsure' ? 'horizontal' : data.flue_type;
            if (flueType === 'vertical') {
                this.costs.flue = 350 + (parseInt(data.flue_distance) || 0) * 60;
            } else if (flueType === 'horizontal') {
                this.costs.flue = 100 + (parseInt(data.flue_distance) || 0) * 50;
            }
            const meterDist = data.gas_meter_distance === 'unsure' ? 'same_wall' : data.gas_meter_distance;
            if (meterDist === 'adjacent_wall') this.costs.gasMeter = 100;
            if (meterDist === 'opposite_wall') this.costs.gasMeter = 200;
            if (data.need_new_cylinder === 'yes') {
                const size = data.cylinder_size || this.getCylinderSize(data.bathrooms, data.occupants);
                this.costs.cylinder = this.priceCalculator.cylinderPrices[size] || 800;
            } else if (data.need_new_cylinder === 'unsure') {
                this.costs.cylinder = 0;
            }
            const addons = new FormData(document.getElementById('boiler-form')).getAll('addons');
            if (addons.includes('radiators')) {
                const radType = data.radiator_size_type;
                const base = this.priceCalculator.radiatorPrices[radType] || 0;
                const labour = 100;
                const pipework = data.pipework_adjust === 'yes' ? 50 : 0;
                const count = parseInt(data.radiator_count) || 1;
                // Count radiator once (no double add into addons)
                this.costs.radiator = (base + labour + pipework) * count;
            }
            const gasPipe = data.gas_pipe_size === 'unsure' ? '22mm' : data.gas_pipe_size;
            const kw = scenario.match(/\d+$/)[0];
            if (gasPipe === '15mm' && (parseInt(kw) >= 30 || suggestedType === 'combi')) {
                // Scale upgrade by route complexity
                const isMoved = data.boiler_location === 'moved';
                const isOpposite = (typeof meterDist !== 'undefined') ? (meterDist === 'opposite_wall') : (data.gas_meter_distance === 'opposite_wall');
                this.costs.gasPipeUpgrade = (isMoved || isOpposite) ? 450 : 300;
            }
            // Extras cap for like-for-like swaps to stay competitive
            const isSwap = (currentType === suggestedType) && currentType !== 'none' && currentType !== 'back';
            if (isSwap) {
                const extras = (this.costs.flue + this.costs.gasMeter + this.costs.gasPipeUpgrade + this.costs.relocation);
                const cap = 900;
                if (extras > cap) {
                    this.costs.capAdjustment = -(extras - cap);
                }
            }
        }
        // Pricing adjustments and floors
        getBrandTier(modelLower) {
            if (!modelLower) return 'mid';
            const isWorcester = modelLower.includes('worcester');
            const isVaillant = modelLower.includes('vaillant');
            const isIdeal = modelLower.includes('ideal');
            const isViessmann = modelLower.includes('viessmann');
            if (
                (isWorcester && (modelLower.includes('8000') || modelLower.includes('style') || modelLower.includes('life')))
                || (isVaillant && (modelLower.includes('exclusive') || modelLower.includes('plus')))
                || (isIdeal && modelLower.includes('vogue'))
                || (isViessmann && modelLower.includes('200'))
            ) return 'premium';
            if (
                (isWorcester && (modelLower.includes('4000') || modelLower.includes('2000')))
                || (modelLower.includes('baxi') && (modelLower.includes('600') || modelLower.includes('800') || modelLower.includes('platinum') || modelLower.includes('duo-tec')))
                || (isIdeal && modelLower.includes('logic max'))
                || (isVaillant && modelLower.includes('ecofit'))
            ) return 'mid';
            return 'basic';
        }
        getAdjustedBasePrice(boiler) {
            const modelLower = (boiler.model || '').toLowerCase();
            const tier = this.getBrandTier(modelLower);
            const type = (boiler.type || '').toLowerCase();
            // Sharper uplifts on budget combis; retain general reductions elsewhere
            let uplift;
            if (type === 'combi') {
                uplift = (tier === 'premium') ? 450 : (tier === 'mid') ? 200 : 50;
            } else {
                uplift = (tier === 'premium') ? 500 : (tier === 'mid') ? 250 : 150;
            }
            const base = parseFloat(boiler.price || 0) || 0;
            return Math.round(base + uplift + ((type === 'system' || type === 'regular') ? 200 : 0));
        }
        // Keep installed price (ex-cylinder) within competitive caps
        getCompetitorCeiling(boiler, isSwap) {
            try {
                const type = (boiler.type || '').toLowerCase();
                const modelLower = (boiler.model || '').toLowerCase();
                const tier = this.getBrandTier(modelLower);
                const kw = parseInt(boiler._kw || (boiler.model || '').match(/(\d+)\s*kW/i)?.[1] || '30', 10);
                const band = (kw <= 25) ? 'b25' : (kw <= 30) ? 'b30' : (kw <= 36) ? 'b36' : 'b40';
                const convAllow = isSwap ? 0 : 1200; // allow for conversion complexity
                if (type === 'combi') {
                    const caps = {
                        basic:   { b25: 2395, b30: 2595, b36: 2795, b40: 2995 },
                        mid:     { b25: 2495, b30: 2695, b36: 2895, b40: 3095 },
                        premium: { b25: 2695, b30: 2895, b36: 3095, b40: 3295 }
                    };
                    const t = (tier === 'premium') ? 'premium' : (tier === 'mid') ? 'mid' : 'basic';
                    return (caps[t]?.[band] || 2795) + convAllow;
                }
                // System/Regular caps exclude cylinder; priced separately
                const baseCaps = (tier === 'premium') ? 2195 : (tier === 'mid') ? 1995 : 1895;
                return baseCaps + convAllow;
            } catch { return 2995; }
        }
        applyCompetitorCeiling(total, costsBreakdown, boiler, isSwap) {
            try {
                const cyl = Math.max(0, parseFloat(costsBreakdown?.cylinder || 0) || 0);
                const exCyl = Math.max(0, (parseFloat(total) || 0) - cyl);
                const cap = this.getCompetitorCeiling(boiler, !!isSwap);
                const cappedExCyl = Math.min(exCyl, cap);
                return Math.round(cappedExCyl + cyl);
            } catch { return Math.round(parseFloat(total) || 0); }
        }
        applyMinimumFloors(boiler, total) {
            try {
                const modelLower = (boiler.model || '').toLowerCase();
                const tier = this.getBrandTier(modelLower);
                const type = (boiler.type || '').toLowerCase();
                const kw = parseInt(boiler._kw || (boiler.model || '').match(/(\d+)\s*kW/i)?.[1] || '30', 10);
                let floor = 0;
                if (type === 'combi') {
                    if (kw <= 25) floor = 2399; else if (kw <= 30) floor = 2599; else if (kw <= 36) floor = 2799; else floor = 2999;
                    if (tier === 'premium') floor += 200;
                } else if (type === 'system') {
                    floor = (tier === 'premium') ? 2199 : 1999;
                } else if (type === 'regular') {
                    floor = (tier === 'premium') ? 2099 : 1899;
                }
                return Math.max(total, floor);
            } catch (_) { return total; }
        }
        getBoilerOptions(scenario) {
            const boilers = this.boilerDataManager.getBoilersForScenario(scenario);
            const kwMatch = scenario.match(/\d+$/);
            const _kw = kwMatch ? parseInt(kwMatch[0], 10) : null;
            let typeBoilers = boilers.map(b => ({ ...b, type: scenario.replace(/[0-9]+$/, '').replace('lpg_', ''), _kw }));
            if (this.mixedMode) {
                const alternativeScenario = scenario.replace('combi', 'regular');
                let altBoilers = this.boilerDataManager.getBoilersForScenario(alternativeScenario);
                altBoilers = altBoilers.map(b => ({ ...b, type: 'regular' }));
                typeBoilers = typeBoilers.concat(altBoilers);
            }
            if (this.systemMode) {
                const kw = scenario.match(/\d+$/)?.[0] || '30';
                const data = Object.fromEntries(new FormData(document.getElementById('boiler-form')));
                const combiKw = this.chooseCombiKw(
                    this.getBathCount(data.bathrooms),
                    this.getOccupantFactor(data.occupants),
                    this.getBedCount(data.bedrooms),
                    (data.water_flow || 'unsure')
                );
                const altScenario = scenario.includes('regular')
                    ? scenario.replace('regular' + kw, 'combi' + combiKw)
                    : scenario.replace('system' + kw, 'combi' + combiKw);
                let altBoilers = this.boilerDataManager.getBoilersForScenario(altScenario);
                altBoilers = altBoilers.map(b => ({ ...b, type: 'combi' }));
                typeBoilers = typeBoilers.concat(altBoilers);
            }
            return typeBoilers;
        }
        // NEW: Customer-friendly rationale summary
        updateQuoteSummary(recommendedType, data) {
            const summary = document.getElementById('quote-summary');
            const bathCount = this.getBathCount(data.bathrooms);
            const occ = this.getOccupantFactor(data.occupants);
            const radCount = (data.radiators === 'unsure') ? 2 : this.getRadCount(data.radiators);
            const beds = this.getBedCount(data.bedrooms);
            const rawFlow = data.water_flow || 'unsure';
            const flow = (rawFlow === 'unsure') ? 'medium' : rawFlow;
            const isCombi = /Combi Boiler/i.test(recommendedType);
            const isSystem = /System Boiler/i.test(recommendedType);
            const isRegular = /Heat Only Boiler/i.test(recommendedType);
            let chosenKw = '30';
            if (isCombi) {
                chosenKw = this.chooseCombiKw(bathCount, occ, beds, flow);
            } else {
                chosenKw = this.chooseSystemKw(radCount, beds, occ);
                if (parseInt(chosenKw, 10) > 35) chosenKw = '35';
            }
            const flowText = (f) => f === 'low' ? 'low' : f === 'high' ? 'high' : 'typical';
            const bathText = (() => {
                if (data.bathrooms === '1') return '1 bathroom';
                if (data.bathrooms === '1main1wc') return '1 bathroom + 1 WC';
                if (data.bathrooms === '2') return '2 bathrooms';
                return '3+ bathrooms';
            })();
            const occText = (() => {
                if (data.occupants === '1-2') return '1–2 people';
                if (data.occupants === '3-4') return '3–4 people';
                return '5+ people';
            })();
            const radsText = (() => {
                if (data.radiators === 'less10') return 'fewer than 10 radiators';
                if (data.radiators === '10-15') return '10–15 radiators';
                if (data.radiators === 'more15') return 'more than 15 radiators';
                return 'a typical number of radiators';
            })();
            const reasons = [];
            if (isCombi) {
                reasons.push(`You have ${bathText} and ${flowText(flow)} mains flow, so an instantaneous combi can meet hot water demand without a cylinder.`);
                if (occ <= 2) reasons.push('Household size is modest, so simultaneous hot water demand is limited.');
                if (flow === 'high') reasons.push('High mains flow supports faster hot water delivery from a combi.');
                if (flow === 'low') reasons.push('Flow rate appears low; a combi is sized conservatively and we’ll confirm performance on survey.');
            } else {
                if (bathCount >= 2) reasons.push('Two or more bathrooms benefit from stored hot water to serve multiple outlets at once.');
                if (flow === 'low') reasons.push('Low mains flow makes combi hot water less suitable; a cylinder ensures strong flow and comfort.');
                if (occ >= 3) reasons.push('Higher occupancy increases overlapping hot water demand, which a cylinder handles better.');
                if (isRegular) reasons.push('A heat-only (regular) boiler is appropriate where there are existing tanks or for a like‑for‑like replacement.');
                if (isSystem) reasons.push('A system boiler with an unvented cylinder gives strong hot water performance across taps and showers.');
            }
            if (isCombi) {
                const dhwPerformance = {
                    '24': 'about 9–10 l/min at a 35°C rise',
                    '30': 'about 12–13 l/min at a 35°C rise',
                    '35': 'about 14–15 l/min at a 35°C rise',
                    '40': 'about 15–16 l/min at a 35°C rise'
                }[chosenKw] || 'the right balance of hot water performance and efficiency';
                reasons.push(`Combi output: ${chosenKw}kW chosen to match expected hot water demand (${dhwPerformance}).`);
            } else {
                reasons.push(`Central heating output: ${chosenKw}kW selected using a proxy of ${radsText}, bedrooms and occupants. We’ll confirm final sizing with a room‑by‑room heat loss calculation (BS EN 12831) at survey.`);
            }
            if (isSystem || isRegular) {
                const cylinderNote = data.need_new_cylinder === 'yes'
                    ? `${data.cylinder_size || 'recommended size'} unvented cylinder included`
                    : (data.existing_cylinder === 'yes' ? 'existing cylinder retained if suitable' : 'cylinder requirement to be confirmed on survey');
                reasons.push(`Hot water storage: ${cylinderNote}. Sizing follows typical guidance of 35–45L per person and bathroom count.`);
            }
            reasons.push('All options meet Boiler Plus (92%+ ErP) and Part L efficiency guidance; we target ≤55°C flow where feasible for condensing efficiency.');
            reasons.push('Final specification is confirmed by a Gas Safe engineer during the free home survey.');

            // Clear existing content safely
            while (summary.firstChild) {
                summary.removeChild(summary.firstChild);
            }

            // Create DOM elements safely
            const container = document.createElement('div');
            container.style.cssText = 'text-align: center; margin-bottom: 24px;';

            const heading = document.createElement('h3');
            heading.style.cssText = 'color: var(--primary-color); margin-bottom: 16px; font-size: 24px;';
            heading.textContent = 'Your Tailored Gas Boiler Installation Quote for Lincoln, Scunthorpe, Doncaster and Grimsby';

            const para1 = document.createElement('p');
            para1.style.fontSize = '18px';
            para1.style.marginBottom = '8px';
            const strong = document.createElement('strong');
            strong.textContent = 'Recommended System: ';
            para1.appendChild(strong);
            para1.appendChild(document.createTextNode(recommendedType));

            const para2 = document.createElement('p');
            para2.style.cssText = 'color: var(--text-secondary); font-size: 14px;';
            para2.textContent = 'Based on your property details. Cylinder sizing follows typical usage guidance; heat loss checks per BS EN 12831 confirm the final outputs.';

            container.appendChild(heading);
            container.appendChild(para1);
            container.appendChild(para2);

            // Create reasons section
            const reasonsDiv = document.createElement('div');
            reasonsDiv.style.marginTop = '8px';

            const reasonsHeading = document.createElement('h4');
            reasonsHeading.style.cssText = 'text-align: center; margin: 8px 0 12px 0;';
            reasonsHeading.textContent = 'Why we recommended this:';
            reasonsDiv.appendChild(reasonsHeading);

            const list = document.createElement('ul');
            list.style.cssText = 'text-align: left; max-width: 900px; margin: 0 auto; line-height: 1.5;';
            reasons.forEach(reason => {
                const li = document.createElement('li');
                li.textContent = reason;
                list.appendChild(li);
            });
            reasonsDiv.appendChild(list);

            // Create footer section
            const footerDiv = document.createElement('div');
            footerDiv.style.cssText = 'text-align: center; margin-top: 16px;';

            const digest = document.createElement('p');
            digest.style.cssText = 'color: var(--success-color); font-weight: 600; margin-bottom: 8px;';
            digest.textContent = '✅ All-inclusive prices: Supply, Gas Safe installation, materials, certification, warranty.';

            const infoPara = document.createElement('p');
            infoPara.style.cssText = 'font-size: 14px; color: var(--text-secondary);';
            const cylinderText = [];
            if (data.existing_cylinder === 'yes') cylinderText.push('Existing kept');
            else if (data.need_new_cylinder === 'yes') {
                const size = String(data.cylinder_size).replace(/[^a-zA-Z0-9]/g, ''); // Sanitize input
                cylinderText.push(`${size} unvented (G3 compliant)`);
            } else if (isCombi) cylinderText.push('None (combi)');
            else cylinderText.push('To be confirmed on survey');
            infoPara.textContent = `Cylinder: ${cylinderText.join(', ')}. Select a boiler below for your total price.`;

            footerDiv.appendChild(digest);
            footerDiv.appendChild(infoPara);

            // Create finance paragraph
            const financePara = document.createElement('p');
            financePara.style.cssText = 'color: var(--primary-color); font-weight: 600; margin-top: 16px; text-align: center;';
            financePara.textContent = 'Finance available. ';
            const link = document.createElement('a');
            link.href = 'https://www.klarna.com/uk/';
            link.target = '_blank';
            link.style.color = 'var(--secondary-color)';
            link.textContent = 'Learn more';
            financePara.appendChild(link);

            // Append all sections
            summary.appendChild(container);
            summary.appendChild(reasonsDiv);
            summary.appendChild(footerDiv);
            summary.appendChild(financePara);
        }
        updateBoilerOptions() {
            const container = document.getElementById('boiler-options');
            const wrapper = container.querySelector('.swiper-wrapper');
            wrapper.innerHTML = '';
            if (this.swiperManager.swiperInstance) this.swiperManager.destroy();
            if (this.boilers.length === 0) {
                wrapper.innerHTML = `
                    <div class="swiper-slide" style="text-align: center; padding: 40px;">
                        <h3>No Standard Options Available</h3>
                        <p>Your requirements need custom configuration.</p>
                        <button onclick="window.location.href='mailto:info@nimbusheatpumps.co.uk?subject=Custom Boiler Quote Request'" style="margin: 10px; padding: 10px 20px; background: #00a676; color: white; border: none; border-radius: 6px;">
                            Email Us for Custom Quote
                        </button>
                        <button onclick="prevStep(14)" style="margin: 10px; padding: 10px 20px; background: #6f8ab7; color: white; border: none; border-radius: 6px;">
                            Adjust Requirements
                        </button>
                    </div>
                `;
                return;
            }
            // Base warranty terms
            // Nimbus standard: we always fit the required kit and register correctly.
            // Show these as the standard warranties.
            const warrantyTerms = {
              worcester: {
                'greenstar 1000': 5,
                'greenstar 2000': 7,
                'greenstar 4000': 10,
                'greenstar 8000': 12,
              },
              vaillant: {
                'ecotec pro': 7,
                'ecotec plus': 10,
                'ecofit pure': 10,
                'ecotec exclusive': 10,
              },
              baxi: {
                '200': 2,
                '400': 5,
                '600': 7,
                '800': 10,
                'platinum': 10,
                'duo-tec': 7,
              },
              main: {
                'eco compact': 5,
              },
              ideal: {
                'logic max': 10,
                'vogue max': 12,
              }
            };
            // Get current form data
            const formDataObj = new FormData(document.getElementById('boiler-form'));
            let currentData = Object.fromEntries(formDataObj);

            // Normalize update keys to original keys for compatibility
            if ('existing_cylinder_update' in currentData) currentData.existing_cylinder = currentData.existing_cylinder_update;
            if ('need_new_cylinder_update' in currentData) currentData.need_new_cylinder = currentData.need_new_cylinder_update;
            if ('cylinder_size_update' in currentData) currentData.cylinder_size = currentData.cylinder_size_update;

            function readMappedYears(map, bk, text) {
              if (!bk || !map[bk]) return null;
              for (const [needle, yrs] of Object.entries(map[bk])) {
                if (text.includes(needle)) return yrs;
              }
              return null;
            }
            const sortSelect = document.getElementById('boiler-sort');
            const sortMode = (sortSelect && sortSelect.value) || 'match';
            const brandSel = document.getElementById('filter-brand');
            const typeSel = document.getElementById('filter-type');
            const rangeSel = document.getElementById('filter-range');
            const lpgOnly = document.getElementById('filter-lpg');
            // Derive helper fields for sorting when needed
            const derived = this.boilers.map(b => {
                const modelLower = (b.model || '').toLowerCase();
                const brandKey =
                  modelLower.includes('worcester') ? 'worcester' :
                  modelLower.includes('vaillant')  ? 'vaillant'  :
                  modelLower.includes('baxi')      ? 'baxi'      :
                  modelLower.includes('main')      ? 'main'      :
                  modelLower.includes('ideal')     ? 'ideal'     : null;
                const mappedYears = readMappedYears(warrantyTerms, brandKey, modelLower) ?? (parseInt((b.warranty || '').match(/\d+/)?.[0] || '',10) || 0);
                const _adjPrice = this.getAdjustedBasePrice(b);
                const _kw = (()=>{ const m = (b.model||'').match(/(\d{2})\s*kW/i); return m ? parseInt(m[1],10) : null })();
                const _isLpg = /\blpg\b/i.test(b.model||'');
                return { ...b, _modelLower: modelLower, _brandKey: brandKey, _wYears: mappedYears, _adjPrice, _kw, _isLpg };
            });
            // Canonical whitelist per brand/family/type/kW (display only allowed outputs)
            const canon = {
              worcester: {
                combi: { 'greenstar 1000': [24,30], 'greenstar 2000': [25,30], 'greenstar 4000': [25,30], 'greenstar 8000': [30,35,40] },
                system:{ 'greenstar 4000': [12,15,18,24,30] },
                regular:{ 'greenstar ri': [12,15,18,24,30] }
              },
              vaillant: {
                combi:{ 'ecotec pro': [24,28,30], 'ecotec plus': [25,32,35,38], 'ecofit pure':[25,30,35] },
                system:{ 'ecotec plus':[12,18,30] },
                regular:{ 'ecofit pure':[12,18,30] }
              },
              ideal: {
                combi:{ 'logic max':[24,30,35], 'vogue max':[26,32,40] },
                system:{ 'logic max':[15,18,24,30] },
                regular:{ 'logic max':[12,15,18,24,30] }
              },
              baxi: {
                combi:{ '200':[24,28], '400':[24,30,36], '600':[24,30,36], '800':[25,30,36] },
                system:{ '400':[12,15,18,24,30], '600':[15,24], '800':[18,24,30] },
                regular:{ '400 heat':[12,18,24] }
              },
              main: {
                combi:{ 'eco compact':[25,30] },
                system:{ 'eco compact':[18,24,30] },
                regular:{ 'eco compact':[15,18,24] }
              }
            };
            const allowCanonical = (b) => {
              const brand = b._brandKey; if(!brand || !canon[brand]) return false;
              const type = (b.type||'').toLowerCase(); if(!canon[brand][type]) return false;
              const kw = b._kw||0; const ml = b._modelLower||'';
              const fams = Object.keys(canon[brand][type]);
              for(const f of fams){ if(ml.includes(f)){ return canon[brand][type][f].includes(kw); } }
              return false;
            };
            // Apply filters if present
            const wantBrand = (brandSel && brandSel.value) || 'all';
            const wantType = (typeSel && typeSel.value) || 'all';
            const wantRange = (rangeSel && rangeSel.value) || 'all';
            const wantLpgOnly = !!(lpgOnly && lpgOnly.checked);
            // Align combi range filters to match the UI labels
            // combi-24: 22–27, combi-30: 28–33, combi-35: 33–38, combi-40: 38–43
            const inCombiRange = (kw, tag) =>
              (tag==='combi-24' && kw>=22 && kw<=27) ||
              (tag==='combi-30' && kw>=28 && kw<=33) ||
              (tag==='combi-35' && kw>=33 && kw<=38) ||
              (tag==='combi-40' && kw>=38 && kw<=43);
            const inHeatRange = (kw, tag) => (tag==='heat-12' && kw>=10 && kw<=14) || (tag==='heat-15' && kw>=14 && kw<=17) || (tag==='heat-18' && kw>=17 && kw<=21) || (tag==='heat-24' && kw>=22 && kw<=27) || (tag==='heat-30' && kw>=28 && kw<=33);
            let filtered = derived.filter(b => allowCanonical(b)).filter(b => {
                if (wantBrand !== 'all' && b._brandKey !== wantBrand) return false;
                if (wantType !== 'all' && (b.type||'') !== wantType) return false;
                if (wantLpgOnly && !b._isLpg) return false;
                if (wantRange !== 'all'){
                  if (wantRange.startsWith('combi')){ if (!inCombiRange(b._kw||0, wantRange)) return false; }
                  else { if (!inHeatRange(b._kw||0, wantRange)) return false; }
                }
                return true;
            });
            let displayOrder;
            if (sortMode === 'price') {
                displayOrder = filtered.slice().sort((a,b) => (a._adjPrice||0) - (b._adjPrice||0));
            } else if (sortMode === 'warranty') {
                displayOrder = filtered.slice().sort((a,b) => (b._wYears||0) - (a._wYears||0) || (a._adjPrice||0) - (b._adjPrice||0));
            } else if (sortMode === 'brand') {
                displayOrder = filtered.slice().sort((a,b) => a._modelLower.localeCompare(b._modelLower));
            } else {
                // Best match: cheapest first, most expensive second, then the rest
                const sortedByPrice = filtered.slice().sort((a,b) => (a._adjPrice||0) - (b._adjPrice||0));
                const cheapest = sortedByPrice[0];
                const expensive = sortedByPrice[sortedByPrice.length - 1];
                const remaining = sortedByPrice.slice(1, -1);
                displayOrder = [cheapest, expensive, ...remaining];
            }
            let appended = 0;
            displayOrder.forEach((boiler, index) => {
                try {
                const currentType = currentData.current_boiler_type;
                let conversionCost = this.costs.conversion;
                let gasPipeUpgradeCost = this.costs.gasPipeUpgrade;
                let cylinderCost = (boiler.type !== 'combi' && currentData.need_new_cylinder !== 'no') ? this.costs.cylinder : 0;
                if (boiler.type === currentType) {
                    // Like-for-like should not include conversion cost,
                    // but keep any required gas pipe upgrade if needed
                    conversionCost = 0;
                }
                const basePrice = this.getAdjustedBasePrice(boiler);
                const totalPrice = this.priceCalculator.calculateTotal(basePrice, {
                    conversion: conversionCost,
                    relocation: this.costs.relocation,
                    flue: this.costs.flue,
                    gasMeter: this.costs.gasMeter,
                    gasPipeUpgrade: gasPipeUpgradeCost,
                    addons: this.costs.addons,
                    radiator: this.costs.radiator,
                    cylinder: cylinderCost,
                    capAdjustment: this.costs.capAdjustment
                });
                const isSwap = (boiler.type === currentType) && currentType !== 'none' && currentType !== 'back';
                const cappedTotal = this.applyCompetitorCeiling(totalPrice, { cylinder: cylinderCost }, boiler, isSwap);
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                const optionWrapper = document.createElement('div');
                optionWrapper.className = 'boiler-option-wrapper';
                const card = document.createElement('div');
                card.className = 'radio-card';
                card.setAttribute('tabindex', '0');
                card.setAttribute('role', 'radio');
                card.setAttribute('aria-checked', index === 0 ? 'true' : 'false');
                let badge = '';
                if (index === 0) {
                    badge = '<span class="badge" style="background: linear-gradient(135deg, var(--success-color), #0a8f6b); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-bottom: 12px; display: inline-block;">Best Value 💰</span>';
                } else if (index === 1) {
                    badge = '<span class="badge" style="background: linear-gradient(135deg, var(--secondary-color), #5a74a0); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-bottom: 12px; display: inline-block;">Premium Choice ⭐</span>';
                }
                let typeLabel = '';
                if (this.mixedMode) {
                    if (boiler.type === 'combi') {
                        typeLabel = '<p class="boiler-type-label" style="color: var(--success-color);">Combi Boiler (Recommended Upgrade)</p>';
                    } else if (boiler.type === 'regular') {
                        typeLabel = '<p class="boiler-type-label" style="color: var(--secondary-color);">Regular Boiler (Like-for-Like Replacement)</p>';
                    }
                }
                if (this.systemMode) {
                    if (boiler.type === 'system') {
                        typeLabel = '<p class="boiler-type-label" style="color: var(--success-color);">System Boiler (Recommended for hot water demand)</p>';
                    } else if (boiler.type === 'combi') {
                        typeLabel = '<p class="boiler-type-label" style="color: var(--secondary-color);">Combi Boiler (Alternative - no cylinder needed)</p>';
                    }
                }
                const imageHtml = '<span class="radio-icon">✅</span>';
                // Create input element safely
                const radioInput = document.createElement('input');
                radioInput.type = 'radio';
                radioInput.name = 'selected_boiler';
                radioInput.id = `boiler-${index}`;
                radioInput.value = boiler.model.toLowerCase().replace(/\s+/g, '-');
                radioInput.setAttribute('data-price', basePrice.toString());
                radioInput.setAttribute('data-type', (boiler.type||'').toString());
                if (boiler._kw) radioInput.setAttribute('data-kw', String(boiler._kw));
                if (index === 0) radioInput.checked = true;
                radioInput.setAttribute('aria-label', `Select ${boiler.model.replace(/[<>"'&]/g, '')}`); // Sanitize for aria-label

                // Create content div
                const boilerContent = document.createElement('div');
                boilerContent.className = 'boiler-content';
                boilerContent.style.cssText = 'flex-direction: column; text-align: center; width: 100%; align-items: center;';

                // Create badge if needed
                if (badge) {
                    const badgeDiv = document.createElement('div');
                    badgeDiv.innerHTML = badge; // Safe since it's controlled markup
                    boilerContent.appendChild(badgeDiv.firstElementChild);
                }

                // Create type label if applicable
                if (typeLabel) {
                    const typeLabelDiv = document.createElement('div');
                    typeLabelDiv.innerHTML = typeLabel; // Safe since it's controlled markup
                    boilerContent.appendChild(typeLabelDiv.firstElementChild);
                }

                // Create icon div
                const iconDiv = document.createElement('div');
                iconDiv.innerHTML = imageHtml; // Safe since it's a span
                boilerContent.appendChild(iconDiv.firstElementChild);

                // Create title
                const title = document.createElement('h4');
                title.className = 'boiler-title';
                title.style.cssText = 'font-size: 20px; font-weight: 700; margin-bottom: 8px;';
                title.textContent = boiler.model.replace(/[<>"'&]/g, ''); // Sanitize user input

                const modelLower = boiler.model.toLowerCase();
                const brandKey =
                  modelLower.includes('worcester') ? 'worcester' :
                  modelLower.includes('vaillant')  ? 'vaillant'  :
                  modelLower.includes('baxi')      ? 'baxi'      :
                  modelLower.includes('main')      ? 'main'      :
                  modelLower.includes('ideal')     ? 'ideal'     : null;

                const mappedYears = readMappedYears(warrantyTerms, brandKey, modelLower);

                // Always display the mapped maximum as our standard.
                // If a row is missing in the map, fall back to any numeric literal in the data.
                const dataYears = parseInt((boiler.warranty || '').match(/\d+/)?.[0] || '', 10) || null;
                const displayYears = mappedYears ?? dataYears ?? null;

                const warrantyText = displayYears ? `${displayYears} Years` : 'Manufacturer warranty';

                const warrantyP = document.createElement('p');
                warrantyP.className = 'warranty-info';
                warrantyP.style.cssText = 'font-style: italic; margin-bottom: 16px;';
                warrantyP.innerHTML = `<strong>Warranty:</strong> ${warrantyText}`;

                // Create price section
                const priceSection = document.createElement('div');
                priceSection.className = 'price-section';
                priceSection.style.justifyContent = 'center';

                const priceDisplay = document.createElement('div');
                priceDisplay.className = 'price-display';

                const totalPriceSpan = document.createElement('span');
                totalPriceSpan.className = 'total-price';
                totalPriceSpan.style.fontSize = '28px';
                totalPriceSpan.textContent = this.formatPrice(cappedTotal);

                const priceLabel = document.createElement('span');
                priceLabel.className = 'price-label';
                priceLabel.textContent = 'Fully Installed';

                priceDisplay.appendChild(totalPriceSpan);
                priceDisplay.appendChild(priceLabel);
                priceSection.appendChild(priceDisplay);

                boilerContent.appendChild(title);
                boilerContent.appendChild(warrantyP);
                boilerContent.appendChild(priceSection);

                card.appendChild(radioInput);
                card.appendChild(boilerContent);
                optionWrapper.appendChild(card);
                const link = document.createElement('a');
                link.href = boiler.url;
                link.target = '_blank';
                link.className = 'manufacturer-link';
                link.textContent = 'View Details';
                link.setAttribute('aria-label', `View details for ${boiler.model} on manufacturer website`);
                optionWrapper.appendChild(link);
                slide.appendChild(optionWrapper);
                wrapper.appendChild(slide);
                appended++;
                } catch (e) {
                    try { console && console.warn && console.warn('Skipped boiler option due to error:', boiler?.model, e); } catch {}
                }
            });
            try { container.setAttribute('data-total-options', String(displayOrder.length)); container.setAttribute('data-appended-options', String(appended)); } catch {}
            // Re-render on sort/filter change
            try {
                const s = document.getElementById('boiler-sort');
                if (s && !s._boundUpdate) { s.addEventListener('change', () => this.updateBoilerOptions()); s._boundUpdate = true; }
                const fb = document.getElementById('filter-brand');
                if (fb && !fb._boundUpdate) { fb.addEventListener('change', () => this.updateBoilerOptions()); fb._boundUpdate = true; }
                const ft = document.getElementById('filter-type');
                if (ft && !ft._boundUpdate) { ft.addEventListener('change', () => this.updateBoilerOptions()); ft._boundUpdate = true; }
                const fr = document.getElementById('filter-range');
                if (fr && !fr._boundUpdate) { fr.addEventListener('change', () => this.updateBoilerOptions()); fr._boundUpdate = true; }
                const fl = document.getElementById('filter-lpg');
                if (fl && !fl._boundUpdate) { fl.addEventListener('change', () => this.updateBoilerOptions()); fl._boundUpdate = true; }
            } catch {}
            // View toggle controls
            try {
                const btnCards = document.getElementById('view-cards');
                const btnCompare = document.getElementById('view-compare');
                const compareWrap = document.getElementById('boiler-compare');
                const optionsWrap = document.getElementById('boiler-options');
                if (btnCards && btnCompare && !btnCards._bound) {
                    const setPressed = (el, pressed) => { el.setAttribute('aria-pressed', pressed ? 'true' : 'false'); };
                    btnCards.addEventListener('click', () => {
                        optionsWrap.style.display = '';
                        compareWrap.style.display = 'none';
                        setPressed(btnCards, true); setPressed(btnCompare, false);
                    });
                    btnCompare.addEventListener('click', () => {
                        this.updateCompareTable(displayOrder, currentData);
                        optionsWrap.style.display = 'none';
                        compareWrap.style.display = '';
                        setPressed(btnCards, false); setPressed(btnCompare, true);
                    });
                    btnCards._bound = btnCompare._bound = true;
                }
            } catch {}

            // Failsafe: if not all options appended (an item threw), render a static grid of ALL options
            if (appended < displayOrder.length) {
                try {
                    // Destroy any swiper instance and rebuild as static grid
                    this.swiperManager && this.swiperManager.destroy && this.swiperManager.destroy();
                    container.innerHTML = '';
                    this.swiperManager && this.swiperManager.fallbackToStaticDisplay && this.swiperManager.fallbackToStaticDisplay(container);

                    displayOrder.forEach((boiler) => {
                        try {
                            const currentType = currentData.current_boiler_type;
                            let conversionCost = this.costs.conversion;
                            let gasPipeUpgradeCost = this.costs.gasPipeUpgrade;
                            let cylinderCost = (boiler.type !== 'combi' && currentData.need_new_cylinder !== 'no') ? this.costs.cylinder : 0;
                            if (boiler.type === currentType) {
                                // Like-for-like should not include conversion cost,
                                // but keep any required gas pipe upgrade if needed
                                conversionCost = 0;
                            }
                            const basePrice = this.getAdjustedBasePrice(boiler);
                            const totalPrice = this.priceCalculator.calculateTotal(basePrice, {
                                conversion: conversionCost,
                                relocation: this.costs.relocation,
                                flue: this.costs.flue,
                                gasMeter: this.costs.gasMeter,
                                gasPipeUpgrade: gasPipeUpgradeCost,
                                addons: this.costs.addons,
                                radiator: this.costs.radiator,
                                cylinder: cylinderCost,
                                capAdjustment: this.costs.capAdjustment
                            });
                            const isSwap = (boiler.type === currentType) && currentType !== 'none' && currentType !== 'back';
                            const cappedTotal = this.applyCompetitorCeiling(totalPrice, { cylinder: cylinderCost }, boiler, isSwap);
                            const optionWrapper = document.createElement('div');
                            optionWrapper.className = 'boiler-option-wrapper';
                            const card = document.createElement('div');
                            card.className = 'radio-card';
                            const radioInput = document.createElement('input');
                            radioInput.type = 'radio';
                            radioInput.name = 'selected_boiler';
                            radioInput.value = boiler.model.toLowerCase().replace(/\s+/g, '-');
                            radioInput.setAttribute('data-price', basePrice.toString());
                            radioInput.setAttribute('data-type', (boiler.type||'').toString());
                            if (boiler._kw) radioInput.setAttribute('data-kw', String(boiler._kw));
                            const boilerContent = document.createElement('div');
                            boilerContent.className = 'boiler-content';
                            boilerContent.style.cssText = 'flex-direction: column; text-align: center; width: 100%; align-items: center;';
                            const title = document.createElement('h4');
                            title.className = 'boiler-title';
                            title.textContent = boiler.model.replace(/[<>"'&]/g, '');
                            const warrantyP = document.createElement('p');
                            warrantyP.className = 'warranty-info';
                            warrantyP.style.cssText = 'font-style: italic; margin-bottom: 16px;';
                            warrantyP.innerHTML = `<strong>Warranty:</strong> ${boiler.warranty || 'Manufacturer warranty'}`;
                            const priceSection = document.createElement('div');
                            priceSection.className = 'price-section';
                            const priceDisplay = document.createElement('div');
                            priceDisplay.className = 'price-display';
                            const totalPriceSpan = document.createElement('span');
                            totalPriceSpan.className = 'total-price';
                            totalPriceSpan.textContent = this.formatPrice(cappedTotal);
                            const priceLabel = document.createElement('span');
                            priceLabel.className = 'price-label';
                            priceLabel.textContent = 'Fully Installed';
                            priceDisplay.appendChild(totalPriceSpan);
                            priceDisplay.appendChild(priceLabel);
                            priceSection.appendChild(priceDisplay);
                            card.appendChild(radioInput);
                            boilerContent.appendChild(title);
                            boilerContent.appendChild(warrantyP);
                            boilerContent.appendChild(priceSection);
                            card.appendChild(boilerContent);
                            optionWrapper.appendChild(card);
                            const link = document.createElement('a');
                            link.href = boiler.url;
                            link.target = '_blank';
                            link.className = 'manufacturer-link';
                            link.textContent = 'View Details';
                            link.setAttribute('aria-label', `View details for ${boiler.model} on manufacturer website`);
                            optionWrapper.appendChild(link);
                            container.appendChild(optionWrapper);
                        } catch (e) {
                            try { console && console.warn && console.warn('Static fallback skip:', boiler?.model, e); } catch {}
                        }
                    });
                    container.setAttribute('data-fallback', 'grid');
                } catch {}
            }
            container.classList.remove('swiper-fallback');
            if (!container.querySelector('.swiper-button-next')) {
                container.appendChild(Object.assign(document.createElement('div'), { className: 'swiper-button-next' }));
            }
            if (!container.querySelector('.swiper-button-prev')) {
                container.appendChild(Object.assign(document.createElement('div'), { className: 'swiper-button-prev' }));
            }
            const nextEl = container.querySelector('.swiper-button-next');
            const prevEl = container.querySelector('.swiper-button-prev');
            setTimeout(() => {
                try {
                    this.swiperManager.init(container, {
                        slidesPerView: 2,
                        slidesPerGroup: 1,
                        slidesPerGroupSkip: 0,
                        spaceBetween: 24,
                        centeredSlides: false,
                        grabCursor: true,
                        allowTouchMove: true,
                        watchOverflow: false,
                        navigation: { nextEl, prevEl },
                        breakpoints: {
                            0:    { slidesPerView: 1, slidesPerGroup: 1, spaceBetween: 16, centeredSlides: false, allowTouchMove: true },
                            768:  { slidesPerView: 2, slidesPerGroup: 1, spaceBetween: 24, centeredSlides: false, allowTouchMove: true },
                            1024: { slidesPerView: 3, slidesPerGroup: 1, spaceBetween: 24, centeredSlides: false, allowTouchMove: true }
                        }
                    });
                    if (this.swiperManager.swiperInstance) {
                        this.swiperManager.swiperInstance.update();
                        this.swiperManager.swiperInstance.navigation?.update && this.swiperManager.swiperInstance.navigation.update();
                    }
                } catch {
                    this.swiperManager.fallbackToStaticDisplay(container);
                }
            }, 0);
            const radioCards = container.querySelectorAll('.radio-card');
            const radioInputs = container.querySelectorAll('input[name="selected_boiler"]');
            const updateAriaChecked = () => {
                radioCards.forEach(card => {
                    const radio = card.querySelector('input[type="radio"]');
                    card.setAttribute('aria-checked', radio && radio.checked ? 'true' : 'false');
                });
                const pay = document.getElementById('pay-button');
                if (pay) pay.disabled = !container.querySelector('input[name="selected_boiler"]:checked');
            };
            radioCards.forEach(card => {
                card.addEventListener('click', function () {
                    const radio = this.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        radioCards.forEach(c => c.classList.remove('selected'));
                        this.classList.add('selected');
                        updateAriaChecked();
                    }
                });
                card.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const radio = this.querySelector('input[type="radio"]');
                        if (radio) {
                            radio.checked = true;
                            radioCards.forEach(c => c.classList.remove('selected'));
                            this.classList.add('selected');
                            updateAriaChecked();
                        }
                    }
                });
            });
            radioInputs.forEach(radio => {
                radio.addEventListener('change', () => {
                    radioCards.forEach(c => c.classList.remove('selected'));
                    const selectedCard = radio.closest('.radio-card');
                    if (selectedCard) selectedCard.classList.add('selected');
                    updateAriaChecked();
                });
            });
            updateAriaChecked();
            nextEl?.addEventListener('click', e => { e.preventDefault(); container.swiper?.slideNext(); }, { passive: true });
            prevEl?.addEventListener('click', e => { e.preventDefault(); container.swiper?.slidePrev(); }, { passive: true });
        }
        async processPayment() {
            if (!this.validator.validateStep(this.currentStep)) return;
            const selectedBoiler = document.querySelector('input[name="selected_boiler"]:checked');
            if (!selectedBoiler) { this.showError('error-step15'); return; }
            const formData = new FormData(document.getElementById('boiler-form'));
            const data = Object.fromEntries(formData);
            const selectedBoilerInput = selectedBoiler;
            data.selected_boiler = selectedBoilerInput ? selectedBoilerInput.value : 'Not selected';
            const boilerPrice = selectedBoilerInput ? parseInt(selectedBoilerInput.dataset.price) || 0 : 0;
            // Align payment amount with the displayed card logic (like-for-like conversions and combi cylinder handling)
            const currentType = (data.current_boiler_type || '').toString();
            const selectedType = (selectedBoilerInput?.dataset?.type || '').toString();
            let conversionCost = this.costs.conversion;
            if (selectedType && currentType && selectedType === currentType) {
                conversionCost = 0; // like-for-like: no conversion charge
            }
            // Only include cylinder cost for non-combi selections and if a new cylinder is needed/unsure
            const needCylinder = (data.need_new_cylinder || 'no');
            let cylinderCost = (selectedType !== 'combi' && needCylinder !== 'no') ? this.costs.cylinder : 0;
            const gasPipeUpgradeCost = this.costs.gasPipeUpgrade;
            const addl = {
                conversion: conversionCost,
                relocation: this.costs.relocation,
                flue: this.costs.flue,
                gasMeter: this.costs.gasMeter,
                gasPipeUpgrade: gasPipeUpgradeCost,
                addons: this.costs.addons,
                radiator: this.costs.radiator,
                cylinder: cylinderCost,
                capAdjustment: this.costs.capAdjustment,
            };
            let total = this.priceCalculator.calculateTotal(boilerPrice, addl);
            // Competitor ceiling: cap ex-cylinder portion
            try {
                const kw = parseInt(selectedBoilerInput?.dataset?.kw || ((selectedBoilerInput?.value || '').match(/(\d+)/)?.[1] || '30'), 10);
                const modelLower = (selectedBoilerInput?.value || '').replace(/-/g, ' ');
                const pseudoBoiler = { model: modelLower, type: selectedType, _kw: kw };
                const isSwap = (selectedType === currentType) && currentType !== 'none' && currentType !== 'back';
                total = this.applyCompetitorCeiling(total, { cylinder: cylinderCost }, pseudoBoiler, isSwap);
            } catch {}
            // Match the visually displayed price rounding so the payment page shows the same amount
            data.total_price = this.normalizeAmountForDisplay(total);
            const params = {
                'name-1': encodeURIComponent(data.name || ''),
                'email-1': encodeURIComponent(data.email || ''),
                'phone-1': encodeURIComponent(data.phone || ''),
                'address-1-zip': encodeURIComponent(data.postcode || ''),
                'textarea-1': encodeURIComponent(data.selected_boiler || ''),
                'currency-1': encodeURIComponent(data.total_price.toString())
            };
            try {
                const paymentData = {
                    name: data.name,
                    email: data.email,
                    phone: data.phone,
                    postcode: data.postcode,
                    boiler: data.selected_boiler,
                    totalPrice: data.total_price
                };
                sessionStorage.setItem('boilerQuoteData', JSON.stringify(paymentData));
                this.storage.setItem('boilerQuoteData', paymentData);
            } catch {}
            const queryString = Object.keys(params).map(key => `${encodeURIComponent(key)}=${params[key]}`).join('&');

            // Before redirecting to the payment URL:
            this.skipUnload = true;
            // Optional: hard stop any pending prompts
            window.removeEventListener('beforeunload', this.beforeUnloadHandler);

            try {
                const response = await fetch('/secure-boiler-payment-page/', { method: 'HEAD' });
                if (response.ok) window.location.href = '/secure-boiler-payment-page/?' + queryString;
                else throw new Error('Payment page not available');
            } catch {
                this.showPaymentError();
            }
        }
        showPaymentError() {
            const errorHtml = `
                <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: var(--radius-lg); border: 2px solid var(--error-color);">
                    <div style="font-size: 48px; margin-bottom: 16px;">❌</div>
                    <h3 style="color: var(--error-color); margin-bottom: 16px;">Payment Page Unavailable</h3>
                    <p style="margin-bottom: 16px;">Please contact us at <a href="mailto:info@nimbusheatpumps.co.uk" style="color: var(--error-color);">info@nimbusheatpumps.co.uk</a> or call 07487 546550 to complete your payment.</p>
                </div>
            `;
            document.getElementById('quote-summary').innerHTML = errorHtml;
        }
        async handleSubmit(e) {
            e.preventDefault();
            if (!navigator.onLine) { alert('No internet connection. Please check your connection and try again.'); return; }
            if (typeof emailjs === 'undefined') { alert('Email service is not ready. Please refresh the page and try again.'); return; }
            if (!this.validator.validateStep(this.currentStep)) return;
            this.showLoading();
            try {
                const formData = new FormData(document.getElementById('boiler-form'));
                const data = Object.fromEntries(formData);
                const selectedBoilerInput = document.querySelector('input[name="selected_boiler"]:checked');
                data.selected_boiler = selectedBoilerInput ? selectedBoilerInput.value : 'Not selected';
                const boilerPrice = selectedBoilerInput ? parseInt(selectedBoilerInput.dataset.price) || 0 : 0;
                let totalRaw = this.priceCalculator.calculateTotal(boilerPrice, this.costs);
                try {
                    const selectedType = (selectedBoilerInput?.dataset?.type || '').toString();
                    const currentType = (data.current_boiler_type || '').toString();
                    const kw = parseInt(selectedBoilerInput?.dataset?.kw || ((selectedBoilerInput?.value || '').match(/(\d+)/)?.[1] || '30'), 10);
                    const modelLower = (selectedBoilerInput?.value || '').replace(/-/g, ' ');
                    const pseudoBoiler = { model: modelLower, type: selectedType, _kw: kw };
                    const isSwap = (selectedType === currentType) && currentType !== 'none' && currentType !== 'back';
                    totalRaw = this.applyCompetitorCeiling(totalRaw, { cylinder: this.costs.cylinder }, pseudoBoiler, isSwap);
                } catch {}
                data.total_price = this.formatPrice(totalRaw);
                const summaryText = document.querySelector('#quote-summary')?.textContent || '';
                const match = summaryText.match(/Recommended System:\s*([^.]+)/);
                data.recommended_type = match ? match[1].trim() : 'Not specified';
                const addons = formData.getAll('addons');
                data.addons = addons.length > 0 ? addons.join(', ') : 'None';
                data.radiator_size_type = data.radiator_size_type || 'N/A';
                data.radiator_count = data.radiator_count || 'N/A';
                data.pipework_adjust = data.pipework_adjust || 'N/A';
                await this.emailjs.sendEmail(data);
                this.hideLoading();
                this.showSuccessMessage();
                this.storage.setItem('formCompleted', true);
                this.storage.removeItem('boilerFormData');
                this.storage.removeItem('currentStep');
            } catch (error) {
                this.hideLoading();
                this.showErrorMessage(error);
            }
        }
        showSuccessMessage() {
            const message = `
                <div style="text-align: center; padding: 40px; background: linear-gradient(135deg, rgba(0, 166, 118, 0.1), rgba(0, 166, 118, 0.2)); border-radius: var(--radius-lg); border: 2px solid var(--primary-color);">
                    <div style="font-size: 48px; margin-bottom: 16px;">✅</div>
                    <h3 style="color: var(--primary-color); margin-bottom: 16px;">Quote Request Submitted Successfully!</h3>
                    <p style="margin-bottom: 16px; font-size: 18px;">Thank you for choosing Nimbus Heat Pumps Ltd for your gas boiler installation.</p>

                    <div style="background: rgba(255,255,255,0.8); padding: 20px; border-radius: var(--radius-md); margin: 20px 0; font-size: 14px; line-height: 1.6;">
                        <h4 style="margin: 0 0 16px 0; color: var(--primary-color);">What happens next?</h4>
                        <p style="margin-bottom: 8px;"><strong>Within 24 hours:</strong> Our heating specialist will contact you to discuss your quote and answer any questions.</p>
                        <p style="margin-bottom: 8px;"><strong>Site Survey:</strong> We'll arrange a free home survey to confirm measurements, inspect your current system and discuss installation details (no obligation).</p>
                        <p style="margin-bottom: 8px;"><strong>Quotation:</strong> We'll provide a detailed quotation including material costs, labour, Building Control fees and any additional work required.</p>
                        <p style="margin-bottom: 8px;"><strong>Installation:</strong> Once accepted, we'll schedule your Gas Safe registered installation to suit your availability.</p>
                        <p style="margin-bottom: 0;"><strong>Warranty:</strong> All work comes with comprehensive warranties on materials and installation.</p>
                    </div>

                    <div style="margin-top: 20px; font-size: 14px; color: var(--text-secondary);">
                        <p style="margin-bottom: 8px;"><strong>Service Areas:</strong> Lincoln, Scunthorpe, Doncaster and Grimsby with priority service in Scunthorpe and North Lincolnshire.</p>
                        <p style="margin-bottom: 8px;"><strong>Finance Available:</strong> Flexible payment options available. Please contact us for details.</p>
                        <p>Need urgent help? Call us directly on 07487 546550.</p>
                    </div>
                </div>
            `;
            document.getElementById('quote-summary').innerHTML = message;
            document.getElementById('pay-button').style.display = 'none';
            document.querySelector('button[type="submit"]').style.display = 'none';
        }
        showErrorMessage(error) {
            let errorMessage = 'Unknown error occurred';
            if (error?.text) errorMessage = error.text;
            else if (error?.message) errorMessage = error.message;
            else if (error?.status) errorMessage = `Error status: ${error.status}`;
            const errorHtml = `
                <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: var(--radius-lg); border: 2px solid var(--error-color);">
                    <div style="font-size: 48px; margin-bottom: 16px;">❌</div>
                    <h3 style="color: var(--error-color); margin-bottom: 16px;">Submission Failed</h3>
                    <p style="margin-bottom: 16px;">Error: ${errorMessage}</p>
                    <p>Please try again or contact us directly at <a href="mailto:info@nimbusheatpumps.co.uk" style="color: var(--error-color);">info@nimbusheatpumps.co.uk</a> or call 07487 546550.</p>
                    <p style="font-size: 12px; color: var(--text-secondary); margin-top: 16px;">If this persists, try refreshing the page or using a different browser.</p>
                </div>
            `;
            document.getElementById('quote-summary').innerHTML = errorHtml;
        }
        autoSave() {
            const formData = new FormData(document.getElementById('boiler-form'));
            this.formData = Object.fromEntries(formData);
            this.storage.setItem('boilerFormData', this.formData);
            this.storage.setItem('currentStep', this.currentStep);
        }
        loadFormData() {
            const savedData = this.storage.getItem('boilerFormData');
            const savedStep = this.storage.getItem('currentStep');
            const formCompleted = this.storage.getItem('formCompleted');
            if (formCompleted) {
                this.storage.removeItem('boilerFormData');
                this.storage.removeItem('currentStep');
                this.storage.removeItem('formCompleted');
                this.navigateToStep(1);
                return;
            }
            if (savedData) {
                const form = document.getElementById('boiler-form');
                for (let key in savedData) {
                    const elements = form.querySelectorAll(`[name="${key}"]`);
                    elements.forEach(el => {
                        if (el.type === 'radio' || el.type === 'checkbox') {
                            el.checked = el.value === savedData[key];
                            if (el.checked && el.closest('.radio-card')) {
                                el.closest('.radio-card').classList.add('selected');
                            }
                        } else {
                            el.value = savedData[key];
                        }
                    });
                }
                if (savedStep) {
                    const stepNum = parseInt(savedStep);
                    if (stepNum >= 15) {
                        // On reload at the final stage: re-calculate and show results, not the spinner
                        try { this.calculateQuote(); } catch {}
                        this.navigateToStep(15);
                    } else if (stepNum > 1) {
                        // Offer choice to resume or restart; default view stays at step 1 until user decides
                        this.navigateToStep(1);
                        this.showResumeBanner(stepNum);
                    } else {
                        this.navigateToStep(1);
                    }
                } else {
                    this.navigateToStep(1);
                }
            }
        }
    }
    let formManager;
    function initForm() { formManager = new ImprovedBoilerQuoteForm(); }
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initForm);
    else initForm();
    function nextStep(step) { formManager.nextStep(step); }
    function prevStep(step) { formManager.prevStep(step); }
    function processPayment() { formManager.processPayment(); }
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelector('#quote-form-container')?.classList.add('loaded');
        // Share/Email/Restart controls
        const restart = document.getElementById('restart-quote-link');
        if (restart) restart.addEventListener('click', (e) => { e.preventDefault(); try { formManager.resetToStart(); } catch {} });
        const share = document.getElementById('share-progress');
        const email = document.getElementById('email-progress');
        function buildResumeLink() {
            try {
                const form = document.getElementById('boiler-form');
                if (!form) return location.href;
                const data = Object.fromEntries(new FormData(form));
                const snapshot = { step: formManager.currentStep || 1, data };
                const b64 = btoa(unescape(encodeURIComponent(JSON.stringify(snapshot))));
                const base = location.origin + location.pathname;
                return `${base}#resume=${encodeURIComponent(b64)}`;
            } catch { return location.href; }
        }
        function copyToClipboard(text) {
            const status = document.getElementById('share-status');
            try { navigator.clipboard.writeText(text).then(() => { if(status) status.textContent='Link copied'; setTimeout(()=>{ if(status) status.textContent=''; }, 2000); }); }
            catch { const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); if(status) status.textContent='Link copied'; setTimeout(()=>{ if(status) status.textContent=''; }, 2000); }
        }
        if (share && !share._bound) { share.addEventListener('click', (e)=>{ e.preventDefault(); copyToClipboard(buildResumeLink()); }); share._bound=true; }
        if (email && !email._bound) { email.addEventListener('click', (e)=>{ e.preventDefault(); const link=buildResumeLink(); const subj=encodeURIComponent('Nimbus Boiler Quote - Resume Link'); const body=encodeURIComponent(`Use this link to return to your quote:\n\n${link}`); location.href=`mailto:?subject=${subj}&body=${body}`; }); email._bound=true; }
        // Hash resume support (cross-device)
        try {
            const hash = location.hash || '';
            const m = hash.match(/#resume=([^&]+)/);
            if (m) {
                const json = JSON.parse(decodeURIComponent(escape(atob(decodeURIComponent(m[1])))));
                if (json && json.data) {
                    localStorage.setItem('boilerFormData', JSON.stringify(json.data));
                    if (json.step) localStorage.setItem('currentStep', String(json.step));
                    formManager.loadFormData();
                }
            }
            // If URL was loaded with #bqf-fullpaste, keep position but remove hash from the address bar
            if (location.hash === '#bqf-fullpaste' && history.replaceState) {
                setTimeout(() => { try { history.replaceState(null, document.title, location.pathname + location.search); } catch {} }, 50);
            }
        } catch {}

        // Intercept clicks to #bqf-fullpaste and smooth-scroll without adding the hash to URL
        document.addEventListener('click', (e) => {
            const a = e.target.closest && e.target.closest('a[href="#bqf-fullpaste"]');
            if (a) {
                e.preventDefault();
                const el = document.getElementById('bqf-fullpaste');
                if (el && el.scrollIntoView) {
                    try { el.scrollIntoView({ behavior: 'smooth', block: 'start' }); } catch { el.scrollIntoView(true); }
                }
                if (history.replaceState) {
                    try { history.replaceState(null, document.title, location.pathname + location.search); } catch {}
                }
            }
        }, true);
    });
    const liveRegion = document.createElement('div');
    liveRegion.setAttribute('aria-live', 'polite');
    liveRegion.setAttribute('aria-atomic', 'true');
    liveRegion.className = 'sr-only';
    liveRegion.style.position = 'absolute';
    liveRegion.style.left = '-10000px';
    liveRegion.style.width = '1px';
    liveRegion.style.height = '1px';
    liveRegion.style.overflow = 'hidden';
    document.body.appendChild(liveRegion);
    const observer = new MutationObserver(() => {
        const activeStep = document.querySelector('.form-step.active h2');
        if (activeStep) liveRegion.textContent = `Now on ${activeStep.textContent}`;
    });
    observer.observe(document.getElementById('quote-form-container'), { childList: true, subtree: true, attributes: true, attributeFilter: ['class'] });

</script>
<!-- END: BoilerQuoteForm FULL RAW PASTE --></section><div class="site-chrome"><style>
/* ================= Shared banner styles ================= */
.install-banner {
  background: var(--off-white);
  border: 2px solid var(--primary-green);
  border-radius: var(--radius-md);
  padding: 24px 28px 20px;
  margin: 24px 0;
  box-shadow: var(--shadow-soft);
  display: flex;
  flex-direction: column;
  gap: 18px;
  align-items: center;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.install-banner:hover {
  border-color: var(--dark-green);
  box-shadow: 0 12px 28px rgba(0, 122, 87, 0.18);
  transform: translateY(-3px) scale(1.01);
}

.banner-wrapper {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  gap: 20px;
}

/* Center the label content and let it match the scroller width on mobile */
.banner-label {
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  gap: 10px;
  padding: 12px 22px;
  border-radius: var(--radius-md);
  border: 2px solid var(--primary-green);
  background: rgba(255, 255, 255, 0.92);
  color: var(--dark-green);
  font-weight: 600;
  letter-spacing: -0.01em;
  box-shadow: 0 2px 8px rgba(0, 166, 118, 0.12);
  margin: 0;
}
.banner-label::before {
  content: '✓';
  color: var(--primary-green);
  font-weight: 700;
  font-size: 15px;
}

.banner-scroller {
  position: relative;
  overflow: hidden;
  flex: 1 1 320px;
  max-width: 100%;
}

.banner-track {
  display: flex;
  width: max-content;
  gap: 0;                          /* 0 gap so -50% aligns with the seam */
  animation: banner-scroll 36s linear infinite;
  will-change: transform;
}
.banner-track:hover { animation-play-state: paused; }

/* Start items immediately at the left; seam spacing only at the end */
.banner-items {
  display: flex;
  align-items: center;
  justify-content: flex-start;     /* no centring -> no initial empty space */
  gap: 20px;
  flex-shrink: 0;
  min-width: auto;                 /* let group be content width */
  padding-inline-start: 0;         /* first pill starts right away */
  padding-inline-end: 20px;        /* seam spacing between duplicate groups */
}

/* Stable pill sizing */
.banner-item {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  border-radius: var(--radius-md);
  border: 2px solid var(--primary-green);
  background: rgba(255, 255, 255, 0.9);
  box-shadow: 0 2px 8px rgba(0, 166, 118, 0.12);
  font-weight: 600;
  color: var(--dark-green);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  white-space: nowrap;
  flex: 0 0 auto;                  /* never shrink the pills */
  box-sizing: border-box;          /* stabilise width calc */
}
.banner-item::before {
  content: '✓';
  color: var(--primary-green);
  font-weight: 700;
}
.banner-item:hover {
  transform: translateY(-3px) scale(1.02);
  box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2);
}

.banner-footnote {
  margin: 0;
  font-size: 14px;
  color: var(--dark-green);
  text-align: center;
  padding: 12px 20px;
  border: 2px solid var(--primary-green);
  border-radius: var(--radius-md);
  background: rgba(255, 255, 255, 0.92);
  box-shadow: 0 2px 8px rgba(0, 166, 118, 0.12);
  font-weight: 600;
}

/* Seamless horizontal loop on desktop (two identical groups) */
@keyframes banner-scroll {
  0%   { transform: translateX(0); }
  100% { transform: translateX(-50%); } /* move exactly one group's width */
}

/* ===== Mobile (≤ 768px): vertical + auto-scroll up, centred, same width as label ===== */
@media (max-width: 768px) {
  .install-banner {
    padding: 20px 18px 16px;
    margin: 16px 0;
  }

  .banner-wrapper {
    flex-direction: column;
    gap: 14px;
  }

  /* Make label and scroller the same width within the padded container */
  .banner-label,
  .banner-scroller {
    width: 100%;
    max-width: 520px;              /* optional cap; adjust if you want narrower */
    margin: 0 auto;
  }

  .banner-scroller {
    height: 220px;                 /* visible area for the vertical loop */
    overflow: hidden;              /* hide the marquee overflow */
    -webkit-overflow-scrolling: touch;
    border-radius: var(--radius-md);
  }

  /* Build a vertical track with BOTH groups for seamless loop */
  .banner-track {
    width: 100%;
    display: flex;
    flex-direction: column;
    animation: banner-scroll-y 18s linear infinite;  /* <-- auto-scroll on mobile */
    will-change: transform;
  }

  /* Do NOT hide the duplicate group on mobile (it’s needed for the loop) */
  .banner-items[aria-hidden="true"] {
    display: flex !important;
  }

  .banner-items {
    display: flex !important;
    flex-direction: column;
    align-items: stretch;          /* each pill fills the track width */
    gap: 12px;
    padding: 10px 0;
    min-width: auto;
  }

  .banner-item {
    width: 100%;                   /* pills same width as label/scroller */
    min-height: 52px;
    justify-content: center;       /* <-- center icon + text */
    text-align: center;            /* fallback centring */
    white-space: normal;           /* allow wrapping so width stays uniform */
    font-size: 13px;
    padding: 12px 16px;
  }

  .banner-footnote {
    font-size: 13px;
  }
}

/* Vertical loop: move up by exactly one group's height (50% of two stacked groups) */
@keyframes banner-scroll-y {
  0%   { transform: translateY(0); }
  100% { transform: translateY(-50%); }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .banner-track { animation: none !important; }
}
</style><style>
/* Allow wrapping of very long CTA labels on mobile */
@media (max-width: 768px) {
  .cta-button--nowrap { white-space: normal !important; }
}
/* Consistent small action buttons at results header */
.view-controls { display:flex; align-items:center; justify-content:center; gap:10px; flex-wrap: wrap; }
#view-cards, #view-compare, #restart-quote-link, #share-progress, #email-progress {
  display: inline-flex; align-items: center; justify-content: center;
  padding: 10px 12px; border-radius: 10px; border: 2px solid var(--primary-green);
  background: #fff; color: var(--dark-green); font-weight: 600; font-size: 14px; line-height: 1.15; box-sizing: border-box;
}
#view-cards[aria-pressed="true"], #view-compare[aria-pressed="true"] { background: rgba(0,166,118,0.08); }
.sort-controls { display:flex; align-items:center; justify-content:center; gap:10px; flex-wrap: wrap; }
.sort-controls select { font-size: 14px; }
/* Tablet: keep buttons in two columns with equal widths */
@media (min-width: 481px) and (max-width: 768px) {
  #view-cards, #view-compare, #restart-quote-link, #share-progress, #email-progress { font-size: 13px; padding: 10px 12px; min-height: 40px; flex: 1 1 calc(50% - 10px); }
  .sort-controls select { font-size: 13px; }
}
/* Mobile: full-width stacked buttons and controls */
@media (max-width: 480px) {
  .view-controls { flex-direction: column; align-items: stretch; }
  #view-cards, #view-compare, #restart-quote-link, #share-progress, #email-progress { width: 100%; font-size: 13px; padding: 10px 12px; min-height: 40px; }
  .sort-controls { flex-direction: column; align-items: stretch; }
  .sort-controls select { width: 100%; font-size: 13px; }
  .mobile-swipe-hint { display:block !important; }
}
</style><!-- Main Content --><main>
<!-- Hero Section -->
<!-- Instant Quote Highlight -->
<!-- Moved instant-quote-highlight above quote form -->
<!-- How the Instant Quote Works -->
<!-- Moved instant-quote-how above quote form -->
<!-- What You'll Need moved above quote form -->
<!-- Gas Boiler Efficiency Section (New) -->
<section class="gas-boiler-efficient-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading" id="boiler-installation-scunthorpe">Boiler Installation &amp; Replacement in Scunthorpe | Combi Boiler Swaps</h2>
<p class="section-text section-text--intro">Looking for a new boiler in Scunthorpe? Our Gas Safe engineers specialise in <strong>boiler installation</strong>, <strong>boiler replacement</strong> and <strong>combi boiler swaps</strong> across Scunthorpe, Grimsby, Doncaster and Lincoln. We fit high‑efficiency condensing boilers sized for your home to improve comfort and reduce energy use.</p>
<p class="section-text section-text--intro">From like‑for‑like replacements to <strong>system‑to‑combi conversions</strong>, we handle pipework, flues and controls so your upgrade is smooth and compliant.</p>
<ul class="section-list">
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Up to 30% less energy used with gas boiler replacements in Scunthorpe</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Cut CO<sub>2</sub> emissions with efficient gas heating systems in North Lincolnshire</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Save up to £500 annually on heating costs with gas boiler repairs in Scunthorpe, Grimsby, Doncaster, Lincoln (savings vary depending on property and usage)</li>
</ul>
<div class="section-cta-group">
<a class="cta-button" href="#bqf-fullpaste">Get Your Gas Boiler Quote in Scunthorpe</a>
</div>
</div>
</section>
<style>@media(max-width:1024px){.gas-boiler-efficient-section{padding:80px 32px}} @media(max-width:768px){.gas-boiler-efficient-section{padding:40px 20px}.gas-boiler-efficient-section h2{font-size:24px}.gas-boiler-efficient-section p{font-size:15px}.gas-boiler-efficient-section ul li{font-size:15px}.gas-boiler-efficient-section a{width:100%;max-width:300px;margin:0 auto;font-size:13px;padding:10px 20px;min-height:38px}}</style>
<!-- Boiler Cost Section -->
<section class="boiler-cost-section section nimbus-section-base">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading" id="boiler-cost">New Boiler Cost in Scunthorpe - What Affects Price?</h2>
    <p class="section-text section-text--intro">Every home is different. Your <strong>boiler installation cost</strong> in Scunthorpe depends on the property and the work required. Key factors include:</p>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Boiler type: <strong>combi, system or regular</strong> and required output (kW).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg><strong>Boiler swap</strong> (like‑for‑like) vs <strong>conversion</strong> (e.g. system to combi).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Flue position, plume management and <strong>condensate routing</strong>.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Gas supply sizing (many modern boilers require <strong>22mm</strong> supply).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>System cleans and protection: <strong>powerflush</strong>, <strong>magnetic filter</strong>, <strong>limescale protection</strong>.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Controls: smart thermostats and <strong>TRVs</strong> for better efficiency.</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">See Your Boiler Price Online</a>
      <a class="cta-button" href="#combi-vs-system">Compare Boiler Options</a>
    </div>
  </div>
  <style>@media(max-width:768px){.boiler-cost-section{padding:40px 20px}.boiler-cost-section h2{font-size:24px}.boiler-cost-section ul li{font-size:15px}}</style>
</section>

<!-- Boilers on Finance -->
<section class="boiler-finance section nimbus-section-base">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading" id="boiler-finance">Boilers on Finance in Scunthorpe</h2>
    <p class="section-text section-text--intro">Finance is available - please contact us for details or select the finance option when requesting your instant boiler quote.</p>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Applies to <strong>new boiler installations</strong> and replacements.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Simple application - ask us for details.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>No rates advertised here - details provided on request.</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Get a Boiler Quote &amp; Register Interest</a>
    </div>
  </div>
  <style>@media(max-width:768px){.boiler-finance{padding:40px 20px}.boiler-finance h2{font-size:24px}.boiler-finance ul li{font-size:15px}}</style>
</section>

<!-- Combi vs System vs Regular -->
<section class="boiler-types section nimbus-section-base">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading" id="combi-vs-system">Combi vs System vs Regular — Which Boiler Suits Your Home?</h2>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg><strong>Combi boilers</strong>: Space‑saving and efficient; deliver hot water on demand without a cylinder. Best for homes with one main bathroom and good mains pressure. Flow rate determines multi‑tap performance.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg><strong>System boilers</strong>: Work with a hot water cylinder (vented or unvented) to deliver strong hot water to multiple bathrooms. We pressurise (seal) the heating circuit; cylinders can be vented with a loft tank or upgraded to unvented, subject to survey and design.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg><strong>Regular (heat‑only)</strong>: We pressurise all heating systems; regular runs a sealed heating circuit and can work with either a vented (loft tank) or unvented cylinder, subject to survey/design. Common on older layouts; suitable for like‑for‑like or conversion.</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Find the Right Boiler Type</a>
    </div>
  </div>
  <style>.boiler-types .section-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px;text-align:left} @media(max-width:768px){.boiler-types{padding:40px 20px}.boiler-types h2{font-size:24px}.boiler-types ul li{font-size:15px}}</style>
</section>

<!-- Boiler Swap vs Conversion -->
<section class="boiler-swap-conversion section nimbus-section-base">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading" id="boiler-swap">Boiler Swap vs Full Conversion</h2>
    <div class="from-prices" style="display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin:8px 0 4px;">
      <span class="from-badge" style="display:inline-flex; align-items:center; gap:8px; background: rgba(0,166,118,0.08); color:#065f46; border:1px solid rgba(0,166,118,0.25); padding:6px 10px; border-radius:999px; font-weight:600;">
        <span>Combi swap from</span>
        <span id="from-price-swap">…</span>
      </span>
      <span class="from-badge" style="display:inline-flex; align-items:center; gap:8px; background: rgba(99,102,241,0.08); color:#3730a3; border:1px solid rgba(99,102,241,0.25); padding:6px 10px; border-radius:999px; font-weight:600;">
        <span>System → Combi from</span>
        <span id="from-price-conversion">…</span>
      </span>
    </div>
    <p class="section-text section-text--intro">We carry out quick, neat <strong>boiler swaps</strong> (like-for-like replacements) and full <strong>system-to-combi conversions</strong> with all necessary pipework, flue and controls upgrades.</p>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg><strong>Combi swap</strong>: typically 1-2 days depending on cleanliness of the system and any protection or flush required.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg><strong>System change</strong>: up to 5 days depending on what exactly needs to be done (cylinder work, pipe rerouting, flue and controls).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right: 10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Manufacturer‑backed warranties available on leading boiler brands.</li>
    </ul>
  </div>
  <style>@media(max-width:768px){.boiler-swap-conversion{padding:40px 20px}.boiler-swap-conversion h2{font-size:24px}.boiler-swap-conversion ul li{font-size:15px}}</style>
</section>

<!-- Back Boiler Replacement -->
<section class="back-boiler-replacement section nimbus-section-base">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading" id="back-boiler">Back Boiler Replacement in Scunthorpe</h2>
    <p class="section-text section-text--intro">Replace old back boilers safely with a modern <strong>combi</strong> or <strong>system</strong> boiler. We decommission legacy units, cap redundant pipework and fit efficient, compliant alternatives with smart controls.</p>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Check Your Back Boiler Options</a>
    </div>
  </div>
  <style>@media(max-width:768px){.back-boiler-replacement{padding:40px 20px}.back-boiler-replacement h2{font-size:24px}}</style>
</section>
<!-- Installation Process -->
<section class="boiler-process section nimbus-section-base" aria-label="Boiler installation process">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">Our Boiler Installation Process</h2>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Instant online quote or quick call to discuss your needs.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Engineer survey (virtual or in‑person) to confirm sizing and requirements.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Installation by Gas Safe engineer with tidy workmanship and compliance checks.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Commissioning, controls setup, user guidance and aftercare.</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Start with an Instant Quote</a>
    </div>
  </div>
  <style>@media(max-width:768px){.boiler-process{padding:40px 20px}.boiler-process h2{font-size:24px}.boiler-process ul li{font-size:15px}}</style>
</section>

<!-- What's Included -->
<section class="boiler-included section nimbus-section-base" aria-label="What’s included in a boiler installation">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">What’s Included with a Typical Boiler Installation</h2>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>New high‑efficiency condensing boiler and standard horizontal/vertical flue (as specified).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Condensate connection, safety controls and compliant commissioning.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Chemical clean or powerflush where required, plus inhibitor dose.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Magnetic filter and scale protection (if specified in quote).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Controls setup (e.g. smart thermostat) and documentation/registration.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Removal of old boiler and tidy, safe disposal.</li>
    </ul>
    <p class="section-text section-text--small">Exact scope confirmed in your quote based on survey and manufacturer requirements.</p>
  </div>
  <style>@media(max-width:768px){.boiler-included{padding:40px 20px}.boiler-included h2{font-size:24px}.boiler-included ul li{font-size:15px}}</style>
</section>

<!-- Installation Standards & Compliance -->
<section class="boiler-standards section nimbus-section-base" aria-label="Boiler installation standards and compliance">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">Installation Standards &amp; Compliance</h2>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>All work completed by Gas Safe registered engineers.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Building Regulations notification provided after installation.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Benchmark commissioning and documentation completed.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Carbon monoxide alarm fitted where required by regulations.</li>
    </ul>
  </div>
  <style>@media(max-width:768px){.boiler-standards{padding:40px 20px}.boiler-standards h2{font-size:24px}.boiler-standards ul li{font-size:15px}}</style>
</section>


<!-- Warranty & Aftercare -->
<section class="boiler-warranty section nimbus-section-base" aria-label="Boiler warranty and aftercare">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">Warranty &amp; Aftercare</h2>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Manufacturer warranties available (length varies by brand and model).</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>We register your product (where applicable) and notify Gas Safe.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Annual servicing available to maintain performance and warranty conditions.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Responsive repairs and support if you ever need help.</li>
    </ul>
    <div class="section-cta-group">
      <a class="cta-button" href="#bqf-fullpaste">Get a Boiler Quote &amp; Aftercare Info</a>
    </div>
  </div>
  <style>@media(max-width:768px){.boiler-warranty{padding:40px 20px}.boiler-warranty h2{font-size:24px}.boiler-warranty ul li{font-size:15px}}</style>
</section>
<!-- Potential Extras & Survey Checks -->
<section class="boiler-extras section nimbus-section-base" aria-label="Potential extras and survey checks">
  <div style="max-width: 1400px; margin: 0 auto;">
    <h2 class="section-heading">Potential Extras &amp; Survey Checks</h2>
    <p class="section-text section-text--intro">Your guide price covers a typical like-for-like installation. Depending on your property, our survey may recommend additional works for safety and compliance:</p>
    <ul class="section-list">
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Flue extensions, elbows, plume management or terminal guards.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Roof work or scaffolding for vertical flues.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Condensate rerouting and freeze-protection measures.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Gas supply route changes or upsizing to 22mm where required.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Electrical spur, controls wiring or thermostat upgrades.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Relocation of the boiler or cylinder; additional pipework.</li>
      <li><svg fill="none" height="24" style="vertical-align:middle; margin-right:10px;" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"/><path d="M6 12.5L10 16.5L18 7.5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg>Asbestos or hazardous materials are not handled; we'll advise next steps if discovered.</li>
    </ul>
  </div>
  <style>@media(max-width:768px){.boiler-extras{padding:40px 20px}.boiler-extras h2{font-size:24px}.boiler-extras ul li{font-size:15px}}</style>
</section>
<!-- Areas We Cover Section -->
<section class="areas-we-cover-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading">Areas We Cover: Boiler Installation &amp; Replacement Across DN and LN Postcodes</h2>
<p class="section-text section-text--intro">Based in Scunthorpe, North Lincolnshire, Nimbus Boilers &amp; Heat Pumps serves all DN and LN postcodes with specialist <strong>boiler installation</strong>, <strong>boiler replacement</strong> and heating upgrades focused on efficiency and reliability. Searching for <em>boiler installers near me</em>? We cover Scunthorpe, Grimsby, Doncaster, Lincoln and surrounding towns.</p>
<ul class="section-list">
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Scunthorpe and North Lincolnshire (DN15-DN17, DN20): Brigg, Barton-upon-Humber, surrounding towns.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Doncaster and nearby South Yorkshire areas (DN1-DN12, DN22): Doncaster, nearby areas.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Grimsby and NE Lincolnshire (DN31-DN41): Grimsby, Cleethorpes, Goole, surrounding areas.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Lincoln and Lincolnshire (LN1-LN13): Lincoln, Market Rasen, Horncastle, Woodhall Spa, Louth, rural areas.</li>
</ul>
</div>
</section>
<style>@media(max-width:1024px){.areas-we-cover-section{padding:80px 32px}} @media(max-width:768px){.areas-we-cover-section{padding:40px 20px}.areas-we-cover-section h2{font-size:24px}.areas-we-cover-section p{font-size:15px}.areas-we-cover-section ul li{font-size:15px}}</style>

<!-- Why Choose Section -->
<section class="why-choose-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading">Why Choose Nimbus for Boiler Installation &amp; Replacement in Scunthorpe</h2>
<ul class="section-list section-list--flush">
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Accredited installer for Ideal, Baxi and Worcester Bosch.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Gas Safe registered <strong>boiler installers</strong> for safe, compliant installs and replacements.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Local Scunthorpe installers with clear, transparent quotes and tidy workmanship.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Flexible boiler finance available — contact us for details.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Install leading boiler brands: Worcester Bosch, Vaillant, Ideal, Viessmann, Baxi.</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Manufacturer‑backed warranties and aftercare for peace of mind.</li>
</ul>
</div>
</section>
<style>@media(max-width:1024px){.why-choose-section{padding:80px 32px}} @media(max-width:768px){.why-choose-section{padding:40px 20px}.why-choose-section h2{font-size:24px}.why-choose-section ul li{font-size:15px}}</style>
<!-- Manufacturers Section -->
<!-- Manufacturers moved below FAQs -->
<style>
    .manufacturers-section div[style*="padding: 20px; border: 1px solid #A8D5BA"]:hover {
        transform: translateY(-2px) scale(1.01) !important;
        box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2) !important;
        border-color: var(--dark-green) !important;
        background-color: var(--off-white) !important;
    }
    .manufacturers-section img:hover {
        transform: none;
    }
    @media (max-width: 1024px) {
        .manufacturers-section {
            padding: 80px 32px;
        }
    }
    @media (max-width: 768px) {
        .manufacturers-section {
            padding: 40px 20px;
        }
        .manufacturers-section h2 {
            font-size: 24px;
        }
        .manufacturers-section div[style*="padding: 20px; border: 1px solid #A8D5BA"] {
            gap: 20px;
        }
        .manufacturers-section a img {
            max-width: 120px; max-height: 80px;
        }
    }
  </style>
  <style>
    /* Consistent card visuals and logo sizing across trust badges and manufacturers */
    .logo-card {
      padding: 20px;
      border: 1px solid #A8D5BA;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      background-color: var(--off-white) !important;
      min-height: 190px !important; /* increase container height for readability */
      width: 220px; /* unify card width to avoid uneven sizing */
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .logo-card:hover {
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2);
      border-color: var(--dark-green) !important;
      background-color: var(--off-white) !important;
    }
    .logo-card img {
      height: 60px !important;
      width: auto !important;
      max-width: 150px !important;
      object-fit: contain;
      display: block;
      background: var(--off-white) !important;
    }
    @media (max-width: 768px) {
      .logo-card { min-height: 150px !important; width: 170px; }
      .logo-card img { height: 48px !important; width: auto !important; max-width: 140px !important; }
    }
    /* Ensure no scale on hover for manufacturers card wrappers with inline style selector */
    .manufacturers-section .logo-card:hover,
    .trust-badges .logo-card:hover {
      transform: translateY(-2px) scale(1.01) !important;
      box-shadow: 0 6px 20px rgba(0, 166, 118, 0.2) !important;
      background-color: var(--off-white) !important;
      border-color: var(--dark-green) !important;
    }
    /* Ensure anchor/img backgrounds never flash white */
    .manufacturers-section .logo-card a,
    .manufacturers-section .logo-card a img,
    .trust-badges .logo-card a,
    .trust-badges .logo-card a img,
    .trust-badges .logo-card img {
      background-color: var(--off-white) !important;
    }
    /* Improve Gas Safe readability inside trust badges */
    .trust-badges img[alt*="Gas Safe"] {
      height: 90px !important; /* improve readability */
      max-width: 200px !important;
    }
    @media (max-width: 768px) {
      .trust-badges img[alt*="Gas Safe"] {
        height: 60px !important;
        max-width: 160px !important;
      }
    }
  </style>
  <!-- Testimonials Section -->
<section class="testimonials-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading section-heading--spaced">What Our Customers Say</h2>
<div class="testimonials-carousel-wrapper">
<div class="testimonials-carousel">
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Brilliant bloke. Always explains everything. Tries to save us money, genuine and caring. Definitely looks after us. Would highly recommend. Top service." - Sharon Rhodes, Scunthorpe (Facebook Post Comment)</p>
</div>
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Thanks Brian for your help, it was amazing how you sorted all out while we were away. I love that you polish the copper pipes when you finish. Jaja" - Manuel (Google Review)</p>
</div>
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Can't thank Brian enough he really goes above and beyond. Would recommend everytime ." - Audrey Lal (Google Review)</p>
</div>
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Excellent service with work carried out would defo use again" - Dean Bonner (Google Review)</p>
</div>
<!-- Duplicate for infinite loop: duplicate the full set -->
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Brilliant bloke. Always explains everything. Tries to save us money, genuine and caring. Definitely looks after us. Would highly recommend. Top service." - Sharon Rhodes (Facebook Post Comment)</p>
</div>
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Thanks Brian for your help, it was amazing how you sorted all out while we were away. I love that you polish the copper pipes when you finish. Jaja" - Manuel (Google Review)</p>
</div>
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Can't thank Brian enough he really goes above and beyond. Would recommend everytime ." - Audrey Lal (Google Review)</p>
</div>
<div class="testimonial-card">
<div class="testimonial-stars">★★★★★</div>
<p style="white-space: normal;">"Excellent service with work carried out would defo use again" - Dean Bonner (Google Review)</p>
</div>
</div>
</div>
<div class="section-cta-group section-cta-group--spaced" style="margin-top: 10px;">
<a class="cta-button cta-button--nowrap" href="https://share.google/yk7F28G9VpVstANKx" rel="noopener noreferrer" target="_blank" aria-label="Read all Nimbus Boilers & Heat Pumps reviews on Google">Read all Google reviews</a>
</div>
</div>
</section>
<style>@media(max-width:1024px){.testimonials-section{padding:80px 32px}.testimonials-carousel{gap:15px}} @media(max-width:768px){.testimonials-section{padding:40px 20px}.testimonials-section h2{font-size:24px}.testimonials-carousel{animation-duration:30s;gap:10px}.testimonial-card{flex:0 0 250px}} .testimonials-carousel-wrapper{overflow: hidden;position: relative;} .testimonials-carousel{display: flex;gap: 20px;animation: carousel 20s linear infinite;} .testimonial-card p{white-space: normal;word-break: break-word;} .testimonial-stars{color:#f59e0b;font-size:18px;line-height:1;margin-bottom:8px} @keyframes carousel {0% { transform: translateX(0); } 100% { transform: translateX(-50%); }}</style>
<!-- FAQs Section -->
<section class="faqs-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading section-heading--spaced">Frequently Asked Questions</h2>
<div class="faq-accordion">
<div class="faq-item">
<h3 aria-controls="faq-answer-1" aria-expanded="false" class="faq-question" id="faq-question-1" role="button" tabindex="0">How much can I save with a new gas boiler?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-1" class="faq-answer" id="faq-answer-1" role="region">Actual savings vary by property size, insulation, controls and the system being replaced. Modern condensing boilers are typically more efficient than older non‑condensing models, but results depend on usage and design.</div>
</div>
<div class="faq-item">
<h3 aria-controls="faq-answer-2" aria-expanded="false" class="faq-question" id="faq-question-2" role="button" tabindex="0">How long does a boiler installation take?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-2" class="faq-answer" id="faq-answer-2" role="region">Combi swaps typically take 1-2 days depending on cleanliness of the system and any protection or flush required. System changes can take up to 5 days depending on what exactly needs to be done.</div>
</div>
<div class="faq-item">
<h3 aria-controls="faq-answer-4" aria-expanded="false" class="faq-question" id="faq-question-4" role="button" tabindex="0">Can you replace my boiler next day?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-4" class="faq-answer" id="faq-answer-4" role="region">Often, yes. We frequently offer next‑day <strong>boiler replacement</strong> in Scunthorpe, subject to engineer schedule and parts availability. Contact us to check dates.</div>
</div>
<div class="faq-item">
<h3 aria-controls="faq-answer-5" aria-expanded="false" class="faq-question" id="faq-question-5" role="button" tabindex="0">What boiler brands do you install?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-5" class="faq-answer" id="faq-answer-5" role="region">We install leading brands including Worcester Bosch, Vaillant, Ideal, Viessmann and Baxi, with manufacturer‑backed warranties.</div>
</div>
<div class="faq-item">
<h3 aria-controls="faq-answer-6" aria-expanded="false" class="faq-question" id="faq-question-6" role="button" tabindex="0">Do you service and repair boilers?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-6" class="faq-answer" id="faq-answer-6" role="region">Yes. We provide annual servicing, safety checks and <strong>boiler repairs</strong> to keep your system efficient and safe. Emergency appointments are often available.</div>
</div>
<div class="faq-item">
<h3 aria-controls="faq-answer-3b" aria-expanded="false" class="faq-question" id="faq-question-3b" role="button" tabindex="0">Will you register my boiler warranty and Gas Safe notification?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-3b" class="faq-answer" id="faq-answer-3b" role="region">Yes. We complete product registration (where applicable) and issue the required Gas Safe Building Regulations notification following installation.</div>
</div>

<!-- Additional SEO-friendly, helpful FAQs -->
<div class="faq-item">
<h3 aria-controls="faq-answer-7" aria-expanded="false" class="faq-question" id="faq-question-7" role="button" tabindex="0">What size boiler do I need for a 3‑bed home?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-7" class="faq-answer" id="faq-answer-7" role="region">Boiler size depends on hot water demand, radiators and insulation. Many 3‑bed UK homes use a combi in the 24–30&nbsp;kW range for hot water, but we size based on your home’s heat loss and flow rate needs. We confirm the correct model at survey.</div>
</div>

<div class="faq-item">
<h3 aria-controls="faq-answer-8" aria-expanded="false" class="faq-question" id="faq-question-8" role="button" tabindex="0">What documents do I receive after installation?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-8" class="faq-answer" id="faq-answer-8" role="region">You receive Benchmark commissioning records, Gas Safe Building Regulations notification (certificate), manufacturer warranty/product registration (where applicable), user manuals and your invoice. We also note any servicing recommendations.</div>
</div>

<div class="faq-item">
<h3 aria-controls="faq-answer-9" aria-expanded="false" class="faq-question" id="faq-question-9" role="button" tabindex="0">Can you move my boiler to a new location?</h3>
<div aria-hidden="true" aria-labelledby="faq-question-9" class="faq-answer" id="faq-answer-9" role="region">Yes. Boiler relocations are common. We survey the best route for flue and condensate, confirm safe gas supply routing (and any upsizing), and price any electrical/controls work required. Your quote reflects the full scope before we proceed.</div>
</div>

</div>
</div>
</section>
<style>@media(max-width:1024px){.faqs-section{padding:80px 32px}} @media(max-width:768px){.faqs-section{padding:40px 20px}.faqs-section h2{font-size:24px}} </style>
<!-- Gas Safe Section -->
<!-- Manufacturers Section (moved below FAQs) -->
<section class="manufacturers-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading section-heading--spaced">Boiler Brands We Install in Scunthorpe &amp; North Lincolnshire</h2>
<p class="section-text section-text--intro">We are accredited installers for <strong>Ideal</strong>, <strong>Baxi</strong> and <strong>Worcester Bosch</strong>, and we also install <strong>Vaillant</strong> and <strong>Viessmann</strong> systems.</p>
<div class="badge-grid" style="display:flex; flex-wrap:wrap; gap:16px; justify-content:center; align-items:center;">
<div class="logo-card" style="padding: 20px; border: 1px solid #A8D5BA; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); background-color: #f9f9f9; min-height: 150px; display: flex; align-items: center; justify-content: center; transition: transform 0.3s ease, box-shadow 0.3s ease;">
<a href="https://www.baxi.co.uk/" rel="noopener noreferrer" style="display: inline-block; text-decoration: none;" target="_blank">
<img alt="Baxi boilers logo - Nimbus Boilers &amp; Heat Pumps in Scunthorpe" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/08/baxi-logo.png" style="max-width: 150px; max-height: 100px; display: block;"/>
</a>
</div>
<div class="logo-card" style="padding: 20px; border: 1px solid #A8D5BA; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); background-color: #f9f9f9; min-height: 150px; display: flex; align-items: center; justify-content: center; transition: transform 0.3s ease, box-shadow 0.3s ease;">
<a href="https://idealheating.com/" rel="noopener noreferrer" style="display: inline-block; text-decoration: none;" target="_blank">
<img alt="Ideal boilers logo - Nimbus Boilers &amp; Heat Pumps in Scunthorpe" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/06/Ideal_Logo-removebg-preview-1.png" style="max-width: 150px; max-height: 100px; display: block;"/>
</a>
</div>
<div class="logo-card" style="padding: 20px; border: 1px solid #A8D5BA; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); background-color: #f9f9f9; min-height: 150px; display: flex; align-items: center; justify-content: center; transition: transform 0.3s ease, box-shadow 0.3s ease;">
<a href="https://www.vaillant.co.uk/" rel="noopener noreferrer" style="display: inline-block; text-decoration: none;" target="_blank">
<img alt="Vaillant boilers logo - Nimbus Boilers &amp; Heat Pumps in Scunthorpe" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/06/a38b5edd-0773-40c1-a329-ed07a9522c26.png" style="max-width: 150px; max-height: 100px; display: block;"/>
</a>
</div>
<div class="logo-card" style="padding: 20px; border: 1px solid #A8D5BA; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); background-color: #f9f9f9; min-height: 150px; display: flex; align-items: center; justify-content: center; transition: transform 0.3s ease, box-shadow 0.3s ease;">
<a href="https://www.worcester-bosch.co.uk/" rel="noopener noreferrer" style="display: inline-block; text-decoration: none;" target="_blank">
<img alt="Worcester Bosch boilers logo - Nimbus Boilers &amp; Heat Pumps in Scunthorpe" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/06/worcester-removebg-preview-1.png" style="max-width: 150px; max-height: 100px; display: block;"/>
</a>
</div>
</div>
</div>
</section>
<section class="gas-safe-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading section-heading--spaced">Why Use a Gas Safe Registered Boiler Installer in Scunthorpe?</h2>
<img alt="Gas Safe Registered Logo - Nimbus Heat Pumps Ltd" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/08/Gas-Safe-Logo-2.png" style="max-width: 200px; height: auto; display: block; margin: 0 auto 30px auto;"/>
<p class="section-text section-text--intro">Choosing a Gas Safe registered engineer ensures all gas work is carried out safely and to the highest standards. Our certified team at Nimbus Boilers &amp; Heat Pumps guarantees compliant <strong>boiler installation</strong>, replacement and servicing in Scunthorpe and North Lincolnshire.</p>
<ul class="section-list section-list--flush">
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Legal requirement for all gas work in the UK</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Reduces risk of gas leaks, carbon monoxide poisoning and fires</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Ensures insurance and warranty validity</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Professional expertise for efficient and safe installations</li>
<li><svg fill="none" height="24" style="display: inline-block; vertical-align: middle; margin-right: 10px;" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#00a676" r="12"></circle><path d="M6 12.5L10 16.5L18 7.5" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path></svg>Peace of mind knowing work is done to the highest standards</li>
</ul>
</div>
</section>
<style>@media(max-width:1024px){.gas-safe-section{padding:80px 32px}} @media(max-width:768px){.gas-safe-section{padding:40px 20px}.gas-safe-section h2{font-size:24px}.gas-safe-section p{font-size:15px}.gas-safe-section ul li{font-size:15px}.gas-safe-section img{max-width:150px}}</style>
<!-- Free Quote Section -->
<section class="free-quote-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<h2 class="section-heading">Request Your Free Gas Boiler Quote in Scunthorpe and North Lincolnshire</h2>
<p class="section-text section-text--intro">Obtain a no-obligation quote for gas boiler installation, replacement, repair and servicing in Scunthorpe and North Lincolnshire. Our engineers will assess your property and recommend efficient boiler options tailored to your home and budget.</p>
<p class="section-text section-text--small">We respect your data — see our <a href="https://nimbusheatpumps.co.uk/policies/privacy-policy/" target="_blank" rel="noopener noreferrer">Privacy Policy</a>. Secure payment available to book your installation once you’re happy.</p>
<div id="contact-form">
        [wpforms id="343"]
      </div>
</div>
</section>
<style>@media (max-width: 1024px) {.free-quote-section {padding: 80px 32px;}} @media (max-width: 768px) {.free-quote-section {padding: 40px 20px;}.free-quote-section h2 {font-size: 24px;}.free-quote-section p {font-size: 15px;}}</style>
<!-- Company Details Section -->
<footer class="company-details-section section nimbus-section-base">
<div style="max-width: 1400px; margin: 0 auto;">
<img alt="Nimbus Boilers &amp; Heat Pumps Logo - Energy Efficient Heating in Scunthorpe and North Lincolnshire" decoding="async" loading="lazy" src="https://nimbusheatpumps.co.uk/wp-content/uploads/2025/06/Nimbus-Heat-Pumps-Logo.png" style="max-width: 200px; height: auto; display: block; margin: 0 auto 20px auto;"/>
<h2 class="footer-heading">Your Trusted Partner for Energy Efficient Heating Solutions in Scunthorpe and North Lincolnshire</h2>
<p class="section-text">Nimbus Heat Pumps Ltd (trading as Nimbus Boilers &amp; Heat Pumps)<br/>Company Number: 16497314<br/>Registered Office: Lytchett House, 13 Freeland Park, Wareham Road, Poole, Dorset, BH16 6FA<br/>Email: info@nimbusheatpumps.co.uk<br/>Telephone: 01724 622069</p>
<div class="section-cta-group section-cta-group--spaced">
<a class="cta-button" href="https://nimbusheatpumps.co.uk/policies/privacy-policy/" rel="noopener noreferrer" target="_blank">Privacy Policy</a>
<a class="cta-button" href="https://nimbusheatpumps.co.uk/policies/terms-and-conditions/" rel="noopener noreferrer" target="_blank">Terms &amp; Conditions</a>
<a class="cta-button" href="https://nimbusheatpumps.co.uk/policies/cookies-policy/" rel="noopener noreferrer" target="_blank">Cookies Policy</a>
</div>
<p class="section-text section-text--small">© Nimbus Heat Pumps Ltd. All rights reserved.</p>
</div>
</footer>
<style>@media (max-width: 1024px) {.company-details-section {padding: 80px 32px;}} @media (max-width: 768px) {.company-details-section {padding: 40px 20px;}.company-details-section h2 {font-size: 24px;}.company-details-section p {font-size: 15px;}.company-details-section img {max-width: 150px;}.company-details-section .section-cta-group {flex-direction: column;gap: 15px;}.company-details-section a {width: 100%;max-width: 300px;margin: 0 auto;font-size: 13px;padding: 10px 20px;min-height: 38px;}}</style>
<!-- Sticky Mobile CTA -->
<div class="sticky-cta" role="region" aria-label="Quick actions">
  <a class="sticky-cta__btn" href="#bqf-fullpaste" aria-label="Start instant boiler quote">Get Instant Quote</a>
  <a class="sticky-cta__btn sticky-cta__btn--call" href="tel:01724622069" aria-label="Call Nimbus Boilers on 01724 622069">Call 01724 622069</a>
</div>
<style>
  @media (max-width: 768px){
    .sticky-cta{position:fixed;left:0;right:0;bottom:0;z-index:9999;display:flex;gap:10px;justify-content:center;align-items:center;padding:10px; background:#ffffff; border-top:1px solid rgba(0,0,0,0.08); box-shadow:0 -6px 16px rgba(0,0,0,0.06);} 
    .sticky-cta__btn{flex:1; text-align:center; text-decoration:none; font-weight:600; padding:10px 12px; border-radius:12px; border:2px solid #00a676; color:#007a57; background:#fff; font-size:13px; min-height:42px; line-height:1.1;} 
    .sticky-cta__btn--call{border-color:#007a57} 
    .site-chrome{padding-bottom:84px !important;} 
  }
</style>
<!-- Navigation Scripts -->
<script>
    // Premium Navigation JavaScript
    (function() {
      'use strict';
      const menu = document.getElementById('nimbusMenu');
      const toggle = document.querySelector('.nimbus-mobile-toggle');
      const navInner = document.querySelector('.nimbus-nav-inner');
      function setMobileMenuPosition() {
        if (window.innerWidth <= 768 && menu && navInner) {
          const headerHeight = navInner.offsetHeight;
          menu.style.top = `${headerHeight}px`;
          const availableHeight = window.innerHeight - headerHeight;
          menu.style.height = menu.classList.contains('active') ? `${availableHeight}px` : '0';
          menu.style.maxHeight = `${availableHeight}px`;
        }
      }
      window.toggleNimbusMenu = function() {
        if (menu && toggle && navInner) {
          menu.classList.toggle('active');
          toggle.classList.toggle('active');
          toggle.setAttribute('aria-expanded', toggle.classList.contains('active'));
          setMobileMenuPosition();
          if (menu.classList.contains('active')) {
            document.body.style.overflow = 'hidden';
            document.body.style.position = 'fixed';
            document.body.style.width = '100%';
          } else {
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
          }
        }
      };
      window.toggleDropdown = function(event) {
        if (window.innerWidth <= 768) {
          event.preventDefault();
          const parent = event.target.parentElement;
          const allDropdowns = document.querySelectorAll('.nimbus-menu-item.dropdown-active');
          allDropdowns.forEach(item => {
            if (item !== parent) {
              item.classList.remove('dropdown-active');
            }
          });
          parent.classList.toggle('dropdown-active');
          if (parent.classList.contains('dropdown-active')) {
            setTimeout(() => {
              parent.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
          }
        }
      };
      document.addEventListener('click', function(e) {
        const nav = document.querySelector('.nimbus-nav');
        if (nav && !nav.contains(e.target) && menu && menu.classList.contains('active')) {
          menu.classList.remove('active');
          toggle.classList.remove('active');
          toggle.setAttribute('aria-expanded', 'false');
          document.body.style.overflow = '';
          document.body.style.position = '';
          document.body.style.width = '';
        }
      });
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          if (menu && menu.classList.contains('active')) {
            menu.classList.remove('active');
            toggle.classList.remove('active');
            toggle.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
          }
        }
      });
      let resizeTimer;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function() {
          setMobileMenuPosition();
          if (window.innerWidth > 768) {
            if (menu && toggle) {
              menu.classList.remove('active');
              toggle.classList.remove('active');
              toggle.setAttribute('aria-expanded', 'false');
              document.body.style.overflow = '';
              document.body.style.position = '';
              document.body.style.width = '';
            }
            const allDropdowns = document.querySelectorAll('.nimbus-menu-item.dropdown-active');
            allDropdowns.forEach(item => {
              item.classList.remove('dropdown-active');
            });
          }
        }, 250);
      });
      window.addEventListener('orientationchange', function() {
        setTimeout(setMobileMenuPosition, 100);
      });
      window.addEventListener('load', setMobileMenuPosition);
    })();
    // FAQ Accordion
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
      const question = item.querySelector('.faq-question');
      const answer = item.querySelector('.faq-answer');
      if (!question || !answer) {
        return;
      }
      const toggleFaq = () => {
        const isActive = item.classList.toggle('active');
        question.setAttribute('aria-expanded', isActive ? 'true' : 'false');
        answer.setAttribute('aria-hidden', isActive ? 'false' : 'true');
      };
      question.addEventListener('click', toggleFaq);
      question.addEventListener('keydown', event => {
        if (event.key === 'Enter' || event.key === ' ') {
          event.preventDefault();
          toggleFaq();
        }
      });
    });
  </script>
</main></div>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=Poppins:wght@500;600;700&amp;display=swap" rel="stylesheet"/><link href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" rel="stylesheet"/><style>
    /* Font fallback */
    @font-face {
        font-family: 'Inter-Fallback';
        src: local('system-ui'), local('-apple-system'), local('BlinkMacSystemFont'), local('Segoe UI'), local('Roboto');
    }
    #quote-form-container {
        font-family: 'Inter', 'Inter-Fallback', sans-serif !important;
    }
    #quote-form-container h2 {
        font-family: 'Poppins', 'Inter-Fallback', sans-serif !important;
    }
    /* Swiper fallback to grid layout */
    .swiper-fallback {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
        gap: 16px !important;
        padding: 0 !important;
    }
    .swiper-fallback .swiper-slide {
        width: 100% !important;
        margin: 0 !important;
    }
    .swiper-fallback .swiper-button-next,
    .swiper-fallback .swiper-button-prev {
        display: none !important;
    }
    @media (max-width: 768px) {
        #quote-form-container {
            padding: 20px;
            margin: 16px;
        }
        .radio-group {
            grid-template-columns: 1fr;
        }
        .progress-bar {
            overflow-x: auto;
            white-space: nowrap;
        }
        .progress-step {
            min-width: 80px;
        }
    }
    @media (max-width: 480px) {
        #quote-form-container button {
            width: 100%;
            margin: 8px 0;
        }
        .boiler-content {
            flex-direction: column;
        }
    }
</style><style>

    #quote-form-container {
        --primary-color: #00a676;
        --primary-dark: #008c5e;
        --secondary-color: #6f8ab7;
        --accent-color: #2d2034;
        --background-light: #f8fafc;
        --background-white: #ffffff;
        --border-color: #e2e8f0;
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        --error-color: #ef4444;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        --radius-sm: 8px;
        --radius-md: 16px;
        --radius-lg: 20px;
        --transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        color-scheme: light dark;
        max-width: 1140px;
        margin: 0 auto;
        padding: 40px;
        background:
            radial-gradient(circle at 20% 80%, rgba(111, 138, 183, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(0, 166, 118, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.05) 0%, transparent 50%),
            linear-gradient(135deg, var(--background-light) 0%, var(--background-white) 50%, rgba(248, 250, 252, 0.9) 100%);
        border-radius: var(--radius-lg);
        font-family: 'Inter', sans-serif;
        color: var(--text-primary);
        box-shadow: var(--shadow-xl);
        position: relative;
        overflow: hidden;
        -webkit-backdrop-filter: blur(20px);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        min-height: 800px; /* Prevent height changes between steps */
    }
    /* Glassmorphism enhanced background */
    #quote-form-container::before {
        content: '';
        position: absolute;
        top: -1px;
        left: -1px;
        right: -1px;
        bottom: -1px;
        background:
            linear-gradient(45deg, transparent 25%, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.1) 50%, transparent 50%, transparent 75%, rgba(255,255,255,0.05) 75%),
            linear-gradient(90deg, rgba(111, 138, 183, 0.03), rgba(0, 166, 118, 0.03), rgba(245, 158, 11, 0.02));
        background-size: 20px 20px;
        border-radius: inherit;
        animation: subtle-pattern 20s linear infinite;
        z-index: -1;
    }
    @keyframes subtle-pattern {
        0% { background-position: 0 0; }
        100% { background-position: 20px 20px; }
    }
    #quote-form-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--primary-color));
        background-size: 200% 100%;
        animation: shimmer 2s ease-in-out infinite;
    }
    @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
    }
    #quote-form-container * { box-sizing: border-box; }
    #quote-form-container .progress-container { position: relative; margin-bottom: 40px; }
    #quote-form-container .progress-bar {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 8px;
        margin-bottom: 16px;
    }
    #quote-form-container .progress-step {
        padding: 12px 16px;
        background: var(--background-white);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-md);
        cursor: pointer;
        color: var(--text-secondary);
        text-align: center;
        transition: var(--transition);
        font-weight: 500;
        font-size: 14px;
        position: relative;
        overflow: hidden;
    }
    #quote-form-container .progress-step::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s;
    }
    #quote-form-container .progress-step:hover::before { left: 100%; }
    /* Performance optimizations */
    #quote-form-container .progress-fill { will-change: width; }
    #quote-form-container .form-step { will-change: opacity, transform; }
    #quote-form-container .progress-step.active {
        background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        color: var(--background-white);
        border-color: var(--primary-color);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
        font-weight: 600;
    }
    #quote-form-container .progress-step.completed {
        background: linear-gradient(135deg, var(--secondary-color), #5a74a0);
        color: var(--background-white);
        border-color: var(--secondary-color);
    }
    #quote-form-container .progress-step.completed::after {
        content: '✓';
        position: absolute;
        top: 50%;
        right: 8px;
        transform: translateY(-50%);
        font-size: 12px;
        font-weight: bold;
    }
    #quote-form-container .progress-indicator {
        height: 4px;
        background: var(--border-color);
        border-radius: 2px;
        overflow: hidden;
        margin-bottom: 20px;
    }
    #quote-form-container .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--primary-color));
        border-radius: 2px;
        transition: width 0.5s ease;
        position: relative;
        animation: progress-glow 2s ease-in-out infinite alternate;
    }
    @keyframes progress-glow {
        0% { box-shadow: 0 0 5px var(--primary-color); }
        100% { box-shadow: 0 0 15px var(--primary-color); }
    }
    #quote-form-container .progress-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        animation: progress-shine 2s ease-in-out infinite;
    }
    @keyframes progress-shine {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    #quote-form-container h2 {
        font-family: 'Poppins', sans-serif;
        color: var(--accent-color);
        font-size: clamp(24px, 4vw, 32px);
        margin-bottom: 24px;
        line-height: 1.2;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 12px;
        text-align: center;
        justify-content: center;
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #quote-form-container h2::before {
        content: '';
        width: 4px;
        height: 32px;
        background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
        border-radius: 2px;
    }
    #quote-form-container label {
        display: block;
        margin-bottom: 16px;
        font-weight: 600;
        color: var(--text-primary);
        font-size: 16px;
        text-align: center;
    }
    #quote-form-container .radio-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
        text-align: center;
    }
    #quote-form-container .radio-card {
        padding: 24px;
        background: var(--background-white);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-lg);
        text-align: center;
        cursor: pointer;
        transition: var(--transition);
        position: relative;
        overflow: hidden;
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        min-height: 150px;
    }
    #quote-form-container .radio-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, transparent, rgba(0, 166, 118, 0.05), transparent);
        opacity: 0;
        transition: var(--transition);
    }
    #quote-form-container .radio-card:hover {
        border-color: var(--primary-color);
        box-shadow: var(--shadow-lg), 0 0 20px rgba(0, 166, 118, 0.2);
        transform: translateY(-4px);
        background: linear-gradient(135deg, rgba(0, 166, 118, 0.1), rgba(0, 166, 118, 0.05));
    }
    #quote-form-container .radio-card:hover::before { opacity: 1; }
    #quote-form-container .radio-card:focus-within {
        outline: 3px solid rgba(0, 166, 118, 0.3);
        outline-offset: 2px;
    }
    #quote-form-container .radio-card input { display: none; }
    #quote-form-container .radio-card.selected {
        border-color: var(--primary-color);
        box-shadow: var(--shadow-lg), 0 0 0 4px rgba(0, 166, 118, 0.1);
        background: linear-gradient(135deg, rgba(0, 166, 118, 0.05), rgba(0, 166, 118, 0.1));
        transform: translateY(-2px);
    }
    #quote-form-container .radio-card.selected::after {
        content: '✓';
        position: absolute;
        top: 12px;
        right: 12px;
        width: 24px;
        height: 24px;
        background: var(--primary-color);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
        animation: checkmark 0.3s ease-out;
    }
    @keyframes checkmark {
        0% { transform: scale(0) rotate(0deg); opacity: 0; }
        50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
        100% { transform: scale(1) rotate(360deg); opacity: 1; }
    }
    #quote-form-container .radio-icon {
        font-size: 48px;
        display: block;
        margin-bottom: 12px;
        filter: grayscale(20%);
        transition: transform 0.3s ease, filter 0.3s ease;
    }
    #quote-form-container .radio-card:hover .radio-icon,
    #quote-form-container .radio-card.selected .radio-icon {
        filter: grayscale(0%);
        transform: scale(1.1) rotate(5deg);
    }
    #quote-form-container .boiler-image {
        width: 100%;
        height: 160px;
        object-fit: contain;
        margin-bottom: 12px;
        border-radius: var(--radius-sm);
        transition: var(--transition);
        background: var(--background-light);
    }
    #quote-form-container .radio-card:hover .boiler-image,
    #quote-form-container .radio-card.selected .boiler-image { transform: scale(1.05); }
    #quote-form-container input[type="text"],
    #quote-form-container input[type="email"],
    #quote-form-container input[type="tel"],
    #quote-form-container input[type="number"],
    #quote-form-container select {
        width: 100%;
        padding: 16px;
        margin-bottom: 16px;
        border: 2px solid var(--border-color);
        border-radius: var(--radius-md);
        font-size: 16px;
        font-family: inherit;
        transition: var(--transition);
        background: var(--background-white);
        text-align: center;
    }
    #quote-form-container input:focus,
    #quote-form-container select:focus {
        border-color: var(--primary-color);
        outline: 3px solid var(--primary-color);
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(0, 166, 118, 0.1);
        transform: translateY(-1px);
    }
    #quote-form-container input:invalid:not(:focus):not(:placeholder-shown) {
        border-color: var(--error-color);
        box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
    }
    #quote-form-container .error {
        color: var(--error-color);
        font-size: 14px;
        margin-top: -12px;
        margin-bottom: 16px;
        display: none;
        padding: 12px 16px;
        background: rgba(239, 68, 68, 0.1);
        border-radius: var(--radius-sm);
        border-left: 4px solid var(--error-color);
        animation: slideDown 0.3s ease-out;
        text-align: center;
    }
    #quote-form-container .error.show { display: block; }
    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    #quote-form-container button {
        background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        color: var(--background-white);
        border: none;
        padding: 16px 32px;
        border-radius: var(--radius-md);
        cursor: pointer;
        margin: 8px 8px 8px 0;
        font-weight: 600;
        font-size: 16px;
        transition: var(--transition);
        position: relative;
        overflow: hidden;
        box-shadow: var(--shadow-md);
        text-align: center;
    }
    #quote-form-container button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s;
    }
    #quote-form-container button:hover {
        background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg), 0 0 15px rgba(0, 166, 118, 0.3);
    }
    #quote-form-container button:hover::before { left: 100%; }
    #quote-form-container button:active { transform: translateY(0); }
    #quote-form-container button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }
    #quote-form-container button:focus { outline: 3px solid var(--primary-color); outline-offset: 2px; }
    #quote-form-container .quote-summary,
    #quote-form-container .non-gas-message {
        margin-top: 24px;
        padding: 24px;
        background: linear-gradient(135deg, var(--background-white), var(--background-light));
        border: 2px solid var(--border-color);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
        position: relative;
        text-align: center;
    }
    #quote-form-container .non-gas-message {
        border-color: var(--warning-color);
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(245, 158, 11, 0.1));
    }
    #quote-form-container .non-gas-message::before {
        content: '⚠️';
        position: absolute;
        top: 16px;
        left: 16px;
        font-size: 20px;
    }
    #quote-form-container .non-gas-message { padding-left: 56px; }
    #quote-form-container .form-step {
        display: none;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.4s ease-out, transform 0.4s ease-out;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
    #quote-form-container .form-step.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }
    #quote-form-container .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 16px;
        text-align: center;
    }
    #quote-form-container .checkbox-card {
        padding: 20px;
        background: var(--background-white);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition);
        position: relative;
        min-height: 80px;
        text-align: center;
    }
    #quote-form-container .checkbox-card:hover {
        background: var(--background-light);
        border-color: var(--primary-color);
        transform: translateX(4px);
    }
    #quote-form-container .checkbox-card input {
        margin-right: 12px;
        transform: scale(1.2);
    }
    #quote-form-container .checkbox-card.selected {
        border-color: var(--primary-color);
        background: linear-gradient(135deg, rgba(0, 166, 118, 0.05), rgba(0, 166, 118, 0.1));
    }
    #quote-form-container .pay-button {
        background: linear-gradient(135deg, var(--secondary-color), #5a74a0);
        color: var(--background-white);
        margin: 16px 0;
        width: 100%;
        font-size: 18px;
        padding: 20px;
        position: relative;
    }
    #quote-form-container .pay-button::after {
        content: '🔒';
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
    }
    #quote-form-container .hidden { display: none !important; }
    #quote-form-container .radiator-options, #quote-form-container .cylinder-options {
        margin-top: 16px;
        padding: 20px;
        border: 2px solid var(--border-color);
        border-radius: var(--radius-md);
        background: var(--background-light);
        animation: fadeIn 0.3s ease-out;
        text-align: center;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    #quote-form-container .manufacturer-link {
        display: inline-block;
        margin-top: 12px;
        color: var(--secondary-color);
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        padding: 8px 16px;
        border-radius: var(--radius-sm);
        background: rgba(111, 138, 183, 0.1);
        transition: var(--transition);
    }
    #quote-form-container .manufacturer-link:hover {
        background: var(--secondary-color);
        color: white;
        transform: translateY(-1px);
    }
    #quote-form-container .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 10000;
    }
    #quote-form-container .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(255, 255, 255, 0.2);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    #quote-form-container .loading-text { color: white; margin-top: 20px; font-size: 18px; font-weight: 500; }
    #quote-form-container #boiler-options {
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }
    #quote-form-container #boiler-options .radio-card { padding: 32px; }
    #quote-form-container #boiler-options .radio-card div { margin: 0 0 12px 0; }
    #quote-form-container .boiler-content {
        display: flex;
        align-items: center !important;
        gap: 16px;
        width: 100%;
        text-align: center !important;
        flex-direction: column;
        align-items: center !important;
        justify-content: center !important;
        transform: none !important;
    }
    #quote-form-container .boiler-details { flex: 1; }
    #quote-form-container .boiler-title {
        margin: 0 0 8px 0;
        color: var(--accent-color);
        font-size: 16px;
        font-weight: 600;
    }
    #quote-form-container .warranty-info {
        margin: 0 0 8px 0;
        color: var(--text-secondary);
        font-size: 14px;
    }
    #quote-form-container .price-section {
        display: flex;
        align-items: center;
        justify-content: center !important;
        margin-top: 12px;
        text-align: center;
    }
    #quote-form-container .price-display { display: flex; flex-direction: column; }
    #quote-form-container .total-price {
        font-size: 24px;
        font-weight: 700;
        color: var(--primary-color);
        line-height: 1;
    }
    #quote-form-container .price-label { font-size: 14px; color: var(--text-secondary); }
    #quote-form-container .boiler-option-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center !important;
        gap: 12px;
        height: 100%;
        width: 100%;
    }
    #quote-form-container .boiler-option-wrapper .manufacturer-link { margin-top: 0; width: auto; text-align: center; }
    #quote-form-container .boiler-type-label {
        font-size: 14px;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 8px;
    }
    /* Swiper Styles */
    #quote-form-container .swiper {
        width: 100% !important;
        max-width: none;
        padding: 0 !important;
        position: relative !important;
        overflow: hidden !important;
    }
    #quote-form-container .swiper-slide {
        display: flex;
        justify-content: center;
        min-width: 280px;
        max-width: 350px;
        margin: 0 auto;
        height: auto !important;
    }
    #quote-form-container .swiper-button-next, #quote-form-container .swiper-button-prev { color: var(--primary-color); }
    /* Mobile Optimizations */
    @media (max-width: 768px) {
        #quote-form-container {
            padding: 20px;
            margin: 16px;
            min-height: auto; /* Remove desktop min-height on tablets */
        }
        #quote-form-container .progress-bar { grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 6px; }
        #quote-form-container .progress-step { padding: 8px 4px; font-size: 12px; }
        #quote-form-container .radio-group { grid-template-columns: 1fr; gap: 12px; }
        #quote-form-container .radio-card { padding: 20px 16px; min-height: 120px; }
        #quote-form-container .radio-icon { font-size: 40px; }
        #quote-form-container h2 { font-size: 24px; }
        #quote-form-container button { width: 100%; margin: 8px 0; }
        #quote-form-container #boiler-options { grid-template-columns: 1fr; }
        #quote-form-container .boiler-content { flex-direction: column; text-align: center !important; gap: 12px; }
        #quote-form-container .price-section {
            flex-direction: column;
            gap: 8px;
            align-items: center !important;
            margin-top: 8px;
        }
        #quote-form-container .boiler-option-wrapper { gap: 8px; }
        #quote-form-container .total-price { font-size: 24px; }
    }
    @media (max-width: 480px) {
        #quote-form-container {
            padding: 16px;
            margin: 8px;
            border-radius: var(--radius-md);
            min-height: auto; /* Ensure no min-height on small mobile */
        }
        #quote-form-container .progress-step { font-size: 10px; padding: 6px 2px; }
        #quote-form-container .progress-step.active,
        #quote-form-container .progress-step.completed { font-size: 11px; }
        #quote-form-container .radio-card { padding: 16px 12px; width: 100%; min-height: 100px; }
        #quote-form-container .radio-icon { font-size: 32px; }
        #quote-form-container .swiper-slide { min-width: 100%; max-width: 100%; }
        #quote-form-container .boiler-option-wrapper { width: 100%; }
        #quote-form-container .radio-card { width: 100%; text-align: center !important; }
        #quote-form-container .boiler-title, #quote-form-container .warranty-info, #quote-form-container .total-price, #quote-form-container .price-label { text-align: center !important; }
        #quote-form-container .total-price { font-size: 20px; }
        #quote-form-container h2 { font-size: 22px; line-height: 1.3; }
        #quote-form-container input[type="text"],
        #quote-form-container input[type="email"],
        #quote-form-container input[type="tel"],
        #quote-form-container input[type="number"],
        #quote-form-container select {
            padding: 12px 16px;
            font-size: 16px; /* Prevent zoom on iOS */
        }
    }
    /* Print styles */
    @media print {
        #quote-form-container { box-shadow: none; background: white; }
        #quote-form-container .progress-bar, #quote-form-container button { display: none; }
    }
    /* Accessibility improvements */
    @media (prefers-reduced-motion: reduce) {
        #quote-form-container *, #quote-form-container *::before, #quote-form-container *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
    }
    @media (prefers-contrast: high) {
        #quote-form-container { --border-color: #000000; --text-secondary: var(--dark-green); }
    }
    @media (prefers-color-scheme: dark) {
        #quote-form-container {
            --background-light: #1e293b;
            --background-white: #334155;
            --border-color: #64748b;
            --text-primary: #f8fafc !important;
            --text-secondary: #d1d5db !important;
            --primary-color: #34d399;
            --primary-dark: #059669;
            --secondary-color: #93c5fd;
            --accent-color: #e5e7eb !important;
            --error-color: #f87171 !important;
            --success-color: #34d399 !important;
            --warning-color: #facc15 !important;
            --shadow-sm: 0 1px 2px 0 rgba(255, 255, 255, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(255, 255, 255, 0.15), 0 2px 4px -2px rgba(255, 255, 255, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(255, 255, 255, 0.15), 0 4px 6px -4px rgba(255, 255, 255, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(255, 255, 255, 0.15), 0 8px 10px -6px rgba(255, 255, 255, 0.1);
        }
        #quote-form-container { background: linear-gradient(135deg, var(--background-light), var(--background-white)); color: var(--text-primary) !important; }
        #quote-form-container button, #quote-form-container .pay-button {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: #ffffff !important;
            border-color: var(--primary-dark);
        }
        #quote-form-container button:hover, #quote-form-container .pay-button:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
            color: #ffffff !important;
        }
        #quote-form-container .radio-card, #quote-form-container .checkbox-card {
            background: var(--background-white);
            border-color: var(--border-color);
            color: var(--text-primary) !important;
        }
        #quote-form-container .radio-card.selected, #quote-form-container .checkbox-card.selected {
            background: linear-gradient(135deg, rgba(52, 211, 153, 0.1), rgba(52, 211, 153, 0.2));
            border-color: var(--primary-color);
            color: var(--text-primary) !important;
        }
        #quote-form-container .radio-card:hover, #quote-form-container .checkbox-card:hover {
            background: rgba(52, 211, 153, 0.05);
            border-color: var(--primary-color);
            color: var(--text-primary) !important;
        }
        #quote-form-container .progress-step {
            background: var(--background-white);
            color: var(--text-secondary) !important;
            border-color: var(--border-color);
        }
        #quote-form-container .progress-step.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: #ffffff !important;
            border-color: var(--primary-color);
        }
        #quote-form-container .progress-step.completed {
            background: linear-gradient(135deg, var(--secondary-color), #60a5fa);
            color: #ffffff !important;
            border-color: var(--secondary-color);
        }
        #quote-form-container .progress-fill { background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)); }
        #quote-form-container input[type="text"],
        #quote-form-container input[type="email"],
        #quote-form-container input[type="tel"],
        #quote-form-container input[type="number"],
        #quote-form-container select {
            background: #2d3748;
            color: var(--text-primary) !important;
            border-color: var(--border-color);
        }
        #quote-form-container input:focus, #quote-form-container select:focus {
            border-color: var(--primary-color);
            outline-color: var(--primary-color);
            color: var(--text-primary) !important;
        }
        #quote-form-container .manufacturer-link { background: rgba(147, 197, 253, 0.15); color: var(--secondary-color) !important; }
        #quote-form-container .manufacturer-link:hover { background: var(--secondary-color); color: #1e293b !important; }
        #quote-form-container .quote-summary, #quote-form-container .non-gas-message {
            background: linear-gradient(135deg, var(--background-white), var(--background-light));
            color: var(--text-primary) !important;
            border-color: var(--border-color);
        }
        #quote-form-container .non-gas-message {
            border-color: var(--warning-color);
            background: linear-gradient(135deg, rgba(250, 204, 21, 0.1), rgba(250, 204, 21, 0.2));
            color: var(--text-primary) !important;
        }
        #quote-form-container .error {
            background: rgba(248, 113, 113, 0.1);
            border-color: var(--error-color);
            color: var(--text-primary) !important;
        }
        #quote-form-container .swiper-button-next, #quote-form-container .swiper-button-prev { color: var(--primary-color); }
        #quote-form-container .loading-overlay { background: rgba(0, 0, 0, 0.9); }
        #quote-form-container .loading-text { color: var(--text-primary) !important; }
        #quote-form-container label, #quote-form-container small, #quote-form-container p, #quote-form-container h2, #quote-form-container h3, #quote-form-container h4, #quote-form-container span, #quote-form-container strong {
            color: light-dark(var(--text-primary), var(--text-primary)) !important;
        }
        #quote-form-container a { color: light-dark(var(--secondary-color), #93c5fd) !important; }
    }
    /* Counter forced dark mode inversions */
    @media screen and (-webkit-min-device-pixel-ratio:0) {
        #quote-form-container { filter: invert(0); mix-blend-mode: normal; }
    }
    /* Additional for cylinder warning */
    #cylinder-warning {
        color: var(--warning-color);
        font-size: 14px;
        margin-top: -12px;
        margin-bottom: 16px;
        display: none;
        padding: 12px 16px;
        background: rgba(245, 158, 11, 0.1);
        border-radius: var(--radius-sm);
        border-left: 4px solid var(--warning-color);
        animation: slideDown 0.3s ease-out;
        text-align: center;
    }
    #cylinder-warning.show { display: block; }
    /* Swiper Navigation Buttons - Fixed Version */
    #quote-form-container .swiper-button-next,
    #quote-form-container .swiper-button-prev {
        position: absolute !important;
        top: 50% !important;
        width: 44px !important;
        height: 44px !important;
        margin-top: -22px !important;
        z-index: 1000 !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        color: var(--primary-color) !important;
        background: var(--background-white) !important;
        border: 2px solid var(--primary-color) !important;
        border-radius: 50% !important;
        box-shadow: var(--shadow-md) !important;
        transition: var(--transition) !important;
        font-size: 18px !important;
        font-weight: bold !important;
        opacity: 1 !important;
        visibility: visible !important;
        pointer-events: auto !important;
    }
    #quote-form-container .swiper-button-next:hover,
    #quote-form-container .swiper-button-prev:hover {
        background: var(--primary-color) !important;
        color: var(--background-white) !important;
        transform: scale(1.1) !important;
        box-shadow: var(--shadow-lg) !important;
    }
    #quote-form-container .swiper-button-next { right: 10px !important; }
    #quote-form-container .swiper-button-prev { left: 10px !important; }
    #quote-form-container .swiper-button-next:after,
    #quote-form-container .swiper-button-prev:after {
        font-family: swiper-icons !important;
        font-size: 18px !important;
        font-weight: 900 !important;
    }
    #quote-form-container .swiper-button-next:after { content: 'next' !important; }
    #quote-form-container .swiper-button-prev:after { content: 'prev' !important; }
    /* Equal-height boiler cards */
    #quote-form-container #boiler-options .swiper-wrapper { align-items: stretch !important; }
    #quote-form-container #boiler-options .boiler-option-wrapper { display: flex; flex-direction: column; width: 100%; height: 100%; }
    #quote-form-container #boiler-options .radio-card { display: flex; flex-direction: column; height: 100%; }
    #quote-form-container #boiler-options .boiler-content { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
    #quote-form-container #boiler-options .manufacturer-link { margin-top: auto; }
</style><style>
/* Reinforcement to avoid page-level colour/font bleeding into the form */
#quote-form-container { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
#quote-form-container h1, 
#quote-form-container h2, 
#quote-form-container h3 { font-family: 'Poppins', 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
#quote-form-container, 
#quote-form-container * { color: var(--text-primary, #111827); }
</style>
















